{"ast":null,"code":"import _defineProperty from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{axios}from\"utils/utils\";import{withStyles}from\"@material-ui/styles\";import Paper from'@material-ui/core/Paper';import Grid from\"@material-ui/core/Grid\";import Typography from\"@material-ui/core/Typography\";import ToggleButton from\"@material-ui/lab/ToggleButton\";import PauseIcon from\"@material-ui/icons/Pause\";import PlayArrowIcon from\"@material-ui/icons/PlayArrow\";import SyncDisabledIcon from\"@material-ui/icons/SyncDisabled\";import LoopIcon from\"@material-ui/icons/Loop\";import StopIcon from\"@material-ui/icons/Stop\";import Select from\"react-select\";import Switch from'@material-ui/core/Switch';import{AutoComplete}from\"antd\";var styles=function styles(theme){return{root:{flexGrow:1},content:{padding:theme.spacing(3),width:'auto',minWidth:350,maxWidth:600,// margin: 'auto',\nbackgroundColor:'#7FFFD4'},icon:{width:50,height:50},groupButton:{width:320,color:\"gray\"}};};// const options = [\"live\", \"Audio file\"];\nvar defaultTranscript=\"This file has no transcript.\";var checkWordFreq=10;var AudioFilePlayer=/*#__PURE__*/function(_Component){_inherits(AudioFilePlayer,_Component);var _super=_createSuper(AudioFilePlayer);function AudioFilePlayer(){var _this;_classCallCheck(this,AudioFilePlayer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// 0 - audio, 1 - live file\n// alpha: 1,\nfileList:[],currentFile:\"\",currentCaption:\"\",audioPath:\"\",audio_repeat:0,audio_play:0,showTranscript:false,playbackStartTime:0,isFilePlaying:0,prevWords:[],currWord:\"\",restWords:[]};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fileResponse,pathResponse,fileList,audioPath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/researcher/fileNames\");case 3:fileResponse=_context.sent;_context.next=6;return axios.get(\"/api/researcher/audioPath\");case 6:pathResponse=_context.sent;fileList=[];audioPath=pathResponse.data;fileResponse.data.forEach(function(element){fileList.push({value:element.value,label:element.value,transcript:element.transcript});});_this.setState({fileList:fileList,audioPath:audioPath});setInterval(_this.getCurrentWord,checkWordFreq);setInterval(_this.updateParam,100);// this.updateParam();\n_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,15]]);}));_this.componentWillUnmount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.pause();case 1:case\"end\":return _context2.stop();}}},_callee2);}));_this.updateParam=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post(\"/api/param/getparam\");case 3:response=_context3.sent;data=response.data;// console.log(data.left.audio_playing);\n_this.setState({audio_play:data.left.audio_playing,isFilePlaying:data.left.audio_playing,audio_repeat:data.left.audio_repeat});_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);throw _context3.t0;case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));_this.handleFileChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(file){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.pause();_this.setState({currentFile:file.value});if(_this.props.onChangeAudioFile){_this.props.onChangeAudioFile(file.value);}// If the file doesn't have transcript, set currentCaption as default message. The\n// reason we pair the message with 'punct' key is to make the render more conveniently.\nif(file.transcript){_context4.next=7;break;}console.log(\"No transcript found\");_this.setState({currentCaption:{punct:defaultTranscript},isFilePlaying:0,prevWords:[],currWord:\"\",restWords:defaultTranscript});return _context4.abrupt(\"return\");case 7:_context4.prev=7;_context4.next=10;return axios.post(\"/api/researcher/jsonFile\",{data:_this.state.audioPath.concat(file.transcript)});case 10:response=_context4.sent;// console.log(response.data);\n_this.setState({currentCaption:response.data,isFilePlaying:0,prevWords:[],currWord:\"\",restWords:response.data.punct});_context4.next=17;break;case 14:_context4.prev=14;_context4.t0=_context4[\"catch\"](7);alert(_context4.t0.response.data);case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[7,14]]);}));return function(_x){return _ref4.apply(this,arguments);};}();_this.getCurrentWord=function(){if(!_this.state.currentFile||!_this.state.currentCaption){return;}if(_this.state.isFilePlaying===0){return;}else if(_this.state.currentCaption.punct===defaultTranscript){return;}else{var words=_this.state.currentCaption.punct.split(' ');var wordsInfo=_this.state.currentCaption.words;var fileLength=_this.state.currentCaption.length;var currentTime=Date.now();var timeLapsed=(currentTime-_this.state.playbackStartTime)%fileLength;// console.log(timeLapsed); // Why is it not a floating point number sometimes?\nvar index=0;while(index<wordsInfo.length-1&&timeLapsed>wordsInfo[index+1].start){index++;}var prevWords=\"\";var currWord=\"\";var restWords=\"\";if(index===0){prevWords=words.slice(0,index).join(' ');currWord=words[index]+\" \";// Assume there are more than 1 word, i.e. the max index > 0.\nrestWords=words.slice(index+1).join(' ');}else if(index===wordsInfo.length-1){prevWords=words.slice(0,index).join(' ')+\" \";currWord=words[index];restWords=\"\";}else{prevWords=words.slice(0,index).join(' ')+\" \";currWord=words[index]+\" \";restWords=words.slice(index+1).join(' ');}_this.setState({prevWords:prevWords,currWord:currWord,restWords:restWords});}};_this.handleCaptionToggle=function(event){_this.setState({showTranscript:event.target.checked});};_this.playFile=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var preparePlay,_this$state,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:// Check if there is any preparation to do, like sending some HA parameters,\n// before we send the audio file data to RT-MHA\npreparePlay=_this.props.preparePlay;if(preparePlay){preparePlay();}_this$state=_this.state,currentFile=_this$state.currentFile,audioPath=_this$state.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,alpha:1,audio_play:1};dataToSend={left:audioData,right:audioData};_context5.prev=6;_context5.next=9;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 9:response=_context5.sent;data=response.data;console.log(data);// Set the states for closed captioning feature\n_this.setState({audio_play:1,isFilePlaying:1,playbackStartTime:Date.now()// Get the current time as the start point at which we start to play the file\n});_context5.next=18;break;case 15:_context5.prev=15;_context5.t0=_context5[\"catch\"](6);alert(_context5.t0.response.data);case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[6,15]]);}));_this.pause=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var _this$state2,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state2=_this.state,currentFile=_this$state2.currentFile,audioPath=_this$state2.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,audio_play:0};dataToSend={left:audioData,right:audioData};_context6.prev=4;_context6.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 7:response=_context6.sent;data=response.data;console.log(data);_this.setState({audio_play:0,isFilePlaying:0});_context6.next=16;break;case 13:_context6.prev=13;_context6.t0=_context6[\"catch\"](4);alert(_context6.t0.response.data);case 16:case\"end\":return _context6.stop();}}},_callee6,null,[[4,13]]);}));_this.handleRepeat=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this$state3,currentFile,audioPath,filePath,audioData,dataToSend,response;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$state3=_this.state,currentFile=_this$state3.currentFile,audioPath=_this$state3.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={// audio_filename: filePath,\n// alpha: 1,\naudio_repeat:1,audio_play:1};dataToSend={left:audioData,right:audioData};_context7.prev=4;_context7.next=7;return axios.post(\"/api/param/setParam\",{method:\"set\",data:dataToSend});case 7:response=_context7.sent;console.log(response.data);_this.setState({audio_repeat:1,audio_play:1,isFilePlaying:1,playbackStartTime:Date.now()});_context7.next=15;break;case 12:_context7.prev=12;_context7.t0=_context7[\"catch\"](4);alert(_context7.t0.repsonse.data);case 15:case\"end\":return _context7.stop();}}},_callee7,null,[[4,12]]);}));_this.cancelRepeat=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var _this$state4,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this$state4=_this.state,currentFile=_this$state4.currentFile,audioPath=_this$state4.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={// audio_filename: filePath,\naudio_repeat:0};dataToSend={left:audioData,right:audioData};_context8.prev=4;_context8.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 7:response=_context8.sent;data=response.data;console.log(data);_this.setState({audio_repeat:0,audio_play:0,isFilePlaying:0});_context8.next=16;break;case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](4);alert(_context8.t0.response.data);case 16:case\"end\":return _context8.stop();}}},_callee8,null,[[4,13]]);}));_this.handlePlayChange=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(type,value){var _this$state5,currentFile,audioPath,audio_repeat,audio_play,filePath,audioData,dataInput,response,data;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_this$state5=_this.state,currentFile=_this$state5.currentFile,audioPath=_this$state5.audioPath,audio_repeat=_this$state5.audio_repeat,audio_play=_this$state5.audio_play;filePath=audioPath.concat(currentFile);// Switch between live data and stimulus file,\n// if (type === \"alpha\") {\n//     filePath = value === 1 ? audioPath.concat(currentFile) : \"\";\n// } else {\n//     filePath = alpha === 1 ? audioPath.concat(currentFile) : \"\";\n// }\naudioData=_defineProperty({audio_filename:filePath,audio_reset:0,audio_repeat:audio_repeat,audio_play:audio_play},type,value);dataInput={left:audioData,right:audioData};_context9.prev=4;_context9.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataInput});case 7:response=_context9.sent;data=response.data;console.log(data);_this.setState(_defineProperty({},type,value));console.log(_this.state);if(type==='audio_play'&&value===1){_this.setState({isFilePlaying:1,playbackStartTime:Date.now()});}_context9.next=18;break;case 15:_context9.prev=15;_context9.t0=_context9[\"catch\"](4);alert(_context9.t0.response.data);case 18:case\"end\":return _context9.stop();}}},_callee9,null,[[4,15]]);}));return function(_x2,_x3){return _ref9.apply(this,arguments);};}();return _this;}_createClass(AudioFilePlayer,[{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state6=this.state,alpha=_this$state6.alpha,audio_play=_this$state6.audio_play,audio_repeat=_this$state6.audio_repeat;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",className:classes.content},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Select,{onChange:this.handleFileChange,options:this.state.fileList})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(\"div\",null,\"Show Transcript\",/*#__PURE__*/React.createElement(Switch,{checked:this.state.showTranscript,onChange:this.handleCaptionToggle,color:\"primary\"}))),/*#__PURE__*/React.createElement(Grid,{item:true},this.state.showTranscript&&/*#__PURE__*/React.createElement(\"p\",null,this.state.prevWords,/*#__PURE__*/React.createElement(\"font\",{color:\"red\"},this.state.currWord),this.state.restWords)),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3,justify:\"space-between\",alignItems:\"center\"},/*#__PURE__*/React.createElement(\"div\",null,audio_repeat===0?/*#__PURE__*/React.createElement(SyncDisabledIcon// onClick={() =>\n//     this.handlePlayChange(\n//         \"audio_repeat\",\n//         1\n//     )\n// }\n,{onClick:this.handleRepeat,className:classes.icon}):/*#__PURE__*/React.createElement(LoopIcon// onClick={() =>\n//     this.handlePlayChange(\n//         \"audio_repeat\",\n//         0\n//     )\n// }\n,{onClick:this.cancelRepeat,className:classes.icon}),/*#__PURE__*/React.createElement(Typography,null,audio_repeat===1?\"Repeat\":\"Stop Repeat\")),/*#__PURE__*/React.createElement(\"div\",null,audio_play===0?/*#__PURE__*/React.createElement(PlayArrowIcon,{className:classes.icon,onClick:this.playFile}):/*#__PURE__*/React.createElement(PauseIcon,{onClick:this.pause,className:classes.icon}),/*#__PURE__*/React.createElement(Typography,null,\"Play/Pause\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(StopIcon,{className:classes.icon,onClick:function onClick(){return _this2.handlePlayChange(\"audio_reset\",1);}}),/*#__PURE__*/React.createElement(Typography,null,\"Reset\")))));}}]);return AudioFilePlayer;}(Component);export default withStyles(styles)(AudioFilePlayer);","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/src/components/audioFilePlayer.jsx"],"names":["React","Component","axios","withStyles","Paper","Grid","Typography","ToggleButton","PauseIcon","PlayArrowIcon","SyncDisabledIcon","LoopIcon","StopIcon","Select","Switch","AutoComplete","styles","theme","root","flexGrow","content","padding","spacing","width","minWidth","maxWidth","backgroundColor","icon","height","groupButton","color","defaultTranscript","checkWordFreq","AudioFilePlayer","state","fileList","currentFile","currentCaption","audioPath","audio_repeat","audio_play","showTranscript","playbackStartTime","isFilePlaying","prevWords","currWord","restWords","componentDidMount","get","fileResponse","pathResponse","data","forEach","element","push","value","label","transcript","setState","setInterval","getCurrentWord","updateParam","alert","response","componentWillUnmount","pause","post","left","audio_playing","handleFileChange","file","props","onChangeAudioFile","console","log","punct","concat","words","split","wordsInfo","fileLength","length","currentTime","Date","now","timeLapsed","index","start","slice","join","handleCaptionToggle","event","target","checked","playFile","preparePlay","filePath","audioData","audio_filename","alpha","dataToSend","right","method","handleRepeat","repsonse","cancelRepeat","handlePlayChange","type","audio_reset","dataInput","classes"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { axios } from \"utils/utils\";\nimport { withStyles } from \"@material-ui/styles\";\nimport Paper from '@material-ui/core/Paper';\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport PauseIcon from \"@material-ui/icons/Pause\";\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\nimport SyncDisabledIcon from \"@material-ui/icons/SyncDisabled\";\nimport LoopIcon from \"@material-ui/icons/Loop\";\nimport StopIcon from \"@material-ui/icons/Stop\";\nimport Select from \"react-select\";\nimport Switch from '@material-ui/core/Switch';\nimport { AutoComplete } from \"antd\";\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    content: {\n        padding: theme.spacing(3),\n        width: 'auto',\n        minWidth: 350,\n        maxWidth: 600,\n        // margin: 'auto',\n        backgroundColor: '#7FFFD4'\n    },\n    icon: {\n        width: 50,\n        height: 50,\n    },\n    groupButton: {\n        width: 320,\n        color: \"gray\",\n    },\n});\n\n// const options = [\"live\", \"Audio file\"];\nconst defaultTranscript = \"This file has no transcript.\";\nconst checkWordFreq = 10;\n\nclass AudioFilePlayer extends Component {\n    state = {\n        // 0 - audio, 1 - live file\n        // alpha: 1,\n        fileList: [],\n        currentFile: \"\",\n        currentCaption: \"\",\n        audioPath: \"\",\n        audio_repeat: 0,\n        audio_play: 0,\n        showTranscript: false,\n        playbackStartTime: 0,\n        isFilePlaying: 0,\n        prevWords: [],\n        currWord: \"\",\n        restWords: []\n    };\n\n    componentDidMount = async () => {\n        try {\n            const fileResponse = await axios.get(\"/api/researcher/fileNames\");\n            const pathResponse = await axios.get(\"/api/researcher/audioPath\");\n            let fileList = [];\n            let audioPath = pathResponse.data;\n            fileResponse.data.forEach((element) => {\n                fileList.push(\n                    {\n                        value: element.value,\n                        label: element.value,\n                        transcript: element.transcript\n                    }\n                );\n            });\n\n            this.setState({ fileList, audioPath });\n            setInterval(this.getCurrentWord, checkWordFreq);\n            setInterval(this.updateParam, 100);\n            // this.updateParam();\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    componentWillUnmount = async () => {\n        this.pause();\n    }\n\n    updateParam = async () => {\n        try {\n            const response = await axios.post(\"/api/param/getparam\");\n            let data = response.data;\n            // console.log(data.left.audio_playing);\n            this.setState({\n                audio_play: data.left.audio_playing,\n                isFilePlaying: data.left.audio_playing,\n                audio_repeat: data.left.audio_repeat,\n            });\n        } catch (error) {\n            throw error;\n        }\n    }\n\n    handleFileChange = async (file) => {\n        this.pause();\n\n        this.setState({\n            currentFile: file.value,\n        });\n\n        if(this.props.onChangeAudioFile){\n            this.props.onChangeAudioFile(file.value);\n        } \n\n        // If the file doesn't have transcript, set currentCaption as default message. The\n        // reason we pair the message with 'punct' key is to make the render more conveniently.\n        if (!file.transcript) {\n            console.log(\"No transcript found\");\n            this.setState({\n                currentCaption: {punct: defaultTranscript},\n                isFilePlaying: 0,\n                prevWords: [],\n                currWord: \"\",\n                restWords: defaultTranscript\n            });\n            return;\n        }\n        // If the file has transcript, get the transcript.\n        try {\n            const response = await axios.post(\"/api/researcher/jsonFile\", {data: this.state.audioPath.concat(file.transcript)});\n            // console.log(response.data);\n            this.setState({\n                currentCaption: response.data,\n                isFilePlaying: 0,\n                prevWords: [],\n                currWord: \"\",\n                restWords: response.data.punct\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    getCurrentWord = () => {\n        if (!this.state.currentFile || !this.state.currentCaption) {\n            return;\n        }\n\n        if (this.state.isFilePlaying === 0) {\n            return;\n        } else if (this.state.currentCaption.punct === defaultTranscript) {\n            return;\n        } else {\n            const words = this.state.currentCaption.punct.split(' ');\n            const wordsInfo = this.state.currentCaption.words;\n            const fileLength = this.state.currentCaption.length;\n            const currentTime = Date.now();\n            const timeLapsed = (currentTime - this.state.playbackStartTime) % fileLength;\n            // console.log(timeLapsed); // Why is it not a floating point number sometimes?\n            let index = 0;\n            while (index < wordsInfo.length - 1 && timeLapsed > wordsInfo[index + 1].start) {\n                index++;\n            }\n\n            let prevWords = \"\";\n            let currWord = \"\";\n            let restWords = \"\";\n            if (index === 0) {\n                prevWords = words.slice(0, index).join(' ');\n                currWord = words[index] + \" \";\n                // Assume there are more than 1 word, i.e. the max index > 0.\n                restWords = words.slice(index + 1).join(' ');\n            } else if (index === wordsInfo.length - 1) {\n                prevWords = words.slice(0, index).join(' ') + \" \";\n                currWord = words[index];\n                restWords = \"\";               \n            } else {\n                prevWords = words.slice(0, index).join(' ') + \" \";\n                currWord = words[index] + \" \";\n                restWords = words.slice(index + 1).join(' ');\n            }\n            this.setState({prevWords, currWord, restWords});\n        }\n    };\n\n    handleCaptionToggle = (event) => {\n        this.setState({\n            showTranscript: event.target.checked\n        });\n    }\n\n    playFile = async () => {\n        // Check if there is any preparation to do, like sending some HA parameters,\n        // before we send the audio file data to RT-MHA\n        const {preparePlay} = this.props;\n        if (preparePlay) {\n            preparePlay();\n        }\n\n        const {\n            currentFile,\n            audioPath,\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            alpha: 1,\n            audio_play: 1\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            // Set the states for closed captioning feature\n            this.setState({\n                audio_play: 1,\n                isFilePlaying: 1,\n                playbackStartTime: Date.now() // Get the current time as the start point at which we start to play the file\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    pause = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            audio_play: 0,\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            this.setState({\n                audio_play: 0,\n                isFilePlaying: 0\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    handleRepeat = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            // audio_filename: filePath,\n            // alpha: 1,\n            audio_repeat: 1,\n            audio_play: 1\n        };\n\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            const response = await axios.post(\"/api/param/setParam\", {\n                method: \"set\",\n                data: dataToSend\n            });\n            console.log(response.data);\n\n            this.setState({\n                audio_repeat: 1,\n                audio_play: 1,\n                isFilePlaying: 1,\n                playbackStartTime: Date.now()\n            })\n        } catch (error) {\n            alert(error.repsonse.data);\n        }\n    }\n\n    cancelRepeat = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            // audio_filename: filePath,\n            audio_repeat: 0,\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            this.setState({\n                audio_repeat: 0,\n                audio_play: 0,\n                isFilePlaying: 0\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    // Handle change for all play icons and stimulus options\n    handlePlayChange = async (type, value) => {\n        const {\n            currentFile,\n            // alpha,\n            audioPath,\n            audio_repeat,\n            audio_play,\n        } = this.state;\n        let filePath = audioPath.concat(currentFile);\n\n        // Switch between live data and stimulus file,\n        // if (type === \"alpha\") {\n        //     filePath = value === 1 ? audioPath.concat(currentFile) : \"\";\n        // } else {\n        //     filePath = alpha === 1 ? audioPath.concat(currentFile) : \"\";\n        // }\n        let audioData = {\n            audio_filename: filePath,\n            audio_reset:0,\n            audio_repeat,\n            audio_play,\n            // alpha,\n            //Add new value to override old value\n            [type]: value,\n        };\n        const dataInput = {\n            left: audioData,\n            right: audioData,\n        };\n        try {\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataInput,\n            });\n            const data = response.data;\n            console.log(data);\n            this.setState({\n                [type]: value,\n            });\n            console.log(this.state);\n\n            if (type === 'audio_play' && value === 1) {\n                this.setState({\n                    isFilePlaying: 1,\n                    playbackStartTime: Date.now()\n                });\n            }\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    render() {\n        const { classes } = this.props;\n        const { alpha, audio_play, audio_repeat } = this.state;\n        return (\n            <div className={classes.root}>\n                <Grid container direction=\"column\" className={classes.content}>\n                    <Grid item>\n                        <Select\n                            onChange={this.handleFileChange}\n                            options={this.state.fileList}\n                        />\n                    </Grid>\n                    <Grid item>\n                        <div>\n                            Show Transcript\n                            <Switch\n                                checked={this.state.showTranscript}\n                                onChange={this.handleCaptionToggle}\n                                color=\"primary\"\n                            />\n                        </div>\n                    </Grid>\n                    <Grid item>\n                        {this.state.showTranscript && (\n                            <p>\n                                {this.state.prevWords}\n                                <font color=\"red\">{this.state.currWord}</font>\n                                {this.state.restWords}\n                            </p>\n                        )}\n                    </Grid>\n                    <Grid\n                        container\n                        spacing={3}\n                        justify=\"space-between\"\n                        alignItems=\"center\"\n                    >\n                        <div>\n                            {audio_repeat === 0 ? (\n                                <SyncDisabledIcon\n                                    // onClick={() =>\n                                    //     this.handlePlayChange(\n                                    //         \"audio_repeat\",\n                                    //         1\n                                    //     )\n                                    // }\n                                    onClick={this.handleRepeat}\n                                    className={classes.icon}\n                                />\n                            ) : (\n                                <LoopIcon\n                                    // onClick={() =>\n                                    //     this.handlePlayChange(\n                                    //         \"audio_repeat\",\n                                    //         0\n                                    //     )\n                                    // }\n                                    onClick={this.cancelRepeat}\n                                    className={classes.icon}\n                                />\n                            )}\n                            <Typography>\n                                {audio_repeat === 1\n                                    ? \"Repeat\"\n                                    : \"Stop Repeat\"}\n                            </Typography>\n                        </div>\n\n                        <div>\n                            {audio_play === 0 ? (\n                                <PlayArrowIcon\n                                    className={classes.icon}\n                                    onClick={this.playFile}\n                                />\n                            ) : (\n                                <PauseIcon\n                                    onClick={this.pause}\n                                    className={classes.icon}\n                                />\n                            )}\n                            <Typography>{\"Play/Pause\"}</Typography>\n                        </div>\n\n                        <div>\n                            <StopIcon\n                                className={classes.icon}\n                                onClick={() =>\n                                    this.handlePlayChange(\"audio_reset\", 1)\n                                }\n                            />\n                            <Typography>{\"Reset\"}</Typography>\n                        </div>\n                    </Grid>\n                </Grid>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(AudioFilePlayer);\n"]},"metadata":{},"sourceType":"module"}
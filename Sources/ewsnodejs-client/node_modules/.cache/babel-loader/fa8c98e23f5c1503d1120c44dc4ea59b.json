{"ast":null,"code":"var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/* tslint:disable:member-ordering interface-name */\n\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Editor, EditorState, ContentState, CompositeDecorator, Modifier, getDefaultKeyBinding, KeyBindingUtil, DefaultDraftBlockRenderMap } from 'draft-js';\nimport { List, Map } from 'immutable';\nimport 'setimmediate';\nimport classnames from 'classnames';\nimport { createToolbar } from '../Toolbar';\nimport ConfigStore from './ConfigStore';\nimport GetHTML from './export/getHTML';\nimport exportText, { decodeContent } from './export/exportText';\nimport customHTML2Content from './customHTML2Content';\nvar hasCommandModifier = KeyBindingUtil.hasCommandModifier;\n\nfunction noop() {}\n\n;\nvar defaultPluginConfig = {};\nvar focusDummyStyle = {\n  width: 0,\n  opacity: 0,\n  border: 0,\n  position: 'absolute',\n  left: 0,\n  top: 0\n};\nvar toolbar = createToolbar();\nvar configStore = new ConfigStore();\n\nvar EditorCore = function (_React$Component) {\n  _inherits(EditorCore, _React$Component);\n\n  function EditorCore(props) {\n    _classCallCheck(this, EditorCore);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.cancelForceUpdateImmediate = function () {\n      clearImmediate(_this.forceUpdateImmediate);\n      _this.forceUpdateImmediate = null;\n    };\n\n    _this.handlePastedText = function (text, html) {\n      var editorState = _this.state.editorState;\n\n      if (html) {\n        var contentState = editorState.getCurrentContent();\n        var selection = editorState.getSelection();\n        var fragment = customHTML2Content(html, contentState);\n        var pastedContent = Modifier.replaceWithFragment(contentState, selection, fragment);\n        var newContent = pastedContent.merge({\n          selectionBefore: selection,\n          selectionAfter: pastedContent.getSelectionAfter().set('hasFocus', true)\n        });\n\n        _this.setEditorState(EditorState.push(editorState, newContent, 'insert-fragment'), true);\n\n        return 'handled';\n      }\n\n      return 'not-handled';\n    };\n\n    _this.plugins = List(List(props.plugins).flatten(true));\n    var editorState = void 0;\n\n    if (props.value !== undefined) {\n      if (props.value instanceof EditorState) {\n        editorState = props.value || EditorState.createEmpty();\n      } else {\n        editorState = EditorState.createEmpty();\n      }\n    } else {\n      editorState = EditorState.createEmpty();\n    }\n\n    editorState = _this.generatorDefaultValue(editorState);\n    _this.state = {\n      plugins: _this.reloadPlugins(),\n      editorState: editorState,\n      customStyleMap: {},\n      customBlockStyleMap: {},\n      compositeDecorator: null\n    };\n\n    if (props.value !== undefined) {\n      _this.controlledMode = true;\n    }\n\n    return _this;\n  }\n\n  EditorCore.ToEditorState = function ToEditorState(text) {\n    var createEmptyContentState = ContentState.createFromText(decodeContent(text) || '');\n    var editorState = EditorState.createWithContent(createEmptyContentState);\n    return EditorState.forceSelection(editorState, createEmptyContentState.getSelectionAfter());\n  };\n\n  EditorCore.prototype.getDefaultValue = function getDefaultValue() {\n    var _props = this.props,\n        defaultValue = _props.defaultValue,\n        value = _props.value;\n    return value || defaultValue;\n  };\n\n  EditorCore.prototype.Reset = function Reset() {\n    var defaultValue = this.getDefaultValue();\n    var contentState = defaultValue ? defaultValue.getCurrentContent() : ContentState.createFromText('');\n    var updatedEditorState = EditorState.push(this.state.editorState, contentState, 'remove-range');\n    this.setEditorState(EditorState.forceSelection(updatedEditorState, contentState.getSelectionBefore()));\n  };\n\n  EditorCore.prototype.SetText = function SetText(text) {\n    var createTextContentState = ContentState.createFromText(text || '');\n    var editorState = EditorState.push(this.state.editorState, createTextContentState, 'change-block-data');\n    this.setEditorState(EditorState.moveFocusToEnd(editorState), true);\n  };\n\n  EditorCore.prototype.getChildContext = function getChildContext() {\n    return {\n      getEditorState: this.getEditorState,\n      setEditorState: this.setEditorState\n    };\n  };\n\n  EditorCore.prototype.reloadPlugins = function reloadPlugins() {\n    var _this2 = this;\n\n    return this.plugins && this.plugins.size ? this.plugins.map(function (plugin) {\n      // 如果插件有 callbacks 方法,则认为插件已经加载。\n      if (plugin.callbacks) {\n        return plugin;\n      } // 如果插件有 constructor 方法,则构造插件\n\n\n      if (plugin.hasOwnProperty('constructor')) {\n        var pluginConfig = _extends(_this2.props.pluginConfig, plugin.config || {}, defaultPluginConfig);\n\n        return plugin.constructor(pluginConfig);\n      } // else 无效插件\n\n\n      console.warn('>> 插件: [', plugin.name, '] 无效。插件或许已经过期。');\n      return false;\n    }).filter(function (plugin) {\n      return plugin;\n    }).toArray() : [];\n  };\n\n  EditorCore.prototype.componentWillMount = function componentWillMount() {\n    var plugins = this.initPlugins().concat([toolbar]);\n    var customStyleMap = {};\n    var customBlockStyleMap = {};\n    var customBlockRenderMap = Map(DefaultDraftBlockRenderMap);\n    var toHTMLList = List([]); // initialize compositeDecorator\n\n    var compositeDecorator = new CompositeDecorator(plugins.filter(function (plugin) {\n      return plugin.decorators !== undefined;\n    }).map(function (plugin) {\n      return plugin.decorators;\n    }).reduce(function (prev, curr) {\n      return prev.concat(curr);\n    }, [])); // initialize Toolbar\n\n    var toolbarPlugins = List(plugins.filter(function (plugin) {\n      return !!plugin.component && plugin.name !== 'toolbar';\n    })); // load inline styles...\n\n    plugins.forEach(function (plugin) {\n      var styleMap = plugin.styleMap,\n          blockStyleMap = plugin.blockStyleMap,\n          blockRenderMap = plugin.blockRenderMap,\n          toHtml = plugin.toHtml;\n\n      if (styleMap) {\n        for (var key in styleMap) {\n          if (styleMap.hasOwnProperty(key)) {\n            customStyleMap[key] = styleMap[key];\n          }\n        }\n      }\n\n      if (blockStyleMap) {\n        for (var _key in blockStyleMap) {\n          if (blockStyleMap.hasOwnProperty(_key)) {\n            customBlockStyleMap[_key] = blockStyleMap[_key];\n            customBlockRenderMap = customBlockRenderMap.set(_key, {\n              element: null\n            });\n          }\n        }\n      }\n\n      if (toHtml) {\n        toHTMLList = toHTMLList.push(toHtml);\n      }\n\n      if (blockRenderMap) {\n        for (var _key2 in blockRenderMap) {\n          if (blockRenderMap.hasOwnProperty(_key2)) {\n            customBlockRenderMap = customBlockRenderMap.set(_key2, blockRenderMap[_key2]);\n          }\n        }\n      }\n    });\n    configStore.set('customStyleMap', customStyleMap);\n    configStore.set('customBlockStyleMap', customBlockStyleMap);\n    configStore.set('blockRenderMap', customBlockRenderMap);\n    configStore.set('customStyleFn', this.customStyleFn.bind(this));\n    configStore.set('toHTMLList', toHTMLList);\n    this.setState({\n      toolbarPlugins: toolbarPlugins,\n      compositeDecorator: compositeDecorator\n    });\n    this.setEditorState(EditorState.set(this.state.editorState, {\n      decorator: compositeDecorator\n    }), false, false);\n  };\n\n  EditorCore.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if (this.forceUpdateImmediate) {\n      this.cancelForceUpdateImmediate();\n    }\n\n    if (this.controlledMode) {\n      var decorators = nextProps.value.getDecorator();\n      var editorState = decorators ? nextProps.value : EditorState.set(nextProps.value, {\n        decorator: this.state.compositeDecorator\n      });\n      this.setState({\n        editorState: editorState\n      });\n    }\n  };\n\n  EditorCore.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.cancelForceUpdateImmediate();\n  }; // 处理 value\n\n\n  EditorCore.prototype.generatorDefaultValue = function generatorDefaultValue(editorState) {\n    var defaultValue = this.getDefaultValue();\n\n    if (defaultValue) {\n      return defaultValue;\n    }\n\n    return editorState;\n  };\n\n  EditorCore.prototype.getStyleMap = function getStyleMap() {\n    return configStore.get('customStyleMap');\n  };\n\n  EditorCore.prototype.setStyleMap = function setStyleMap(customStyleMap) {\n    configStore.set('customStyleMap', customStyleMap);\n    this.render();\n  };\n\n  EditorCore.prototype.initPlugins = function initPlugins() {\n    var _this3 = this;\n\n    var enableCallbacks = ['focus', 'getEditorState', 'setEditorState', 'getStyleMap', 'setStyleMap'];\n    return this.getPlugins().map(function (plugin) {\n      enableCallbacks.forEach(function (callbackName) {\n        if (plugin.callbacks.hasOwnProperty(callbackName)) {\n          plugin.callbacks[callbackName] = _this3[callbackName].bind(_this3);\n        }\n      });\n      return plugin;\n    });\n  };\n\n  EditorCore.prototype.focusEditor = function focusEditor(ev) {\n    this.refs.editor.focus(ev);\n\n    if (this.props.readOnly) {\n      this._focusDummy.focus();\n    }\n\n    if (this.props.onFocus) {\n      this.props.onFocus(ev);\n    }\n  };\n\n  EditorCore.prototype._focus = function _focus(ev) {\n    if (!ev || !ev.nativeEvent || !ev.nativeEvent.target) {\n      return;\n    }\n\n    if (document.activeElement && document.activeElement.getAttribute('contenteditable') === 'true') {\n      return;\n    }\n\n    return this.focus(ev);\n  };\n\n  EditorCore.prototype.focus = function focus(ev) {\n    var _this4 = this;\n\n    var event = ev && ev.nativeEvent;\n\n    if (event && event.target === this._editorWrapper) {\n      var editorState = this.state.editorState;\n      var selection = editorState.getSelection();\n\n      if (!selection.getHasFocus()) {\n        if (selection.isCollapsed()) {\n          return this.setState({\n            editorState: EditorState.moveSelectionToEnd(editorState)\n          }, function () {\n            _this4.focusEditor(ev);\n          });\n        }\n      }\n    }\n\n    this.focusEditor(ev);\n  };\n\n  EditorCore.prototype.getPlugins = function getPlugins() {\n    return this.state.plugins.slice();\n  };\n\n  EditorCore.prototype.getEventHandler = function getEventHandler() {\n    var _this5 = this;\n\n    var enabledEvents = ['onUpArrow', 'onDownArrow', 'handleReturn', 'onFocus', 'onBlur', 'onTab', 'handlePastedText'];\n    var eventHandler = {};\n    enabledEvents.forEach(function (event) {\n      eventHandler[event] = _this5.generatorEventHandler(event);\n    });\n    return eventHandler;\n  };\n\n  EditorCore.prototype.getEditorState = function getEditorState() {\n    var needFocus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (needFocus) {\n      this.refs.editor.focus();\n    }\n\n    return this.state.editorState;\n  };\n\n  EditorCore.prototype.setEditorState = function setEditorState(editorState) {\n    var _this6 = this;\n\n    var focusEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var triggerChange = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var newEditorState = editorState;\n    this.getPlugins().forEach(function (plugin) {\n      if (plugin.onChange) {\n        var updatedEditorState = plugin.onChange(newEditorState);\n\n        if (updatedEditorState) {\n          newEditorState = updatedEditorState;\n        }\n      }\n    });\n\n    if (this.props.onChange && triggerChange) {\n      this.props.onChange(newEditorState); // close this issue https://github.com/ant-design/ant-design/issues/5788\n      // when onChange not take any effect\n      // `<Editor />` won't rerender cause no props is changed.\n      // add an timeout here,\n      // if props.onChange not trigger componentWillReceiveProps,\n      // we will force render Editor with previous editorState,\n\n      if (this.controlledMode) {\n        this.forceUpdateImmediate = setImmediate(function () {\n          return _this6.setState({\n            editorState: new EditorState(_this6.state.editorState.getImmutable())\n          });\n        });\n      }\n    }\n\n    if (!this.controlledMode) {\n      this.setState({\n        editorState: newEditorState\n      }, focusEditor ? function () {\n        return setImmediate(function () {\n          return _this6.refs.editor.focus();\n        });\n      } : noop);\n    }\n  };\n\n  EditorCore.prototype.handleKeyBinding = function handleKeyBinding(ev) {\n    if (this.props.onKeyDown) {\n      ev.ctrlKey = hasCommandModifier(ev);\n      var keyDownResult = this.props.onKeyDown(ev);\n\n      if (keyDownResult) {\n        return keyDownResult;\n      }\n\n      return getDefaultKeyBinding(ev);\n    }\n\n    return getDefaultKeyBinding(ev);\n  };\n\n  EditorCore.prototype.handleKeyCommand = function handleKeyCommand(command) {\n    if (this.props.multiLines) {\n      return this.eventHandle('handleKeyBinding', command);\n    }\n\n    return command === 'split-block' ? 'handled' : 'not-handled';\n  };\n\n  EditorCore.prototype.getBlockStyle = function getBlockStyle(contentBlock) {\n    var customBlockStyleMap = configStore.get('customBlockStyleMap');\n    var type = contentBlock.getType();\n\n    if (customBlockStyleMap.hasOwnProperty(type)) {\n      return customBlockStyleMap[type];\n    }\n\n    return '';\n  };\n\n  EditorCore.prototype.blockRendererFn = function blockRendererFn(contentBlock) {\n    var blockRenderResult = null;\n    this.getPlugins().forEach(function (plugin) {\n      if (plugin.blockRendererFn) {\n        var result = plugin.blockRendererFn(contentBlock);\n\n        if (result) {\n          blockRenderResult = result;\n        }\n      }\n    });\n    return blockRenderResult;\n  };\n\n  EditorCore.prototype.eventHandle = function eventHandle(eventName) {\n    var _props2;\n\n    var plugins = this.getPlugins();\n\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key3 = 1; _key3 < _len; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n\n    for (var i = 0; i < plugins.length; i++) {\n      var plugin = plugins[i];\n\n      if (plugin.callbacks[eventName] && typeof plugin.callbacks[eventName] === 'function') {\n        var _plugin$callbacks;\n\n        var result = (_plugin$callbacks = plugin.callbacks)[eventName].apply(_plugin$callbacks, args);\n\n        if (result === true) {\n          return 'handled';\n        }\n      }\n    }\n\n    return this.props.hasOwnProperty(eventName) && (_props2 = this.props)[eventName].apply(_props2, args) === true ? 'handled' : 'not-handled';\n  };\n\n  EditorCore.prototype.generatorEventHandler = function generatorEventHandler(eventName) {\n    var _this7 = this;\n\n    return function () {\n      for (var _len2 = arguments.length, args = Array(_len2), _key4 = 0; _key4 < _len2; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return _this7.eventHandle.apply(_this7, [eventName].concat(args));\n    };\n  };\n\n  EditorCore.prototype.customStyleFn = function customStyleFn(styleSet) {\n    if (styleSet.size === 0) {\n      return {};\n    }\n\n    var plugins = this.getPlugins();\n    var resultStyle = {};\n\n    for (var i = 0; i < plugins.length; i++) {\n      if (plugins[i].customStyleFn) {\n        var styled = plugins[i].customStyleFn(styleSet);\n\n        if (styled) {\n          _extends(resultStyle, styled);\n        }\n      }\n    }\n\n    return resultStyle;\n  };\n\n  EditorCore.prototype.render = function render() {\n    var _classnames,\n        _this8 = this;\n\n    var _props3 = this.props,\n        prefixCls = _props3.prefixCls,\n        toolbars = _props3.toolbars,\n        style = _props3.style,\n        readOnly = _props3.readOnly,\n        multiLines = _props3.multiLines;\n    var _state = this.state,\n        editorState = _state.editorState,\n        toolbarPlugins = _state.toolbarPlugins;\n    var customStyleMap = configStore.get('customStyleMap');\n    var blockRenderMap = configStore.get('blockRenderMap');\n    var eventHandler = this.getEventHandler();\n    var Toolbar = toolbar.component;\n    var cls = classnames((_classnames = {}, _classnames[prefixCls + '-editor'] = true, _classnames.readonly = readOnly, _classnames.oneline = !multiLines, _classnames));\n    return React.createElement('div', {\n      style: style,\n      className: cls,\n      onClick: this._focus.bind(this)\n    }, React.createElement(Toolbar, {\n      editorState: editorState,\n      prefixCls: prefixCls,\n      className: prefixCls + '-toolbar',\n      plugins: toolbarPlugins,\n      toolbars: toolbars\n    }), React.createElement('div', {\n      className: prefixCls + '-editor-wrapper',\n      ref: function ref(ele) {\n        return _this8._editorWrapper = ele;\n      },\n      style: style,\n      onClick: function onClick(ev) {\n        return ev.preventDefault();\n      }\n    }, React.createElement(Editor, _extends({}, this.props, eventHandler, {\n      ref: 'editor',\n      customStyleMap: customStyleMap,\n      customStyleFn: this.customStyleFn.bind(this),\n      editorState: editorState,\n      handleKeyCommand: this.handleKeyCommand.bind(this),\n      keyBindingFn: this.handleKeyBinding.bind(this),\n      onChange: this.setEditorState.bind(this),\n      blockStyleFn: this.getBlockStyle.bind(this),\n      blockRenderMap: blockRenderMap,\n      handlePastedText: this.handlePastedText,\n      blockRendererFn: this.blockRendererFn.bind(this)\n    })), readOnly ? React.createElement('input', {\n      style: focusDummyStyle,\n      ref: function ref(ele) {\n        return _this8._focusDummy = ele;\n      },\n      onBlur: eventHandler.onBlur\n    }) : null, this.props.children));\n  };\n\n  return EditorCore;\n}(React.Component);\n\nEditorCore.GetText = exportText;\nEditorCore.GetHTML = GetHTML(configStore);\nEditorCore.defaultProps = {\n  multiLines: true,\n  plugins: [],\n  prefixCls: 'rc-editor-core',\n  pluginConfig: {},\n  toolbars: [],\n  spilitLine: 'enter'\n};\nEditorCore.childContextTypes = {\n  getEditorState: PropTypes.func,\n  setEditorState: PropTypes.func\n};\nexport default EditorCore;","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/rc-editor-core/es/EditorCore/index.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","React","PropTypes","Editor","EditorState","ContentState","CompositeDecorator","Modifier","getDefaultKeyBinding","KeyBindingUtil","DefaultDraftBlockRenderMap","List","Map","classnames","createToolbar","ConfigStore","GetHTML","exportText","decodeContent","customHTML2Content","hasCommandModifier","noop","defaultPluginConfig","focusDummyStyle","width","opacity","border","position","left","top","toolbar","configStore","EditorCore","_React$Component","props","_this","cancelForceUpdateImmediate","clearImmediate","forceUpdateImmediate","handlePastedText","text","html","editorState","state","contentState","getCurrentContent","selection","getSelection","fragment","pastedContent","replaceWithFragment","newContent","merge","selectionBefore","selectionAfter","getSelectionAfter","set","setEditorState","push","plugins","flatten","undefined","createEmpty","generatorDefaultValue","reloadPlugins","customStyleMap","customBlockStyleMap","compositeDecorator","controlledMode","ToEditorState","createEmptyContentState","createFromText","createWithContent","forceSelection","getDefaultValue","_props","defaultValue","Reset","updatedEditorState","getSelectionBefore","SetText","createTextContentState","moveFocusToEnd","getChildContext","getEditorState","_this2","size","map","plugin","callbacks","pluginConfig","config","console","warn","name","filter","toArray","componentWillMount","initPlugins","concat","customBlockRenderMap","toHTMLList","decorators","reduce","prev","curr","toolbarPlugins","component","forEach","styleMap","blockStyleMap","blockRenderMap","toHtml","_key","element","_key2","customStyleFn","bind","setState","decorator","componentWillReceiveProps","nextProps","getDecorator","componentWillUnmount","getStyleMap","get","setStyleMap","render","_this3","enableCallbacks","getPlugins","callbackName","focusEditor","ev","refs","editor","focus","readOnly","_focusDummy","onFocus","_focus","nativeEvent","document","activeElement","getAttribute","_this4","event","_editorWrapper","getHasFocus","isCollapsed","moveSelectionToEnd","slice","getEventHandler","_this5","enabledEvents","eventHandler","generatorEventHandler","needFocus","_this6","triggerChange","newEditorState","onChange","setImmediate","getImmutable","handleKeyBinding","onKeyDown","ctrlKey","keyDownResult","handleKeyCommand","command","multiLines","eventHandle","getBlockStyle","contentBlock","type","getType","blockRendererFn","blockRenderResult","result","eventName","_props2","_len","args","Array","_key3","_plugin$callbacks","apply","_this7","_len2","_key4","styleSet","resultStyle","styled","_classnames","_this8","_props3","prefixCls","toolbars","style","_state","Toolbar","cls","readonly","oneline","createElement","className","onClick","ref","ele","preventDefault","keyBindingFn","blockStyleFn","onBlur","children","Component","GetText","defaultProps","spilitLine","childContextTypes","func"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,SAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,UAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,QAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,SAAOL,MAAP;AAAgB,CAAhQ;;AAEA,SAASS,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,0BAAT,CAAoCC,IAApC,EAA0CN,IAA1C,EAAgD;AAAE,MAAI,CAACM,IAAL,EAAW;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOP,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAJ,GAAmEA,IAAnE,GAA0EM,IAAjF;AAAwF;;AAEhP,SAASE,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIN,SAAJ,CAAc,6DAA6D,OAAOM,UAAlF,CAAN;AAAsG;;AAACD,EAAAA,QAAQ,CAACX,SAAT,GAAqBR,MAAM,CAACqB,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAACZ,SAAvC,EAAkD;AAAEc,IAAAA,WAAW,EAAE;AAAEC,MAAAA,KAAK,EAAEJ,QAAT;AAAmBK,MAAAA,UAAU,EAAE,KAA/B;AAAsCC,MAAAA,QAAQ,EAAE,IAAhD;AAAsDC,MAAAA,YAAY,EAAE;AAApE;AAAf,GAAlD,CAArB;AAAqK,MAAIN,UAAJ,EAAgBpB,MAAM,CAAC2B,cAAP,GAAwB3B,MAAM,CAAC2B,cAAP,CAAsBR,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,QAAQ,CAACS,SAAT,GAAqBR,UAA3F;AAAwG;AAE9e;;;AACA,OAAOS,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,MAAT,EAAiBC,WAAjB,EAA8BC,YAA9B,EAA4CC,kBAA5C,EAAgEC,QAAhE,EAA0EC,oBAA1E,EAAgGC,cAAhG,EAAgHC,0BAAhH,QAAkJ,UAAlJ;AACA,SAASC,IAAT,EAAeC,GAAf,QAA0B,WAA1B;AACA,OAAO,cAAP;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,aAAT,QAA8B,YAA9B;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,OAAOC,UAAP,IAAqBC,aAArB,QAA0C,qBAA1C;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,IAAIC,kBAAkB,GAAGX,cAAc,CAACW,kBAAxC;;AAEA,SAASC,IAAT,GAAgB,CAAE;;AAClB;AACA,IAAIC,mBAAmB,GAAG,EAA1B;AACA,IAAIC,eAAe,GAAG;AAClBC,EAAAA,KAAK,EAAE,CADW;AAElBC,EAAAA,OAAO,EAAE,CAFS;AAGlBC,EAAAA,MAAM,EAAE,CAHU;AAIlBC,EAAAA,QAAQ,EAAE,UAJQ;AAKlBC,EAAAA,IAAI,EAAE,CALY;AAMlBC,EAAAA,GAAG,EAAE;AANa,CAAtB;AAQA,IAAIC,OAAO,GAAGhB,aAAa,EAA3B;AACA,IAAIiB,WAAW,GAAG,IAAIhB,WAAJ,EAAlB;;AAEA,IAAIiB,UAAU,GAAG,UAAUC,gBAAV,EAA4B;AACzC3C,EAAAA,SAAS,CAAC0C,UAAD,EAAaC,gBAAb,CAAT;;AAEA,WAASD,UAAT,CAAoBE,KAApB,EAA2B;AACvBnD,IAAAA,eAAe,CAAC,IAAD,EAAOiD,UAAP,CAAf;;AAEA,QAAIG,KAAK,GAAGhD,0BAA0B,CAAC,IAAD,EAAO8C,gBAAgB,CAACnD,IAAjB,CAAsB,IAAtB,EAA4BoD,KAA5B,CAAP,CAAtC;;AAEAC,IAAAA,KAAK,CAACC,0BAAN,GAAmC,YAAY;AAC3CC,MAAAA,cAAc,CAACF,KAAK,CAACG,oBAAP,CAAd;AACAH,MAAAA,KAAK,CAACG,oBAAN,GAA6B,IAA7B;AACH,KAHD;;AAIAH,IAAAA,KAAK,CAACI,gBAAN,GAAyB,UAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AAC3C,UAAIC,WAAW,GAAGP,KAAK,CAACQ,KAAN,CAAYD,WAA9B;;AAEA,UAAID,IAAJ,EAAU;AACN,YAAIG,YAAY,GAAGF,WAAW,CAACG,iBAAZ,EAAnB;AACA,YAAIC,SAAS,GAAGJ,WAAW,CAACK,YAAZ,EAAhB;AACA,YAAIC,QAAQ,GAAG7B,kBAAkB,CAACsB,IAAD,EAAOG,YAAP,CAAjC;AACA,YAAIK,aAAa,GAAG1C,QAAQ,CAAC2C,mBAAT,CAA6BN,YAA7B,EAA2CE,SAA3C,EAAsDE,QAAtD,CAApB;AACA,YAAIG,UAAU,GAAGF,aAAa,CAACG,KAAd,CAAoB;AACjCC,UAAAA,eAAe,EAAEP,SADgB;AAEjCQ,UAAAA,cAAc,EAAEL,aAAa,CAACM,iBAAd,GAAkCC,GAAlC,CAAsC,UAAtC,EAAkD,IAAlD;AAFiB,SAApB,CAAjB;;AAIArB,QAAAA,KAAK,CAACsB,cAAN,CAAqBrD,WAAW,CAACsD,IAAZ,CAAiBhB,WAAjB,EAA8BS,UAA9B,EAA0C,iBAA1C,CAArB,EAAmF,IAAnF;;AACA,eAAO,SAAP;AACH;;AACD,aAAO,aAAP;AACH,KAhBD;;AAiBAhB,IAAAA,KAAK,CAACwB,OAAN,GAAgBhD,IAAI,CAACA,IAAI,CAACuB,KAAK,CAACyB,OAAP,CAAJ,CAAoBC,OAApB,CAA4B,IAA5B,CAAD,CAApB;AACA,QAAIlB,WAAW,GAAG,KAAK,CAAvB;;AACA,QAAIR,KAAK,CAACvC,KAAN,KAAgBkE,SAApB,EAA+B;AAC3B,UAAI3B,KAAK,CAACvC,KAAN,YAAuBS,WAA3B,EAAwC;AACpCsC,QAAAA,WAAW,GAAGR,KAAK,CAACvC,KAAN,IAAeS,WAAW,CAAC0D,WAAZ,EAA7B;AACH,OAFD,MAEO;AACHpB,QAAAA,WAAW,GAAGtC,WAAW,CAAC0D,WAAZ,EAAd;AACH;AACJ,KAND,MAMO;AACHpB,MAAAA,WAAW,GAAGtC,WAAW,CAAC0D,WAAZ,EAAd;AACH;;AACDpB,IAAAA,WAAW,GAAGP,KAAK,CAAC4B,qBAAN,CAA4BrB,WAA5B,CAAd;AACAP,IAAAA,KAAK,CAACQ,KAAN,GAAc;AACVgB,MAAAA,OAAO,EAAExB,KAAK,CAAC6B,aAAN,EADC;AAEVtB,MAAAA,WAAW,EAAEA,WAFH;AAGVuB,MAAAA,cAAc,EAAE,EAHN;AAIVC,MAAAA,mBAAmB,EAAE,EAJX;AAKVC,MAAAA,kBAAkB,EAAE;AALV,KAAd;;AAOA,QAAIjC,KAAK,CAACvC,KAAN,KAAgBkE,SAApB,EAA+B;AAC3B1B,MAAAA,KAAK,CAACiC,cAAN,GAAuB,IAAvB;AACH;;AACD,WAAOjC,KAAP;AACH;;AAEDH,EAAAA,UAAU,CAACqC,aAAX,GAA2B,SAASA,aAAT,CAAuB7B,IAAvB,EAA6B;AACpD,QAAI8B,uBAAuB,GAAGjE,YAAY,CAACkE,cAAb,CAA4BrD,aAAa,CAACsB,IAAD,CAAb,IAAuB,EAAnD,CAA9B;AACA,QAAIE,WAAW,GAAGtC,WAAW,CAACoE,iBAAZ,CAA8BF,uBAA9B,CAAlB;AACA,WAAOlE,WAAW,CAACqE,cAAZ,CAA2B/B,WAA3B,EAAwC4B,uBAAuB,CAACf,iBAAxB,EAAxC,CAAP;AACH,GAJD;;AAMAvB,EAAAA,UAAU,CAACpD,SAAX,CAAqB8F,eAArB,GAAuC,SAASA,eAAT,GAA2B;AAC9D,QAAIC,MAAM,GAAG,KAAKzC,KAAlB;AAAA,QACI0C,YAAY,GAAGD,MAAM,CAACC,YAD1B;AAAA,QAEIjF,KAAK,GAAGgF,MAAM,CAAChF,KAFnB;AAIA,WAAOA,KAAK,IAAIiF,YAAhB;AACH,GAND;;AAQA5C,EAAAA,UAAU,CAACpD,SAAX,CAAqBiG,KAArB,GAA6B,SAASA,KAAT,GAAiB;AAC1C,QAAID,YAAY,GAAG,KAAKF,eAAL,EAAnB;AACA,QAAI9B,YAAY,GAAGgC,YAAY,GAAGA,YAAY,CAAC/B,iBAAb,EAAH,GAAsCxC,YAAY,CAACkE,cAAb,CAA4B,EAA5B,CAArE;AACA,QAAIO,kBAAkB,GAAG1E,WAAW,CAACsD,IAAZ,CAAiB,KAAKf,KAAL,CAAWD,WAA5B,EAAyCE,YAAzC,EAAuD,cAAvD,CAAzB;AACA,SAAKa,cAAL,CAAoBrD,WAAW,CAACqE,cAAZ,CAA2BK,kBAA3B,EAA+ClC,YAAY,CAACmC,kBAAb,EAA/C,CAApB;AACH,GALD;;AAOA/C,EAAAA,UAAU,CAACpD,SAAX,CAAqBoG,OAArB,GAA+B,SAASA,OAAT,CAAiBxC,IAAjB,EAAuB;AAClD,QAAIyC,sBAAsB,GAAG5E,YAAY,CAACkE,cAAb,CAA4B/B,IAAI,IAAI,EAApC,CAA7B;AACA,QAAIE,WAAW,GAAGtC,WAAW,CAACsD,IAAZ,CAAiB,KAAKf,KAAL,CAAWD,WAA5B,EAAyCuC,sBAAzC,EAAiE,mBAAjE,CAAlB;AACA,SAAKxB,cAAL,CAAoBrD,WAAW,CAAC8E,cAAZ,CAA2BxC,WAA3B,CAApB,EAA6D,IAA7D;AACH,GAJD;;AAMAV,EAAAA,UAAU,CAACpD,SAAX,CAAqBuG,eAArB,GAAuC,SAASA,eAAT,GAA2B;AAC9D,WAAO;AACHC,MAAAA,cAAc,EAAE,KAAKA,cADlB;AAEH3B,MAAAA,cAAc,EAAE,KAAKA;AAFlB,KAAP;AAIH,GALD;;AAOAzB,EAAAA,UAAU,CAACpD,SAAX,CAAqBoF,aAArB,GAAqC,SAASA,aAAT,GAAyB;AAC1D,QAAIqB,MAAM,GAAG,IAAb;;AAEA,WAAO,KAAK1B,OAAL,IAAgB,KAAKA,OAAL,CAAa2B,IAA7B,GAAoC,KAAK3B,OAAL,CAAa4B,GAAb,CAAiB,UAAUC,MAAV,EAAkB;AAC1E;AACA,UAAIA,MAAM,CAACC,SAAX,EAAsB;AAClB,eAAOD,MAAP;AACH,OAJyE,CAK1E;;;AACA,UAAIA,MAAM,CAAC3G,cAAP,CAAsB,aAAtB,CAAJ,EAA0C;AACtC,YAAI6G,YAAY,GAAGvH,QAAQ,CAACkH,MAAM,CAACnD,KAAP,CAAawD,YAAd,EAA4BF,MAAM,CAACG,MAAP,IAAiB,EAA7C,EAAiDrE,mBAAjD,CAA3B;;AACA,eAAOkE,MAAM,CAAC9F,WAAP,CAAmBgG,YAAnB,CAAP;AACH,OATyE,CAU1E;;;AACAE,MAAAA,OAAO,CAACC,IAAR,CAAa,UAAb,EAAyBL,MAAM,CAACM,IAAhC,EAAsC,gBAAtC;AACA,aAAO,KAAP;AACH,KAb0C,EAaxCC,MAbwC,CAajC,UAAUP,MAAV,EAAkB;AACxB,aAAOA,MAAP;AACH,KAf0C,EAexCQ,OAfwC,EAApC,GAeQ,EAff;AAgBH,GAnBD;;AAqBAhE,EAAAA,UAAU,CAACpD,SAAX,CAAqBqH,kBAArB,GAA0C,SAASA,kBAAT,GAA8B;AACpE,QAAItC,OAAO,GAAG,KAAKuC,WAAL,GAAmBC,MAAnB,CAA0B,CAACrE,OAAD,CAA1B,CAAd;AACA,QAAImC,cAAc,GAAG,EAArB;AACA,QAAIC,mBAAmB,GAAG,EAA1B;AACA,QAAIkC,oBAAoB,GAAGxF,GAAG,CAACF,0BAAD,CAA9B;AACA,QAAI2F,UAAU,GAAG1F,IAAI,CAAC,EAAD,CAArB,CALoE,CAMpE;;AACA,QAAIwD,kBAAkB,GAAG,IAAI7D,kBAAJ,CAAuBqD,OAAO,CAACoC,MAAR,CAAe,UAAUP,MAAV,EAAkB;AAC7E,aAAOA,MAAM,CAACc,UAAP,KAAsBzC,SAA7B;AACH,KAF+C,EAE7C0B,GAF6C,CAEzC,UAAUC,MAAV,EAAkB;AACrB,aAAOA,MAAM,CAACc,UAAd;AACH,KAJ+C,EAI7CC,MAJ6C,CAItC,UAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AAC5B,aAAOD,IAAI,CAACL,MAAL,CAAYM,IAAZ,CAAP;AACH,KAN+C,EAM7C,EAN6C,CAAvB,CAAzB,CAPoE,CAcpE;;AACA,QAAIC,cAAc,GAAG/F,IAAI,CAACgD,OAAO,CAACoC,MAAR,CAAe,UAAUP,MAAV,EAAkB;AACvD,aAAO,CAAC,CAACA,MAAM,CAACmB,SAAT,IAAsBnB,MAAM,CAACM,IAAP,KAAgB,SAA7C;AACH,KAFyB,CAAD,CAAzB,CAfoE,CAkBpE;;AACAnC,IAAAA,OAAO,CAACiD,OAAR,CAAgB,UAAUpB,MAAV,EAAkB;AAC9B,UAAIqB,QAAQ,GAAGrB,MAAM,CAACqB,QAAtB;AAAA,UACIC,aAAa,GAAGtB,MAAM,CAACsB,aAD3B;AAAA,UAEIC,cAAc,GAAGvB,MAAM,CAACuB,cAF5B;AAAA,UAGIC,MAAM,GAAGxB,MAAM,CAACwB,MAHpB;;AAKA,UAAIH,QAAJ,EAAc;AACV,aAAK,IAAIlI,GAAT,IAAgBkI,QAAhB,EAA0B;AACtB,cAAIA,QAAQ,CAAChI,cAAT,CAAwBF,GAAxB,CAAJ,EAAkC;AAC9BsF,YAAAA,cAAc,CAACtF,GAAD,CAAd,GAAsBkI,QAAQ,CAAClI,GAAD,CAA9B;AACH;AACJ;AACJ;;AACD,UAAImI,aAAJ,EAAmB;AACf,aAAK,IAAIG,IAAT,IAAiBH,aAAjB,EAAgC;AAC5B,cAAIA,aAAa,CAACjI,cAAd,CAA6BoI,IAA7B,CAAJ,EAAwC;AACpC/C,YAAAA,mBAAmB,CAAC+C,IAAD,CAAnB,GAA4BH,aAAa,CAACG,IAAD,CAAzC;AACAb,YAAAA,oBAAoB,GAAGA,oBAAoB,CAAC5C,GAArB,CAAyByD,IAAzB,EAA+B;AAClDC,cAAAA,OAAO,EAAE;AADyC,aAA/B,CAAvB;AAGH;AACJ;AACJ;;AACD,UAAIF,MAAJ,EAAY;AACRX,QAAAA,UAAU,GAAGA,UAAU,CAAC3C,IAAX,CAAgBsD,MAAhB,CAAb;AACH;;AACD,UAAID,cAAJ,EAAoB;AAChB,aAAK,IAAII,KAAT,IAAkBJ,cAAlB,EAAkC;AAC9B,cAAIA,cAAc,CAAClI,cAAf,CAA8BsI,KAA9B,CAAJ,EAA0C;AACtCf,YAAAA,oBAAoB,GAAGA,oBAAoB,CAAC5C,GAArB,CAAyB2D,KAAzB,EAAgCJ,cAAc,CAACI,KAAD,CAA9C,CAAvB;AACH;AACJ;AACJ;AACJ,KAjCD;AAkCApF,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,gBAAhB,EAAkCS,cAAlC;AACAlC,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,qBAAhB,EAAuCU,mBAAvC;AACAnC,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,gBAAhB,EAAkC4C,oBAAlC;AACArE,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,eAAhB,EAAiC,KAAK4D,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAAjC;AACAtF,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,YAAhB,EAA8B6C,UAA9B;AACA,SAAKiB,QAAL,CAAc;AACVZ,MAAAA,cAAc,EAAEA,cADN;AAEVvC,MAAAA,kBAAkB,EAAEA;AAFV,KAAd;AAIA,SAAKV,cAAL,CAAoBrD,WAAW,CAACoD,GAAZ,CAAgB,KAAKb,KAAL,CAAWD,WAA3B,EAAwC;AAAE6E,MAAAA,SAAS,EAAEpD;AAAb,KAAxC,CAApB,EAAgG,KAAhG,EAAuG,KAAvG;AACH,GA/DD;;AAiEAnC,EAAAA,UAAU,CAACpD,SAAX,CAAqB4I,yBAArB,GAAiD,SAASA,yBAAT,CAAmCC,SAAnC,EAA8C;AAC3F,QAAI,KAAKnF,oBAAT,EAA+B;AAC3B,WAAKF,0BAAL;AACH;;AACD,QAAI,KAAKgC,cAAT,EAAyB;AACrB,UAAIkC,UAAU,GAAGmB,SAAS,CAAC9H,KAAV,CAAgB+H,YAAhB,EAAjB;AACA,UAAIhF,WAAW,GAAG4D,UAAU,GAAGmB,SAAS,CAAC9H,KAAb,GAAqBS,WAAW,CAACoD,GAAZ,CAAgBiE,SAAS,CAAC9H,KAA1B,EAAiC;AAAE4H,QAAAA,SAAS,EAAE,KAAK5E,KAAL,CAAWwB;AAAxB,OAAjC,CAAjD;AACA,WAAKmD,QAAL,CAAc;AACV5E,QAAAA,WAAW,EAAEA;AADH,OAAd;AAGH;AACJ,GAXD;;AAaAV,EAAAA,UAAU,CAACpD,SAAX,CAAqB+I,oBAArB,GAA4C,SAASA,oBAAT,GAAgC;AACxE,SAAKvF,0BAAL;AACH,GAFD,CA3LyC,CA8LzC;;;AAGAJ,EAAAA,UAAU,CAACpD,SAAX,CAAqBmF,qBAArB,GAA6C,SAASA,qBAAT,CAA+BrB,WAA/B,EAA4C;AACrF,QAAIkC,YAAY,GAAG,KAAKF,eAAL,EAAnB;;AACA,QAAIE,YAAJ,EAAkB;AACd,aAAOA,YAAP;AACH;;AACD,WAAOlC,WAAP;AACH,GAND;;AAQAV,EAAAA,UAAU,CAACpD,SAAX,CAAqBgJ,WAArB,GAAmC,SAASA,WAAT,GAAuB;AACtD,WAAO7F,WAAW,CAAC8F,GAAZ,CAAgB,gBAAhB,CAAP;AACH,GAFD;;AAIA7F,EAAAA,UAAU,CAACpD,SAAX,CAAqBkJ,WAArB,GAAmC,SAASA,WAAT,CAAqB7D,cAArB,EAAqC;AACpElC,IAAAA,WAAW,CAACyB,GAAZ,CAAgB,gBAAhB,EAAkCS,cAAlC;AACA,SAAK8D,MAAL;AACH,GAHD;;AAKA/F,EAAAA,UAAU,CAACpD,SAAX,CAAqBsH,WAArB,GAAmC,SAASA,WAAT,GAAuB;AACtD,QAAI8B,MAAM,GAAG,IAAb;;AAEA,QAAIC,eAAe,GAAG,CAAC,OAAD,EAAU,gBAAV,EAA4B,gBAA5B,EAA8C,aAA9C,EAA6D,aAA7D,CAAtB;AACA,WAAO,KAAKC,UAAL,GAAkB3C,GAAlB,CAAsB,UAAUC,MAAV,EAAkB;AAC3CyC,MAAAA,eAAe,CAACrB,OAAhB,CAAwB,UAAUuB,YAAV,EAAwB;AAC5C,YAAI3C,MAAM,CAACC,SAAP,CAAiB5G,cAAjB,CAAgCsJ,YAAhC,CAAJ,EAAmD;AAC/C3C,UAAAA,MAAM,CAACC,SAAP,CAAiB0C,YAAjB,IAAiCH,MAAM,CAACG,YAAD,CAAN,CAAqBd,IAArB,CAA0BW,MAA1B,CAAjC;AACH;AACJ,OAJD;AAKA,aAAOxC,MAAP;AACH,KAPM,CAAP;AAQH,GAZD;;AAcAxD,EAAAA,UAAU,CAACpD,SAAX,CAAqBwJ,WAArB,GAAmC,SAASA,WAAT,CAAqBC,EAArB,EAAyB;AACxD,SAAKC,IAAL,CAAUC,MAAV,CAAiBC,KAAjB,CAAuBH,EAAvB;;AACA,QAAI,KAAKnG,KAAL,CAAWuG,QAAf,EAAyB;AACrB,WAAKC,WAAL,CAAiBF,KAAjB;AACH;;AACD,QAAI,KAAKtG,KAAL,CAAWyG,OAAf,EAAwB;AACpB,WAAKzG,KAAL,CAAWyG,OAAX,CAAmBN,EAAnB;AACH;AACJ,GARD;;AAUArG,EAAAA,UAAU,CAACpD,SAAX,CAAqBgK,MAArB,GAA8B,SAASA,MAAT,CAAgBP,EAAhB,EAAoB;AAC9C,QAAI,CAACA,EAAD,IAAO,CAACA,EAAE,CAACQ,WAAX,IAA0B,CAACR,EAAE,CAACQ,WAAH,CAAevK,MAA9C,EAAsD;AAClD;AACH;;AACD,QAAIwK,QAAQ,CAACC,aAAT,IAA0BD,QAAQ,CAACC,aAAT,CAAuBC,YAAvB,CAAoC,iBAApC,MAA2D,MAAzF,EAAiG;AAC7F;AACH;;AACD,WAAO,KAAKR,KAAL,CAAWH,EAAX,CAAP;AACH,GARD;;AAUArG,EAAAA,UAAU,CAACpD,SAAX,CAAqB4J,KAArB,GAA6B,SAASA,KAAT,CAAeH,EAAf,EAAmB;AAC5C,QAAIY,MAAM,GAAG,IAAb;;AAEA,QAAIC,KAAK,GAAGb,EAAE,IAAIA,EAAE,CAACQ,WAArB;;AACA,QAAIK,KAAK,IAAIA,KAAK,CAAC5K,MAAN,KAAiB,KAAK6K,cAAnC,EAAmD;AAC/C,UAAIzG,WAAW,GAAG,KAAKC,KAAL,CAAWD,WAA7B;AAEA,UAAII,SAAS,GAAGJ,WAAW,CAACK,YAAZ,EAAhB;;AACA,UAAI,CAACD,SAAS,CAACsG,WAAV,EAAL,EAA8B;AAC1B,YAAItG,SAAS,CAACuG,WAAV,EAAJ,EAA6B;AACzB,iBAAO,KAAK/B,QAAL,CAAc;AACjB5E,YAAAA,WAAW,EAAEtC,WAAW,CAACkJ,kBAAZ,CAA+B5G,WAA/B;AADI,WAAd,EAEJ,YAAY;AACXuG,YAAAA,MAAM,CAACb,WAAP,CAAmBC,EAAnB;AACH,WAJM,CAAP;AAKH;AACJ;AACJ;;AACD,SAAKD,WAAL,CAAiBC,EAAjB;AACH,GAnBD;;AAqBArG,EAAAA,UAAU,CAACpD,SAAX,CAAqBsJ,UAArB,GAAkC,SAASA,UAAT,GAAsB;AACpD,WAAO,KAAKvF,KAAL,CAAWgB,OAAX,CAAmB4F,KAAnB,EAAP;AACH,GAFD;;AAIAvH,EAAAA,UAAU,CAACpD,SAAX,CAAqB4K,eAArB,GAAuC,SAASA,eAAT,GAA2B;AAC9D,QAAIC,MAAM,GAAG,IAAb;;AAEA,QAAIC,aAAa,GAAG,CAAC,WAAD,EAAc,aAAd,EAA6B,cAA7B,EAA6C,SAA7C,EAAwD,QAAxD,EAAkE,OAAlE,EAA2E,kBAA3E,CAApB;AACA,QAAIC,YAAY,GAAG,EAAnB;AACAD,IAAAA,aAAa,CAAC9C,OAAd,CAAsB,UAAUsC,KAAV,EAAiB;AACnCS,MAAAA,YAAY,CAACT,KAAD,CAAZ,GAAsBO,MAAM,CAACG,qBAAP,CAA6BV,KAA7B,CAAtB;AACH,KAFD;AAGA,WAAOS,YAAP;AACH,GATD;;AAWA3H,EAAAA,UAAU,CAACpD,SAAX,CAAqBwG,cAArB,GAAsC,SAASA,cAAT,GAA0B;AAC5D,QAAIyE,SAAS,GAAGrL,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBqF,SAAzC,GAAqDrF,SAAS,CAAC,CAAD,CAA9D,GAAoE,KAApF;;AAEA,QAAIqL,SAAJ,EAAe;AACX,WAAKvB,IAAL,CAAUC,MAAV,CAAiBC,KAAjB;AACH;;AACD,WAAO,KAAK7F,KAAL,CAAWD,WAAlB;AACH,GAPD;;AASAV,EAAAA,UAAU,CAACpD,SAAX,CAAqB6E,cAArB,GAAsC,SAASA,cAAT,CAAwBf,WAAxB,EAAqC;AACvE,QAAIoH,MAAM,GAAG,IAAb;;AAEA,QAAI1B,WAAW,GAAG5J,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBqF,SAAzC,GAAqDrF,SAAS,CAAC,CAAD,CAA9D,GAAoE,KAAtF;AACA,QAAIuL,aAAa,GAAGvL,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBqF,SAAzC,GAAqDrF,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAAxF;AAEA,QAAIwL,cAAc,GAAGtH,WAArB;AACA,SAAKwF,UAAL,GAAkBtB,OAAlB,CAA0B,UAAUpB,MAAV,EAAkB;AACxC,UAAIA,MAAM,CAACyE,QAAX,EAAqB;AACjB,YAAInF,kBAAkB,GAAGU,MAAM,CAACyE,QAAP,CAAgBD,cAAhB,CAAzB;;AACA,YAAIlF,kBAAJ,EAAwB;AACpBkF,UAAAA,cAAc,GAAGlF,kBAAjB;AACH;AACJ;AACJ,KAPD;;AAQA,QAAI,KAAK5C,KAAL,CAAW+H,QAAX,IAAuBF,aAA3B,EAA0C;AACtC,WAAK7H,KAAL,CAAW+H,QAAX,CAAoBD,cAApB,EADsC,CAEtC;AACA;AACA;AACA;AACA;AACA;;AACA,UAAI,KAAK5F,cAAT,EAAyB;AACrB,aAAK9B,oBAAL,GAA4B4H,YAAY,CAAC,YAAY;AACjD,iBAAOJ,MAAM,CAACxC,QAAP,CAAgB;AACnB5E,YAAAA,WAAW,EAAE,IAAItC,WAAJ,CAAgB0J,MAAM,CAACnH,KAAP,CAAaD,WAAb,CAAyByH,YAAzB,EAAhB;AADM,WAAhB,CAAP;AAGH,SAJuC,CAAxC;AAKH;AACJ;;AACD,QAAI,CAAC,KAAK/F,cAAV,EAA0B;AACtB,WAAKkD,QAAL,CAAc;AAAE5E,QAAAA,WAAW,EAAEsH;AAAf,OAAd,EAA+C5B,WAAW,GAAG,YAAY;AACrE,eAAO8B,YAAY,CAAC,YAAY;AAC5B,iBAAOJ,MAAM,CAACxB,IAAP,CAAYC,MAAZ,CAAmBC,KAAnB,EAAP;AACH,SAFkB,CAAnB;AAGH,OAJyD,GAItDnH,IAJJ;AAKH;AACJ,GAtCD;;AAwCAW,EAAAA,UAAU,CAACpD,SAAX,CAAqBwL,gBAArB,GAAwC,SAASA,gBAAT,CAA0B/B,EAA1B,EAA8B;AAClE,QAAI,KAAKnG,KAAL,CAAWmI,SAAf,EAA0B;AACtBhC,MAAAA,EAAE,CAACiC,OAAH,GAAalJ,kBAAkB,CAACiH,EAAD,CAA/B;AACA,UAAIkC,aAAa,GAAG,KAAKrI,KAAL,CAAWmI,SAAX,CAAqBhC,EAArB,CAApB;;AACA,UAAIkC,aAAJ,EAAmB;AACf,eAAOA,aAAP;AACH;;AACD,aAAO/J,oBAAoB,CAAC6H,EAAD,CAA3B;AACH;;AACD,WAAO7H,oBAAoB,CAAC6H,EAAD,CAA3B;AACH,GAVD;;AAYArG,EAAAA,UAAU,CAACpD,SAAX,CAAqB4L,gBAArB,GAAwC,SAASA,gBAAT,CAA0BC,OAA1B,EAAmC;AACvE,QAAI,KAAKvI,KAAL,CAAWwI,UAAf,EAA2B;AACvB,aAAO,KAAKC,WAAL,CAAiB,kBAAjB,EAAqCF,OAArC,CAAP;AACH;;AACD,WAAOA,OAAO,KAAK,aAAZ,GAA4B,SAA5B,GAAwC,aAA/C;AACH,GALD;;AAOAzI,EAAAA,UAAU,CAACpD,SAAX,CAAqBgM,aAArB,GAAqC,SAASA,aAAT,CAAuBC,YAAvB,EAAqC;AACtE,QAAI3G,mBAAmB,GAAGnC,WAAW,CAAC8F,GAAZ,CAAgB,qBAAhB,CAA1B;AACA,QAAIiD,IAAI,GAAGD,YAAY,CAACE,OAAb,EAAX;;AACA,QAAI7G,mBAAmB,CAACrF,cAApB,CAAmCiM,IAAnC,CAAJ,EAA8C;AAC1C,aAAO5G,mBAAmB,CAAC4G,IAAD,CAA1B;AACH;;AACD,WAAO,EAAP;AACH,GAPD;;AASA9I,EAAAA,UAAU,CAACpD,SAAX,CAAqBoM,eAArB,GAAuC,SAASA,eAAT,CAAyBH,YAAzB,EAAuC;AAC1E,QAAII,iBAAiB,GAAG,IAAxB;AACA,SAAK/C,UAAL,GAAkBtB,OAAlB,CAA0B,UAAUpB,MAAV,EAAkB;AACxC,UAAIA,MAAM,CAACwF,eAAX,EAA4B;AACxB,YAAIE,MAAM,GAAG1F,MAAM,CAACwF,eAAP,CAAuBH,YAAvB,CAAb;;AACA,YAAIK,MAAJ,EAAY;AACRD,UAAAA,iBAAiB,GAAGC,MAApB;AACH;AACJ;AACJ,KAPD;AAQA,WAAOD,iBAAP;AACH,GAXD;;AAaAjJ,EAAAA,UAAU,CAACpD,SAAX,CAAqB+L,WAArB,GAAmC,SAASA,WAAT,CAAqBQ,SAArB,EAAgC;AAC/D,QAAIC,OAAJ;;AAEA,QAAIzH,OAAO,GAAG,KAAKuE,UAAL,EAAd;;AAEA,SAAK,IAAImD,IAAI,GAAG7M,SAAS,CAACC,MAArB,EAA6B6M,IAAI,GAAGC,KAAK,CAACF,IAAI,GAAG,CAAP,GAAWA,IAAI,GAAG,CAAlB,GAAsB,CAAvB,CAAzC,EAAoEG,KAAK,GAAG,CAAjF,EAAoFA,KAAK,GAAGH,IAA5F,EAAkGG,KAAK,EAAvG,EAA2G;AACvGF,MAAAA,IAAI,CAACE,KAAK,GAAG,CAAT,CAAJ,GAAkBhN,SAAS,CAACgN,KAAD,CAA3B;AACH;;AAED,SAAK,IAAIjN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoF,OAAO,CAAClF,MAA5B,EAAoCF,CAAC,EAArC,EAAyC;AACrC,UAAIiH,MAAM,GAAG7B,OAAO,CAACpF,CAAD,CAApB;;AACA,UAAIiH,MAAM,CAACC,SAAP,CAAiB0F,SAAjB,KAA+B,OAAO3F,MAAM,CAACC,SAAP,CAAiB0F,SAAjB,CAAP,KAAuC,UAA1E,EAAsF;AAClF,YAAIM,iBAAJ;;AAEA,YAAIP,MAAM,GAAG,CAACO,iBAAiB,GAAGjG,MAAM,CAACC,SAA5B,EAAuC0F,SAAvC,EAAkDO,KAAlD,CAAwDD,iBAAxD,EAA2EH,IAA3E,CAAb;;AACA,YAAIJ,MAAM,KAAK,IAAf,EAAqB;AACjB,iBAAO,SAAP;AACH;AACJ;AACJ;;AACD,WAAO,KAAKhJ,KAAL,CAAWrD,cAAX,CAA0BsM,SAA1B,KAAwC,CAACC,OAAO,GAAG,KAAKlJ,KAAhB,EAAuBiJ,SAAvB,EAAkCO,KAAlC,CAAwCN,OAAxC,EAAiDE,IAAjD,MAA2D,IAAnG,GAA0G,SAA1G,GAAsH,aAA7H;AACH,GArBD;;AAuBAtJ,EAAAA,UAAU,CAACpD,SAAX,CAAqBgL,qBAArB,GAA6C,SAASA,qBAAT,CAA+BuB,SAA/B,EAA0C;AACnF,QAAIQ,MAAM,GAAG,IAAb;;AAEA,WAAO,YAAY;AACf,WAAK,IAAIC,KAAK,GAAGpN,SAAS,CAACC,MAAtB,EAA8B6M,IAAI,GAAGC,KAAK,CAACK,KAAD,CAA1C,EAAmDC,KAAK,GAAG,CAAhE,EAAmEA,KAAK,GAAGD,KAA3E,EAAkFC,KAAK,EAAvF,EAA2F;AACvFP,QAAAA,IAAI,CAACO,KAAD,CAAJ,GAAcrN,SAAS,CAACqN,KAAD,CAAvB;AACH;;AAED,aAAOF,MAAM,CAAChB,WAAP,CAAmBe,KAAnB,CAAyBC,MAAzB,EAAiC,CAACR,SAAD,EAAYhF,MAAZ,CAAmBmF,IAAnB,CAAjC,CAAP;AACH,KAND;AAOH,GAVD;;AAYAtJ,EAAAA,UAAU,CAACpD,SAAX,CAAqBwI,aAArB,GAAqC,SAASA,aAAT,CAAuB0E,QAAvB,EAAiC;AAClE,QAAIA,QAAQ,CAACxG,IAAT,KAAkB,CAAtB,EAAyB;AACrB,aAAO,EAAP;AACH;;AACD,QAAI3B,OAAO,GAAG,KAAKuE,UAAL,EAAd;AACA,QAAI6D,WAAW,GAAG,EAAlB;;AACA,SAAK,IAAIxN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoF,OAAO,CAAClF,MAA5B,EAAoCF,CAAC,EAArC,EAAyC;AACrC,UAAIoF,OAAO,CAACpF,CAAD,CAAP,CAAW6I,aAAf,EAA8B;AAC1B,YAAI4E,MAAM,GAAGrI,OAAO,CAACpF,CAAD,CAAP,CAAW6I,aAAX,CAAyB0E,QAAzB,CAAb;;AACA,YAAIE,MAAJ,EAAY;AACR7N,UAAAA,QAAQ,CAAC4N,WAAD,EAAcC,MAAd,CAAR;AACH;AACJ;AACJ;;AACD,WAAOD,WAAP;AACH,GAfD;;AAiBA/J,EAAAA,UAAU,CAACpD,SAAX,CAAqBmJ,MAArB,GAA8B,SAASA,MAAT,GAAkB;AAC5C,QAAIkE,WAAJ;AAAA,QACIC,MAAM,GAAG,IADb;;AAGA,QAAIC,OAAO,GAAG,KAAKjK,KAAnB;AAAA,QACIkK,SAAS,GAAGD,OAAO,CAACC,SADxB;AAAA,QAEIC,QAAQ,GAAGF,OAAO,CAACE,QAFvB;AAAA,QAGIC,KAAK,GAAGH,OAAO,CAACG,KAHpB;AAAA,QAII7D,QAAQ,GAAG0D,OAAO,CAAC1D,QAJvB;AAAA,QAKIiC,UAAU,GAAGyB,OAAO,CAACzB,UALzB;AAMA,QAAI6B,MAAM,GAAG,KAAK5J,KAAlB;AAAA,QACID,WAAW,GAAG6J,MAAM,CAAC7J,WADzB;AAAA,QAEIgE,cAAc,GAAG6F,MAAM,CAAC7F,cAF5B;AAIA,QAAIzC,cAAc,GAAGlC,WAAW,CAAC8F,GAAZ,CAAgB,gBAAhB,CAArB;AACA,QAAId,cAAc,GAAGhF,WAAW,CAAC8F,GAAZ,CAAgB,gBAAhB,CAArB;AACA,QAAI8B,YAAY,GAAG,KAAKH,eAAL,EAAnB;AACA,QAAIgD,OAAO,GAAG1K,OAAO,CAAC6E,SAAtB;AACA,QAAI8F,GAAG,GAAG5L,UAAU,EAAEoL,WAAW,GAAG,EAAd,EAAkBA,WAAW,CAACG,SAAS,GAAG,SAAb,CAAX,GAAqC,IAAvD,EAA6DH,WAAW,CAACS,QAAZ,GAAuBjE,QAApF,EAA8FwD,WAAW,CAACU,OAAZ,GAAsB,CAACjC,UAArH,EAAiIuB,WAAnI,EAApB;AACA,WAAOhM,KAAK,CAAC2M,aAAN,CACH,KADG,EAEH;AAAEN,MAAAA,KAAK,EAAEA,KAAT;AAAgBO,MAAAA,SAAS,EAAEJ,GAA3B;AAAgCK,MAAAA,OAAO,EAAE,KAAKlE,MAAL,CAAYvB,IAAZ,CAAiB,IAAjB;AAAzC,KAFG,EAGHpH,KAAK,CAAC2M,aAAN,CAAoBJ,OAApB,EAA6B;AAAE9J,MAAAA,WAAW,EAAEA,WAAf;AAA4B0J,MAAAA,SAAS,EAAEA,SAAvC;AAAkDS,MAAAA,SAAS,EAAET,SAAS,GAAG,UAAzE;AAAqFzI,MAAAA,OAAO,EAAE+C,cAA9F;AAA8G2F,MAAAA,QAAQ,EAAEA;AAAxH,KAA7B,CAHG,EAIHpM,KAAK,CAAC2M,aAAN,CACI,KADJ,EAEI;AAAEC,MAAAA,SAAS,EAAET,SAAS,GAAG,iBAAzB;AAA4CW,MAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,GAAb,EAAkB;AAC3D,eAAOd,MAAM,CAAC/C,cAAP,GAAwB6D,GAA/B;AACH,OAFL;AAEOV,MAAAA,KAAK,EAAEA,KAFd;AAEqBQ,MAAAA,OAAO,EAAE,SAASA,OAAT,CAAiBzE,EAAjB,EAAqB;AAC3C,eAAOA,EAAE,CAAC4E,cAAH,EAAP;AACH;AAJL,KAFJ,EAOIhN,KAAK,CAAC2M,aAAN,CAAoBzM,MAApB,EAA4BhC,QAAQ,CAAC,EAAD,EAAK,KAAK+D,KAAV,EAAiByH,YAAjB,EAA+B;AAAEoD,MAAAA,GAAG,EAAE,QAAP;AAAiB9I,MAAAA,cAAc,EAAEA,cAAjC;AAAiDmD,MAAAA,aAAa,EAAE,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAAhE;AAA+F3E,MAAAA,WAAW,EAAEA,WAA5G;AAAyH8H,MAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBnD,IAAtB,CAA2B,IAA3B,CAA3I;AAA6K6F,MAAAA,YAAY,EAAE,KAAK9C,gBAAL,CAAsB/C,IAAtB,CAA2B,IAA3B,CAA3L;AAA6N4C,MAAAA,QAAQ,EAAE,KAAKxG,cAAL,CAAoB4D,IAApB,CAAyB,IAAzB,CAAvO;AAAuQ8F,MAAAA,YAAY,EAAE,KAAKvC,aAAL,CAAmBvD,IAAnB,CAAwB,IAAxB,CAArR;AAAoTN,MAAAA,cAAc,EAAEA,cAApU;AAAoVxE,MAAAA,gBAAgB,EAAE,KAAKA,gBAA3W;AAA6XyI,MAAAA,eAAe,EAAE,KAAKA,eAAL,CAAqB3D,IAArB,CAA0B,IAA1B;AAA9Y,KAA/B,CAApC,CAPJ,EAQIoB,QAAQ,GAAGxI,KAAK,CAAC2M,aAAN,CAAoB,OAApB,EAA6B;AAAEN,MAAAA,KAAK,EAAE/K,eAAT;AAA0BwL,MAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,GAAb,EAAkB;AACjF,eAAOd,MAAM,CAACxD,WAAP,GAAqBsE,GAA5B;AACH,OAFmC;AAEjCI,MAAAA,MAAM,EAAEzD,YAAY,CAACyD;AAFY,KAA7B,CAAH,GAEgC,IAV5C,EAWI,KAAKlL,KAAL,CAAWmL,QAXf,CAJG,CAAP;AAkBH,GArCD;;AAuCA,SAAOrL,UAAP;AACH,CA9cgB,CA8cf/B,KAAK,CAACqN,SA9cS,CAAjB;;AAgdAtL,UAAU,CAACuL,OAAX,GAAqBtM,UAArB;AACAe,UAAU,CAAChB,OAAX,GAAqBA,OAAO,CAACe,WAAD,CAA5B;AACAC,UAAU,CAACwL,YAAX,GAA0B;AACtB9C,EAAAA,UAAU,EAAE,IADU;AAEtB/G,EAAAA,OAAO,EAAE,EAFa;AAGtByI,EAAAA,SAAS,EAAE,gBAHW;AAItB1G,EAAAA,YAAY,EAAE,EAJQ;AAKtB2G,EAAAA,QAAQ,EAAE,EALY;AAMtBoB,EAAAA,UAAU,EAAE;AANU,CAA1B;AAQAzL,UAAU,CAAC0L,iBAAX,GAA+B;AAC3BtI,EAAAA,cAAc,EAAElF,SAAS,CAACyN,IADC;AAE3BlK,EAAAA,cAAc,EAAEvD,SAAS,CAACyN;AAFC,CAA/B;AAIA,eAAe3L,UAAf","sourcesContent":["var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* tslint:disable:member-ordering interface-name */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Editor, EditorState, ContentState, CompositeDecorator, Modifier, getDefaultKeyBinding, KeyBindingUtil, DefaultDraftBlockRenderMap } from 'draft-js';\nimport { List, Map } from 'immutable';\nimport 'setimmediate';\nimport classnames from 'classnames';\nimport { createToolbar } from '../Toolbar';\nimport ConfigStore from './ConfigStore';\nimport GetHTML from './export/getHTML';\nimport exportText, { decodeContent } from './export/exportText';\nimport customHTML2Content from './customHTML2Content';\nvar hasCommandModifier = KeyBindingUtil.hasCommandModifier;\n\nfunction noop() {}\n;\nvar defaultPluginConfig = {};\nvar focusDummyStyle = {\n    width: 0,\n    opacity: 0,\n    border: 0,\n    position: 'absolute',\n    left: 0,\n    top: 0\n};\nvar toolbar = createToolbar();\nvar configStore = new ConfigStore();\n\nvar EditorCore = function (_React$Component) {\n    _inherits(EditorCore, _React$Component);\n\n    function EditorCore(props) {\n        _classCallCheck(this, EditorCore);\n\n        var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n        _this.cancelForceUpdateImmediate = function () {\n            clearImmediate(_this.forceUpdateImmediate);\n            _this.forceUpdateImmediate = null;\n        };\n        _this.handlePastedText = function (text, html) {\n            var editorState = _this.state.editorState;\n\n            if (html) {\n                var contentState = editorState.getCurrentContent();\n                var selection = editorState.getSelection();\n                var fragment = customHTML2Content(html, contentState);\n                var pastedContent = Modifier.replaceWithFragment(contentState, selection, fragment);\n                var newContent = pastedContent.merge({\n                    selectionBefore: selection,\n                    selectionAfter: pastedContent.getSelectionAfter().set('hasFocus', true)\n                });\n                _this.setEditorState(EditorState.push(editorState, newContent, 'insert-fragment'), true);\n                return 'handled';\n            }\n            return 'not-handled';\n        };\n        _this.plugins = List(List(props.plugins).flatten(true));\n        var editorState = void 0;\n        if (props.value !== undefined) {\n            if (props.value instanceof EditorState) {\n                editorState = props.value || EditorState.createEmpty();\n            } else {\n                editorState = EditorState.createEmpty();\n            }\n        } else {\n            editorState = EditorState.createEmpty();\n        }\n        editorState = _this.generatorDefaultValue(editorState);\n        _this.state = {\n            plugins: _this.reloadPlugins(),\n            editorState: editorState,\n            customStyleMap: {},\n            customBlockStyleMap: {},\n            compositeDecorator: null\n        };\n        if (props.value !== undefined) {\n            _this.controlledMode = true;\n        }\n        return _this;\n    }\n\n    EditorCore.ToEditorState = function ToEditorState(text) {\n        var createEmptyContentState = ContentState.createFromText(decodeContent(text) || '');\n        var editorState = EditorState.createWithContent(createEmptyContentState);\n        return EditorState.forceSelection(editorState, createEmptyContentState.getSelectionAfter());\n    };\n\n    EditorCore.prototype.getDefaultValue = function getDefaultValue() {\n        var _props = this.props,\n            defaultValue = _props.defaultValue,\n            value = _props.value;\n\n        return value || defaultValue;\n    };\n\n    EditorCore.prototype.Reset = function Reset() {\n        var defaultValue = this.getDefaultValue();\n        var contentState = defaultValue ? defaultValue.getCurrentContent() : ContentState.createFromText('');\n        var updatedEditorState = EditorState.push(this.state.editorState, contentState, 'remove-range');\n        this.setEditorState(EditorState.forceSelection(updatedEditorState, contentState.getSelectionBefore()));\n    };\n\n    EditorCore.prototype.SetText = function SetText(text) {\n        var createTextContentState = ContentState.createFromText(text || '');\n        var editorState = EditorState.push(this.state.editorState, createTextContentState, 'change-block-data');\n        this.setEditorState(EditorState.moveFocusToEnd(editorState), true);\n    };\n\n    EditorCore.prototype.getChildContext = function getChildContext() {\n        return {\n            getEditorState: this.getEditorState,\n            setEditorState: this.setEditorState\n        };\n    };\n\n    EditorCore.prototype.reloadPlugins = function reloadPlugins() {\n        var _this2 = this;\n\n        return this.plugins && this.plugins.size ? this.plugins.map(function (plugin) {\n            // 如果插件有 callbacks 方法,则认为插件已经加载。\n            if (plugin.callbacks) {\n                return plugin;\n            }\n            // 如果插件有 constructor 方法,则构造插件\n            if (plugin.hasOwnProperty('constructor')) {\n                var pluginConfig = _extends(_this2.props.pluginConfig, plugin.config || {}, defaultPluginConfig);\n                return plugin.constructor(pluginConfig);\n            }\n            // else 无效插件\n            console.warn('>> 插件: [', plugin.name, '] 无效。插件或许已经过期。');\n            return false;\n        }).filter(function (plugin) {\n            return plugin;\n        }).toArray() : [];\n    };\n\n    EditorCore.prototype.componentWillMount = function componentWillMount() {\n        var plugins = this.initPlugins().concat([toolbar]);\n        var customStyleMap = {};\n        var customBlockStyleMap = {};\n        var customBlockRenderMap = Map(DefaultDraftBlockRenderMap);\n        var toHTMLList = List([]);\n        // initialize compositeDecorator\n        var compositeDecorator = new CompositeDecorator(plugins.filter(function (plugin) {\n            return plugin.decorators !== undefined;\n        }).map(function (plugin) {\n            return plugin.decorators;\n        }).reduce(function (prev, curr) {\n            return prev.concat(curr);\n        }, []));\n        // initialize Toolbar\n        var toolbarPlugins = List(plugins.filter(function (plugin) {\n            return !!plugin.component && plugin.name !== 'toolbar';\n        }));\n        // load inline styles...\n        plugins.forEach(function (plugin) {\n            var styleMap = plugin.styleMap,\n                blockStyleMap = plugin.blockStyleMap,\n                blockRenderMap = plugin.blockRenderMap,\n                toHtml = plugin.toHtml;\n\n            if (styleMap) {\n                for (var key in styleMap) {\n                    if (styleMap.hasOwnProperty(key)) {\n                        customStyleMap[key] = styleMap[key];\n                    }\n                }\n            }\n            if (blockStyleMap) {\n                for (var _key in blockStyleMap) {\n                    if (blockStyleMap.hasOwnProperty(_key)) {\n                        customBlockStyleMap[_key] = blockStyleMap[_key];\n                        customBlockRenderMap = customBlockRenderMap.set(_key, {\n                            element: null\n                        });\n                    }\n                }\n            }\n            if (toHtml) {\n                toHTMLList = toHTMLList.push(toHtml);\n            }\n            if (blockRenderMap) {\n                for (var _key2 in blockRenderMap) {\n                    if (blockRenderMap.hasOwnProperty(_key2)) {\n                        customBlockRenderMap = customBlockRenderMap.set(_key2, blockRenderMap[_key2]);\n                    }\n                }\n            }\n        });\n        configStore.set('customStyleMap', customStyleMap);\n        configStore.set('customBlockStyleMap', customBlockStyleMap);\n        configStore.set('blockRenderMap', customBlockRenderMap);\n        configStore.set('customStyleFn', this.customStyleFn.bind(this));\n        configStore.set('toHTMLList', toHTMLList);\n        this.setState({\n            toolbarPlugins: toolbarPlugins,\n            compositeDecorator: compositeDecorator\n        });\n        this.setEditorState(EditorState.set(this.state.editorState, { decorator: compositeDecorator }), false, false);\n    };\n\n    EditorCore.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n        if (this.forceUpdateImmediate) {\n            this.cancelForceUpdateImmediate();\n        }\n        if (this.controlledMode) {\n            var decorators = nextProps.value.getDecorator();\n            var editorState = decorators ? nextProps.value : EditorState.set(nextProps.value, { decorator: this.state.compositeDecorator });\n            this.setState({\n                editorState: editorState\n            });\n        }\n    };\n\n    EditorCore.prototype.componentWillUnmount = function componentWillUnmount() {\n        this.cancelForceUpdateImmediate();\n    };\n    // 处理 value\n\n\n    EditorCore.prototype.generatorDefaultValue = function generatorDefaultValue(editorState) {\n        var defaultValue = this.getDefaultValue();\n        if (defaultValue) {\n            return defaultValue;\n        }\n        return editorState;\n    };\n\n    EditorCore.prototype.getStyleMap = function getStyleMap() {\n        return configStore.get('customStyleMap');\n    };\n\n    EditorCore.prototype.setStyleMap = function setStyleMap(customStyleMap) {\n        configStore.set('customStyleMap', customStyleMap);\n        this.render();\n    };\n\n    EditorCore.prototype.initPlugins = function initPlugins() {\n        var _this3 = this;\n\n        var enableCallbacks = ['focus', 'getEditorState', 'setEditorState', 'getStyleMap', 'setStyleMap'];\n        return this.getPlugins().map(function (plugin) {\n            enableCallbacks.forEach(function (callbackName) {\n                if (plugin.callbacks.hasOwnProperty(callbackName)) {\n                    plugin.callbacks[callbackName] = _this3[callbackName].bind(_this3);\n                }\n            });\n            return plugin;\n        });\n    };\n\n    EditorCore.prototype.focusEditor = function focusEditor(ev) {\n        this.refs.editor.focus(ev);\n        if (this.props.readOnly) {\n            this._focusDummy.focus();\n        }\n        if (this.props.onFocus) {\n            this.props.onFocus(ev);\n        }\n    };\n\n    EditorCore.prototype._focus = function _focus(ev) {\n        if (!ev || !ev.nativeEvent || !ev.nativeEvent.target) {\n            return;\n        }\n        if (document.activeElement && document.activeElement.getAttribute('contenteditable') === 'true') {\n            return;\n        }\n        return this.focus(ev);\n    };\n\n    EditorCore.prototype.focus = function focus(ev) {\n        var _this4 = this;\n\n        var event = ev && ev.nativeEvent;\n        if (event && event.target === this._editorWrapper) {\n            var editorState = this.state.editorState;\n\n            var selection = editorState.getSelection();\n            if (!selection.getHasFocus()) {\n                if (selection.isCollapsed()) {\n                    return this.setState({\n                        editorState: EditorState.moveSelectionToEnd(editorState)\n                    }, function () {\n                        _this4.focusEditor(ev);\n                    });\n                }\n            }\n        }\n        this.focusEditor(ev);\n    };\n\n    EditorCore.prototype.getPlugins = function getPlugins() {\n        return this.state.plugins.slice();\n    };\n\n    EditorCore.prototype.getEventHandler = function getEventHandler() {\n        var _this5 = this;\n\n        var enabledEvents = ['onUpArrow', 'onDownArrow', 'handleReturn', 'onFocus', 'onBlur', 'onTab', 'handlePastedText'];\n        var eventHandler = {};\n        enabledEvents.forEach(function (event) {\n            eventHandler[event] = _this5.generatorEventHandler(event);\n        });\n        return eventHandler;\n    };\n\n    EditorCore.prototype.getEditorState = function getEditorState() {\n        var needFocus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n        if (needFocus) {\n            this.refs.editor.focus();\n        }\n        return this.state.editorState;\n    };\n\n    EditorCore.prototype.setEditorState = function setEditorState(editorState) {\n        var _this6 = this;\n\n        var focusEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var triggerChange = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var newEditorState = editorState;\n        this.getPlugins().forEach(function (plugin) {\n            if (plugin.onChange) {\n                var updatedEditorState = plugin.onChange(newEditorState);\n                if (updatedEditorState) {\n                    newEditorState = updatedEditorState;\n                }\n            }\n        });\n        if (this.props.onChange && triggerChange) {\n            this.props.onChange(newEditorState);\n            // close this issue https://github.com/ant-design/ant-design/issues/5788\n            // when onChange not take any effect\n            // `<Editor />` won't rerender cause no props is changed.\n            // add an timeout here,\n            // if props.onChange not trigger componentWillReceiveProps,\n            // we will force render Editor with previous editorState,\n            if (this.controlledMode) {\n                this.forceUpdateImmediate = setImmediate(function () {\n                    return _this6.setState({\n                        editorState: new EditorState(_this6.state.editorState.getImmutable())\n                    });\n                });\n            }\n        }\n        if (!this.controlledMode) {\n            this.setState({ editorState: newEditorState }, focusEditor ? function () {\n                return setImmediate(function () {\n                    return _this6.refs.editor.focus();\n                });\n            } : noop);\n        }\n    };\n\n    EditorCore.prototype.handleKeyBinding = function handleKeyBinding(ev) {\n        if (this.props.onKeyDown) {\n            ev.ctrlKey = hasCommandModifier(ev);\n            var keyDownResult = this.props.onKeyDown(ev);\n            if (keyDownResult) {\n                return keyDownResult;\n            }\n            return getDefaultKeyBinding(ev);\n        }\n        return getDefaultKeyBinding(ev);\n    };\n\n    EditorCore.prototype.handleKeyCommand = function handleKeyCommand(command) {\n        if (this.props.multiLines) {\n            return this.eventHandle('handleKeyBinding', command);\n        }\n        return command === 'split-block' ? 'handled' : 'not-handled';\n    };\n\n    EditorCore.prototype.getBlockStyle = function getBlockStyle(contentBlock) {\n        var customBlockStyleMap = configStore.get('customBlockStyleMap');\n        var type = contentBlock.getType();\n        if (customBlockStyleMap.hasOwnProperty(type)) {\n            return customBlockStyleMap[type];\n        }\n        return '';\n    };\n\n    EditorCore.prototype.blockRendererFn = function blockRendererFn(contentBlock) {\n        var blockRenderResult = null;\n        this.getPlugins().forEach(function (plugin) {\n            if (plugin.blockRendererFn) {\n                var result = plugin.blockRendererFn(contentBlock);\n                if (result) {\n                    blockRenderResult = result;\n                }\n            }\n        });\n        return blockRenderResult;\n    };\n\n    EditorCore.prototype.eventHandle = function eventHandle(eventName) {\n        var _props2;\n\n        var plugins = this.getPlugins();\n\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key3 = 1; _key3 < _len; _key3++) {\n            args[_key3 - 1] = arguments[_key3];\n        }\n\n        for (var i = 0; i < plugins.length; i++) {\n            var plugin = plugins[i];\n            if (plugin.callbacks[eventName] && typeof plugin.callbacks[eventName] === 'function') {\n                var _plugin$callbacks;\n\n                var result = (_plugin$callbacks = plugin.callbacks)[eventName].apply(_plugin$callbacks, args);\n                if (result === true) {\n                    return 'handled';\n                }\n            }\n        }\n        return this.props.hasOwnProperty(eventName) && (_props2 = this.props)[eventName].apply(_props2, args) === true ? 'handled' : 'not-handled';\n    };\n\n    EditorCore.prototype.generatorEventHandler = function generatorEventHandler(eventName) {\n        var _this7 = this;\n\n        return function () {\n            for (var _len2 = arguments.length, args = Array(_len2), _key4 = 0; _key4 < _len2; _key4++) {\n                args[_key4] = arguments[_key4];\n            }\n\n            return _this7.eventHandle.apply(_this7, [eventName].concat(args));\n        };\n    };\n\n    EditorCore.prototype.customStyleFn = function customStyleFn(styleSet) {\n        if (styleSet.size === 0) {\n            return {};\n        }\n        var plugins = this.getPlugins();\n        var resultStyle = {};\n        for (var i = 0; i < plugins.length; i++) {\n            if (plugins[i].customStyleFn) {\n                var styled = plugins[i].customStyleFn(styleSet);\n                if (styled) {\n                    _extends(resultStyle, styled);\n                }\n            }\n        }\n        return resultStyle;\n    };\n\n    EditorCore.prototype.render = function render() {\n        var _classnames,\n            _this8 = this;\n\n        var _props3 = this.props,\n            prefixCls = _props3.prefixCls,\n            toolbars = _props3.toolbars,\n            style = _props3.style,\n            readOnly = _props3.readOnly,\n            multiLines = _props3.multiLines;\n        var _state = this.state,\n            editorState = _state.editorState,\n            toolbarPlugins = _state.toolbarPlugins;\n\n        var customStyleMap = configStore.get('customStyleMap');\n        var blockRenderMap = configStore.get('blockRenderMap');\n        var eventHandler = this.getEventHandler();\n        var Toolbar = toolbar.component;\n        var cls = classnames((_classnames = {}, _classnames[prefixCls + '-editor'] = true, _classnames.readonly = readOnly, _classnames.oneline = !multiLines, _classnames));\n        return React.createElement(\n            'div',\n            { style: style, className: cls, onClick: this._focus.bind(this) },\n            React.createElement(Toolbar, { editorState: editorState, prefixCls: prefixCls, className: prefixCls + '-toolbar', plugins: toolbarPlugins, toolbars: toolbars }),\n            React.createElement(\n                'div',\n                { className: prefixCls + '-editor-wrapper', ref: function ref(ele) {\n                        return _this8._editorWrapper = ele;\n                    }, style: style, onClick: function onClick(ev) {\n                        return ev.preventDefault();\n                    } },\n                React.createElement(Editor, _extends({}, this.props, eventHandler, { ref: 'editor', customStyleMap: customStyleMap, customStyleFn: this.customStyleFn.bind(this), editorState: editorState, handleKeyCommand: this.handleKeyCommand.bind(this), keyBindingFn: this.handleKeyBinding.bind(this), onChange: this.setEditorState.bind(this), blockStyleFn: this.getBlockStyle.bind(this), blockRenderMap: blockRenderMap, handlePastedText: this.handlePastedText, blockRendererFn: this.blockRendererFn.bind(this) })),\n                readOnly ? React.createElement('input', { style: focusDummyStyle, ref: function ref(ele) {\n                        return _this8._focusDummy = ele;\n                    }, onBlur: eventHandler.onBlur }) : null,\n                this.props.children\n            )\n        );\n    };\n\n    return EditorCore;\n}(React.Component);\n\nEditorCore.GetText = exportText;\nEditorCore.GetHTML = GetHTML(configStore);\nEditorCore.defaultProps = {\n    multiLines: true,\n    plugins: [],\n    prefixCls: 'rc-editor-core',\n    pluginConfig: {},\n    toolbars: [],\n    spilitLine: 'enter'\n};\nEditorCore.childContextTypes = {\n    getEditorState: PropTypes.func,\n    setEditorState: PropTypes.func\n};\nexport default EditorCore;"]},"metadata":{},"sourceType":"module"}
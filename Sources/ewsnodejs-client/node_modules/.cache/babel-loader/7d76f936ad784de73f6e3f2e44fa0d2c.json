{"ast":null,"code":"function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nimport classNames from 'classnames';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport KeywordTrigger from './KeywordTrigger';\nimport { MentionsContextProvider } from './MentionsContext';\nimport Option from './Option';\nimport { filterOption as defaultFilterOption, getBeforeSelectionText, getLastMeasureIndex, omit, replaceWithMeasure, setInputSelection, validateSearch as defaultValidateSearch } from './util';\n\nvar Mentions = /*#__PURE__*/function (_React$Component) {\n  _inherits(Mentions, _React$Component);\n\n  function Mentions(props) {\n    var _this;\n\n    _classCallCheck(this, Mentions);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Mentions).call(this, props));\n    _this.focusId = undefined;\n\n    _this.triggerChange = function (value) {\n      var onChange = _this.props.onChange;\n\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n    };\n\n    _this.onChange = function (_ref) {\n      var value = _ref.target.value;\n\n      _this.triggerChange(value);\n    }; // Check if hit the measure keyword\n\n\n    _this.onKeyDown = function (event) {\n      var which = event.which;\n      var _this$state = _this.state,\n          activeIndex = _this$state.activeIndex,\n          measuring = _this$state.measuring; // Skip if not measuring\n\n      if (!measuring) {\n        return;\n      }\n\n      if (which === KeyCode.UP || which === KeyCode.DOWN) {\n        // Control arrow function\n        var optionLen = _this.getOptions().length;\n\n        var offset = which === KeyCode.UP ? -1 : 1;\n        var newActiveIndex = (activeIndex + offset + optionLen) % optionLen;\n\n        _this.setState({\n          activeIndex: newActiveIndex\n        });\n\n        event.preventDefault();\n      } else if (which === KeyCode.ESC) {\n        _this.stopMeasure();\n      } else if (which === KeyCode.ENTER) {\n        // Measure hit\n        var option = _this.getOptions()[activeIndex];\n\n        _this.selectOption(option);\n\n        event.preventDefault();\n      }\n    };\n    /**\n     * When to start measure:\n     * 1. When user press `prefix`\n     * 2. When measureText !== prevMeasureText\n     *  - If measure hit\n     *  - If measuring\n     *\n     * When to stop measure:\n     * 1. Selection is out of range\n     * 2. Contains `space`\n     * 3. ESC or select one\n     */\n\n\n    _this.onKeyUp = function (event) {\n      var key = event.key,\n          which = event.which;\n      var _this$state2 = _this.state,\n          prevMeasureText = _this$state2.measureText,\n          measuring = _this$state2.measuring;\n      var _this$props = _this.props,\n          _this$props$prefix = _this$props.prefix,\n          prefix = _this$props$prefix === void 0 ? '' : _this$props$prefix,\n          onSearch = _this$props.onSearch,\n          validateSearch = _this$props.validateSearch;\n      var target = event.target;\n      var selectionStartText = getBeforeSelectionText(target);\n\n      var _getLastMeasureIndex = getLastMeasureIndex(selectionStartText, prefix),\n          measureIndex = _getLastMeasureIndex.location,\n          measurePrefix = _getLastMeasureIndex.prefix; // Skip if match the white key list\n\n\n      if ([KeyCode.ESC, KeyCode.UP, KeyCode.DOWN, KeyCode.ENTER].indexOf(which) !== -1) {\n        return;\n      }\n\n      if (measureIndex !== -1) {\n        var measureText = selectionStartText.slice(measureIndex + measurePrefix.length);\n        var validateMeasure = validateSearch(measureText, _this.props);\n        var matchOption = !!_this.getOptions(measureText).length;\n\n        if (validateMeasure) {\n          if (key === measurePrefix || measuring || measureText !== prevMeasureText && matchOption) {\n            _this.startMeasure(measureText, measurePrefix, measureIndex);\n          }\n        } else if (measuring) {\n          // Stop if measureText is invalidate\n          _this.stopMeasure();\n        }\n        /**\n         * We will trigger `onSearch` to developer since they may use for async update.\n         * If met `space` means user finished searching.\n         */\n\n\n        if (onSearch && validateMeasure) {\n          onSearch(measureText, measurePrefix);\n        }\n      } else if (measuring) {\n        _this.stopMeasure();\n      }\n    };\n\n    _this.onInputFocus = function (event) {\n      _this.onFocus(event);\n    };\n\n    _this.onInputBlur = function (event) {\n      _this.onBlur(event);\n    };\n\n    _this.onDropdownFocus = function () {\n      _this.onFocus();\n    };\n\n    _this.onDropdownBlur = function () {\n      _this.onBlur();\n    };\n\n    _this.onFocus = function (event) {\n      window.clearTimeout(_this.focusId);\n      var isFocus = _this.state.isFocus;\n      var onFocus = _this.props.onFocus;\n\n      if (!isFocus && event && onFocus) {\n        onFocus(event);\n      }\n\n      _this.setState({\n        isFocus: true\n      });\n    };\n\n    _this.onBlur = function (event) {\n      _this.focusId = window.setTimeout(function () {\n        var onBlur = _this.props.onBlur;\n\n        _this.setState({\n          isFocus: false\n        });\n\n        _this.stopMeasure();\n\n        if (onBlur) {\n          onBlur(event);\n        }\n      }, 0);\n    };\n\n    _this.selectOption = function (option) {\n      var _this$state3 = _this.state,\n          value = _this$state3.value,\n          measureLocation = _this$state3.measureLocation,\n          measurePrefix = _this$state3.measurePrefix;\n      var _this$props2 = _this.props,\n          split = _this$props2.split,\n          onSelect = _this$props2.onSelect;\n      var _option$value = option.value,\n          mentionValue = _option$value === void 0 ? '' : _option$value;\n\n      var _replaceWithMeasure = replaceWithMeasure(value, {\n        measureLocation: measureLocation,\n        targetText: mentionValue,\n        prefix: measurePrefix,\n        selectionStart: _this.textarea.selectionStart,\n        split: split\n      }),\n          text = _replaceWithMeasure.text,\n          selectionLocation = _replaceWithMeasure.selectionLocation;\n\n      _this.triggerChange(text);\n\n      _this.stopMeasure(function () {\n        // We need restore the selection position\n        setInputSelection(_this.textarea, selectionLocation);\n      });\n\n      if (onSelect) {\n        onSelect(option, measurePrefix);\n      }\n    };\n\n    _this.setActiveIndex = function (activeIndex) {\n      _this.setState({\n        activeIndex: activeIndex\n      });\n    };\n\n    _this.setTextAreaRef = function (element) {\n      _this.textarea = element;\n    };\n\n    _this.setMeasureRef = function (element) {\n      _this.measure = element;\n    };\n\n    _this.getOptions = function (measureText) {\n      var targetMeasureText = measureText || _this.state.measureText || '';\n      var _this$props3 = _this.props,\n          children = _this$props3.children,\n          filterOption = _this$props3.filterOption;\n      var list = toArray(children).map(function (_ref2) {\n        var props = _ref2.props;\n        return props;\n      }).filter(function (option) {\n        /** Return all result if `filterOption` is false. */\n        if (filterOption === false) {\n          return true;\n        }\n\n        return filterOption(targetMeasureText, option);\n      });\n      return list;\n    };\n\n    _this.state = {\n      value: props.defaultValue || props.value || '',\n      measuring: false,\n      measureLocation: 0,\n      measureText: null,\n      measurePrefix: '',\n      activeIndex: 0,\n      isFocus: false\n    };\n    return _this;\n  }\n\n  _createClass(Mentions, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var measuring = this.state.measuring; // Sync measure div top with textarea for rc-trigger usage\n\n      if (measuring) {\n        this.measure.scrollTop = this.textarea.scrollTop;\n      }\n    }\n  }, {\n    key: \"startMeasure\",\n    value: function startMeasure(measureText, measurePrefix, measureLocation) {\n      this.setState({\n        measuring: true,\n        measureText: measureText,\n        measurePrefix: measurePrefix,\n        measureLocation: measureLocation,\n        activeIndex: 0\n      });\n    }\n  }, {\n    key: \"stopMeasure\",\n    value: function stopMeasure(callback) {\n      this.setState({\n        measuring: false,\n        measureLocation: 0,\n        measureText: null\n      }, callback);\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      this.textarea.focus();\n    }\n  }, {\n    key: \"blur\",\n    value: function blur() {\n      this.textarea.blur();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state4 = this.state,\n          value = _this$state4.value,\n          measureLocation = _this$state4.measureLocation,\n          measurePrefix = _this$state4.measurePrefix,\n          measuring = _this$state4.measuring,\n          activeIndex = _this$state4.activeIndex;\n\n      var _this$props4 = this.props,\n          prefixCls = _this$props4.prefixCls,\n          placement = _this$props4.placement,\n          transitionName = _this$props4.transitionName,\n          className = _this$props4.className,\n          style = _this$props4.style,\n          autoFocus = _this$props4.autoFocus,\n          notFoundContent = _this$props4.notFoundContent,\n          getPopupContainer = _this$props4.getPopupContainer,\n          restProps = _objectWithoutProperties(_this$props4, [\"prefixCls\", \"placement\", \"transitionName\", \"className\", \"style\", \"autoFocus\", \"notFoundContent\", \"getPopupContainer\"]);\n\n      var inputProps = omit(restProps, 'value', 'defaultValue', 'prefix', 'split', 'children', 'validateSearch', 'filterOption', 'onSelect', 'onSearch');\n      var options = measuring ? this.getOptions() : [];\n      return React.createElement(\"div\", {\n        className: classNames(prefixCls, className),\n        style: style\n      }, React.createElement(\"textarea\", Object.assign({\n        autoFocus: autoFocus,\n        ref: this.setTextAreaRef,\n        value: value\n      }, inputProps, {\n        onChange: this.onChange,\n        onKeyDown: this.onKeyDown,\n        onKeyUp: this.onKeyUp,\n        onFocus: this.onInputFocus,\n        onBlur: this.onInputBlur\n      })), measuring && React.createElement(\"div\", {\n        ref: this.setMeasureRef,\n        className: \"\".concat(prefixCls, \"-measure\")\n      }, value.slice(0, measureLocation), React.createElement(MentionsContextProvider, {\n        value: {\n          notFoundContent: notFoundContent,\n          activeIndex: activeIndex,\n          setActiveIndex: this.setActiveIndex,\n          selectOption: this.selectOption,\n          onFocus: this.onDropdownFocus,\n          onBlur: this.onDropdownBlur\n        }\n      }, React.createElement(KeywordTrigger, {\n        prefixCls: prefixCls,\n        transitionName: transitionName,\n        placement: placement,\n        options: options,\n        visible: true,\n        getPopupContainer: getPopupContainer\n      }, React.createElement(\"span\", null, measurePrefix))), value.slice(measureLocation + measurePrefix.length)));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, prevState) {\n      var newState = {};\n\n      if ('value' in props && props.value !== prevState.value) {\n        newState.value = props.value || '';\n      }\n\n      return newState;\n    }\n  }]);\n\n  return Mentions;\n}(React.Component);\n\nMentions.Option = Option;\nMentions.defaultProps = {\n  prefixCls: 'rc-mentions',\n  prefix: '@',\n  split: ' ',\n  validateSearch: defaultValidateSearch,\n  filterOption: defaultFilterOption,\n  notFoundContent: 'Not Found',\n  rows: 1\n};\npolyfill(Mentions);\nexport default Mentions;","map":{"version":3,"sources":["/opt/osp/ewsnodejs-client/node_modules/rc-mentions/es/Mentions.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","Object","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","call","sourceKeys","keys","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","value","_setPrototypeOf","p","classNames","toArray","KeyCode","React","polyfill","KeywordTrigger","MentionsContextProvider","Option","filterOption","defaultFilterOption","getBeforeSelectionText","getLastMeasureIndex","omit","replaceWithMeasure","setInputSelection","validateSearch","defaultValidateSearch","Mentions","_React$Component","_this","focusId","undefined","triggerChange","onChange","setState","_ref","onKeyDown","event","which","_this$state","state","activeIndex","measuring","UP","DOWN","optionLen","getOptions","offset","newActiveIndex","preventDefault","ESC","stopMeasure","ENTER","option","selectOption","onKeyUp","_this$state2","prevMeasureText","measureText","_this$props","_this$props$prefix","prefix","onSearch","selectionStartText","_getLastMeasureIndex","measureIndex","location","measurePrefix","slice","validateMeasure","matchOption","startMeasure","onInputFocus","onFocus","onInputBlur","onBlur","onDropdownFocus","onDropdownBlur","window","clearTimeout","isFocus","setTimeout","_this$state3","measureLocation","_this$props2","split","onSelect","_option$value","mentionValue","_replaceWithMeasure","targetText","selectionStart","textarea","text","selectionLocation","setActiveIndex","setTextAreaRef","element","setMeasureRef","measure","targetMeasureText","_this$props3","children","list","map","_ref2","filter","defaultValue","componentDidUpdate","scrollTop","callback","focus","blur","render","_this$state4","_this$props4","prefixCls","placement","transitionName","className","style","autoFocus","notFoundContent","getPopupContainer","restProps","inputProps","options","createElement","assign","ref","concat","visible","getDerivedStateFromProps","prevState","newState","Component","defaultProps","rows"],"mappings":"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","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport classNames from 'classnames';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport KeywordTrigger from './KeywordTrigger';\nimport { MentionsContextProvider } from './MentionsContext';\nimport Option from './Option';\nimport { filterOption as defaultFilterOption, getBeforeSelectionText, getLastMeasureIndex, omit, replaceWithMeasure, setInputSelection, validateSearch as defaultValidateSearch } from './util';\n\nvar Mentions =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Mentions, _React$Component);\n\n  function Mentions(props) {\n    var _this;\n\n    _classCallCheck(this, Mentions);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Mentions).call(this, props));\n    _this.focusId = undefined;\n\n    _this.triggerChange = function (value) {\n      var onChange = _this.props.onChange;\n\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n    };\n\n    _this.onChange = function (_ref) {\n      var value = _ref.target.value;\n\n      _this.triggerChange(value);\n    }; // Check if hit the measure keyword\n\n\n    _this.onKeyDown = function (event) {\n      var which = event.which;\n      var _this$state = _this.state,\n          activeIndex = _this$state.activeIndex,\n          measuring = _this$state.measuring; // Skip if not measuring\n\n      if (!measuring) {\n        return;\n      }\n\n      if (which === KeyCode.UP || which === KeyCode.DOWN) {\n        // Control arrow function\n        var optionLen = _this.getOptions().length;\n\n        var offset = which === KeyCode.UP ? -1 : 1;\n        var newActiveIndex = (activeIndex + offset + optionLen) % optionLen;\n\n        _this.setState({\n          activeIndex: newActiveIndex\n        });\n\n        event.preventDefault();\n      } else if (which === KeyCode.ESC) {\n        _this.stopMeasure();\n      } else if (which === KeyCode.ENTER) {\n        // Measure hit\n        var option = _this.getOptions()[activeIndex];\n\n        _this.selectOption(option);\n\n        event.preventDefault();\n      }\n    };\n    /**\n     * When to start measure:\n     * 1. When user press `prefix`\n     * 2. When measureText !== prevMeasureText\n     *  - If measure hit\n     *  - If measuring\n     *\n     * When to stop measure:\n     * 1. Selection is out of range\n     * 2. Contains `space`\n     * 3. ESC or select one\n     */\n\n\n    _this.onKeyUp = function (event) {\n      var key = event.key,\n          which = event.which;\n      var _this$state2 = _this.state,\n          prevMeasureText = _this$state2.measureText,\n          measuring = _this$state2.measuring;\n      var _this$props = _this.props,\n          _this$props$prefix = _this$props.prefix,\n          prefix = _this$props$prefix === void 0 ? '' : _this$props$prefix,\n          onSearch = _this$props.onSearch,\n          validateSearch = _this$props.validateSearch;\n      var target = event.target;\n      var selectionStartText = getBeforeSelectionText(target);\n\n      var _getLastMeasureIndex = getLastMeasureIndex(selectionStartText, prefix),\n          measureIndex = _getLastMeasureIndex.location,\n          measurePrefix = _getLastMeasureIndex.prefix; // Skip if match the white key list\n\n\n      if ([KeyCode.ESC, KeyCode.UP, KeyCode.DOWN, KeyCode.ENTER].indexOf(which) !== -1) {\n        return;\n      }\n\n      if (measureIndex !== -1) {\n        var measureText = selectionStartText.slice(measureIndex + measurePrefix.length);\n        var validateMeasure = validateSearch(measureText, _this.props);\n        var matchOption = !!_this.getOptions(measureText).length;\n\n        if (validateMeasure) {\n          if (key === measurePrefix || measuring || measureText !== prevMeasureText && matchOption) {\n            _this.startMeasure(measureText, measurePrefix, measureIndex);\n          }\n        } else if (measuring) {\n          // Stop if measureText is invalidate\n          _this.stopMeasure();\n        }\n        /**\n         * We will trigger `onSearch` to developer since they may use for async update.\n         * If met `space` means user finished searching.\n         */\n\n\n        if (onSearch && validateMeasure) {\n          onSearch(measureText, measurePrefix);\n        }\n      } else if (measuring) {\n        _this.stopMeasure();\n      }\n    };\n\n    _this.onInputFocus = function (event) {\n      _this.onFocus(event);\n    };\n\n    _this.onInputBlur = function (event) {\n      _this.onBlur(event);\n    };\n\n    _this.onDropdownFocus = function () {\n      _this.onFocus();\n    };\n\n    _this.onDropdownBlur = function () {\n      _this.onBlur();\n    };\n\n    _this.onFocus = function (event) {\n      window.clearTimeout(_this.focusId);\n      var isFocus = _this.state.isFocus;\n      var onFocus = _this.props.onFocus;\n\n      if (!isFocus && event && onFocus) {\n        onFocus(event);\n      }\n\n      _this.setState({\n        isFocus: true\n      });\n    };\n\n    _this.onBlur = function (event) {\n      _this.focusId = window.setTimeout(function () {\n        var onBlur = _this.props.onBlur;\n\n        _this.setState({\n          isFocus: false\n        });\n\n        _this.stopMeasure();\n\n        if (onBlur) {\n          onBlur(event);\n        }\n      }, 0);\n    };\n\n    _this.selectOption = function (option) {\n      var _this$state3 = _this.state,\n          value = _this$state3.value,\n          measureLocation = _this$state3.measureLocation,\n          measurePrefix = _this$state3.measurePrefix;\n      var _this$props2 = _this.props,\n          split = _this$props2.split,\n          onSelect = _this$props2.onSelect;\n      var _option$value = option.value,\n          mentionValue = _option$value === void 0 ? '' : _option$value;\n\n      var _replaceWithMeasure = replaceWithMeasure(value, {\n        measureLocation: measureLocation,\n        targetText: mentionValue,\n        prefix: measurePrefix,\n        selectionStart: _this.textarea.selectionStart,\n        split: split\n      }),\n          text = _replaceWithMeasure.text,\n          selectionLocation = _replaceWithMeasure.selectionLocation;\n\n      _this.triggerChange(text);\n\n      _this.stopMeasure(function () {\n        // We need restore the selection position\n        setInputSelection(_this.textarea, selectionLocation);\n      });\n\n      if (onSelect) {\n        onSelect(option, measurePrefix);\n      }\n    };\n\n    _this.setActiveIndex = function (activeIndex) {\n      _this.setState({\n        activeIndex: activeIndex\n      });\n    };\n\n    _this.setTextAreaRef = function (element) {\n      _this.textarea = element;\n    };\n\n    _this.setMeasureRef = function (element) {\n      _this.measure = element;\n    };\n\n    _this.getOptions = function (measureText) {\n      var targetMeasureText = measureText || _this.state.measureText || '';\n      var _this$props3 = _this.props,\n          children = _this$props3.children,\n          filterOption = _this$props3.filterOption;\n      var list = toArray(children).map(function (_ref2) {\n        var props = _ref2.props;\n        return props;\n      }).filter(function (option) {\n        /** Return all result if `filterOption` is false. */\n        if (filterOption === false) {\n          return true;\n        }\n\n        return filterOption(targetMeasureText, option);\n      });\n      return list;\n    };\n\n    _this.state = {\n      value: props.defaultValue || props.value || '',\n      measuring: false,\n      measureLocation: 0,\n      measureText: null,\n      measurePrefix: '',\n      activeIndex: 0,\n      isFocus: false\n    };\n    return _this;\n  }\n\n  _createClass(Mentions, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var measuring = this.state.measuring; // Sync measure div top with textarea for rc-trigger usage\n\n      if (measuring) {\n        this.measure.scrollTop = this.textarea.scrollTop;\n      }\n    }\n  }, {\n    key: \"startMeasure\",\n    value: function startMeasure(measureText, measurePrefix, measureLocation) {\n      this.setState({\n        measuring: true,\n        measureText: measureText,\n        measurePrefix: measurePrefix,\n        measureLocation: measureLocation,\n        activeIndex: 0\n      });\n    }\n  }, {\n    key: \"stopMeasure\",\n    value: function stopMeasure(callback) {\n      this.setState({\n        measuring: false,\n        measureLocation: 0,\n        measureText: null\n      }, callback);\n    }\n  }, {\n    key: \"focus\",\n    value: function focus() {\n      this.textarea.focus();\n    }\n  }, {\n    key: \"blur\",\n    value: function blur() {\n      this.textarea.blur();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state4 = this.state,\n          value = _this$state4.value,\n          measureLocation = _this$state4.measureLocation,\n          measurePrefix = _this$state4.measurePrefix,\n          measuring = _this$state4.measuring,\n          activeIndex = _this$state4.activeIndex;\n\n      var _this$props4 = this.props,\n          prefixCls = _this$props4.prefixCls,\n          placement = _this$props4.placement,\n          transitionName = _this$props4.transitionName,\n          className = _this$props4.className,\n          style = _this$props4.style,\n          autoFocus = _this$props4.autoFocus,\n          notFoundContent = _this$props4.notFoundContent,\n          getPopupContainer = _this$props4.getPopupContainer,\n          restProps = _objectWithoutProperties(_this$props4, [\"prefixCls\", \"placement\", \"transitionName\", \"className\", \"style\", \"autoFocus\", \"notFoundContent\", \"getPopupContainer\"]);\n\n      var inputProps = omit(restProps, 'value', 'defaultValue', 'prefix', 'split', 'children', 'validateSearch', 'filterOption', 'onSelect', 'onSearch');\n      var options = measuring ? this.getOptions() : [];\n      return React.createElement(\"div\", {\n        className: classNames(prefixCls, className),\n        style: style\n      }, React.createElement(\"textarea\", Object.assign({\n        autoFocus: autoFocus,\n        ref: this.setTextAreaRef,\n        value: value\n      }, inputProps, {\n        onChange: this.onChange,\n        onKeyDown: this.onKeyDown,\n        onKeyUp: this.onKeyUp,\n        onFocus: this.onInputFocus,\n        onBlur: this.onInputBlur\n      })), measuring && React.createElement(\"div\", {\n        ref: this.setMeasureRef,\n        className: \"\".concat(prefixCls, \"-measure\")\n      }, value.slice(0, measureLocation), React.createElement(MentionsContextProvider, {\n        value: {\n          notFoundContent: notFoundContent,\n          activeIndex: activeIndex,\n          setActiveIndex: this.setActiveIndex,\n          selectOption: this.selectOption,\n          onFocus: this.onDropdownFocus,\n          onBlur: this.onDropdownBlur\n        }\n      }, React.createElement(KeywordTrigger, {\n        prefixCls: prefixCls,\n        transitionName: transitionName,\n        placement: placement,\n        options: options,\n        visible: true,\n        getPopupContainer: getPopupContainer\n      }, React.createElement(\"span\", null, measurePrefix))), value.slice(measureLocation + measurePrefix.length)));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, prevState) {\n      var newState = {};\n\n      if ('value' in props && props.value !== prevState.value) {\n        newState.value = props.value || '';\n      }\n\n      return newState;\n    }\n  }]);\n\n  return Mentions;\n}(React.Component);\n\nMentions.Option = Option;\nMentions.defaultProps = {\n  prefixCls: 'rc-mentions',\n  prefix: '@',\n  split: ' ',\n  validateSearch: defaultValidateSearch,\n  filterOption: defaultFilterOption,\n  notFoundContent: 'Not Found',\n  rows: 1\n};\npolyfill(Mentions);\nexport default Mentions;"]},"metadata":{},"sourceType":"module"}
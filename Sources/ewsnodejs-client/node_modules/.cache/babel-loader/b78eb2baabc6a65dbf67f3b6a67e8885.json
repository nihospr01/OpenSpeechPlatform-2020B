{"ast":null,"code":"import _defineProperty from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{axios}from\"utils/utils\";import{withStyles}from\"@material-ui/styles\";import Grid from\"@material-ui/core/Grid\";import ToggleButton from\"@material-ui/lab/ToggleButton\";import AudioFilePlayer from\"components/audioFilePlayer\";var styles=function styles(theme){return{root:{flexGrow:1},content:{maxWidth:480,minWidth:200,margin:'auto',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center'},groupButton:{width:\"auto\",minWidth:200,color:\"gray\",margin:'auto'}};};var options=[\"live\",\"Audio file\"];var Stimulus=/*#__PURE__*/function(_Component){_inherits(Stimulus,_Component);var _super=_createSuper(Stimulus);function Stimulus(){var _this;_classCallCheck(this,Stimulus);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// 0 - audio, 1 - live file\nalpha:1,file:0,// TODO: Consider deleting 'file', not sure what is the use of this\nfileList:[],currentFile:\"\",currentCaption:\"\",audioPath:\"\",audio_repeat:0,audio_play:0,showTranscript:false,playbackStartTime:0,isFilePlaying:0,prevWords:[],currWord:\"\",restWords:[]};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fileResponse,pathResponse,fileList,audioPath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/researcher/fileNames\");case 3:fileResponse=_context.sent;_context.next=6;return axios.get(\"/api/researcher/audioPath\");case 6:pathResponse=_context.sent;fileList=[];audioPath=pathResponse.data;console.log(fileResponse.data);fileResponse.data.forEach(function(element){fileList.push({value:element.value,label:element.value,transcript:element.transcript});});_this.setState({fileList:fileList,audioPath:audioPath});_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));_this.handlePlayChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(type,value){var _this$state,currentFile,alpha,audioPath,audio_repeat,audio_play,filePath,audioData,dataInput,response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$state=_this.state,currentFile=_this$state.currentFile,alpha=_this$state.alpha,audioPath=_this$state.audioPath,audio_repeat=_this$state.audio_repeat,audio_play=_this$state.audio_play;filePath=\"\";// Switch between live data and stimulus file,\nif(type===\"alpha\"){filePath=value===1?audioPath.concat(currentFile):\"\";}else{filePath=alpha===1?audioPath.concat(currentFile):\"\";}audioData=_defineProperty({audio_filename:filePath,audio_reset:0,audio_repeat:audio_repeat,audio_play:audio_play,alpha:alpha},type,value);dataInput={left:audioData,right:audioData};_context2.prev=5;_context2.next=8;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataInput});case 8:response=_context2.sent;data=response.data;console.log(data);_this.setState(_defineProperty({},type,value));_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](5);alert(_context2.t0.response.data);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[5,14]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}();return _this;}_createClass(Stimulus,[{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state2=this.state,alpha=_this$state2.alpha,audio_play=_this$state2.audio_play,audio_repeat=_this$state2.audio_repeat;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3,className:classes.content},/*#__PURE__*/React.createElement(Grid,{item:true,style:{width:'auto'}},options.map(function(value,index){return/*#__PURE__*/React.createElement(ToggleButton,{color:\"primary\",className:classes.groupButton,key:\"stimulus_\".concat(index),value:index,selected:index===alpha,onClick:function onClick(){return _this2.handlePlayChange(\"alpha\",index);}},value);})),/*#__PURE__*/React.createElement(Grid,{item:true},alpha===1&&/*#__PURE__*/React.createElement(AudioFilePlayer,null))));}}]);return Stimulus;}(Component);export default withStyles(styles)(Stimulus);","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/src/pages/general/stimulus.jsx"],"names":["React","Component","axios","withStyles","Grid","ToggleButton","AudioFilePlayer","styles","theme","root","flexGrow","content","maxWidth","minWidth","margin","display","flexDirection","alignItems","justifyContent","groupButton","width","color","options","Stimulus","state","alpha","file","fileList","currentFile","currentCaption","audioPath","audio_repeat","audio_play","showTranscript","playbackStartTime","isFilePlaying","prevWords","currWord","restWords","componentDidMount","get","fileResponse","pathResponse","data","console","log","forEach","element","push","value","label","transcript","setState","alert","response","handlePlayChange","type","filePath","concat","audioData","audio_filename","audio_reset","dataInput","left","right","post","method","classes","props","map","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { axios } from \"utils/utils\";\nimport { withStyles } from \"@material-ui/styles\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport AudioFilePlayer from \"components/audioFilePlayer\"\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    content: {\n        maxWidth: 480,\n        minWidth: 200,\n        margin: 'auto',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    groupButton: {\n        width: \"auto\",\n        minWidth: 200,\n        color: \"gray\",\n        margin: 'auto'\n    },\n});\n\nconst options = [\"live\", \"Audio file\"];\n\nclass Stimulus extends Component {\n    state = {\n        // 0 - audio, 1 - live file\n        alpha: 1,\n        file: 0,  // TODO: Consider deleting 'file', not sure what is the use of this\n        fileList: [],\n        currentFile: \"\",\n        currentCaption: \"\",\n        audioPath: \"\",\n        audio_repeat: 0,\n        audio_play: 0,\n        showTranscript: false,\n        playbackStartTime: 0,\n        isFilePlaying: 0,\n        prevWords: [],\n        currWord: \"\",\n        restWords: []\n    };\n\n    componentDidMount = async () => {\n        try {\n            const fileResponse = await axios.get(\"/api/researcher/fileNames\");\n            const pathResponse = await axios.get(\"/api/researcher/audioPath\");\n            let fileList = [];\n            let audioPath = pathResponse.data;\n            console.log(fileResponse.data);\n            fileResponse.data.forEach((element) => {\n                fileList.push(\n                    {\n                        value: element.value,\n                        label: element.value,\n                        transcript: element.transcript\n                    }\n                );\n            });\n\n            this.setState({ fileList, audioPath });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    // Handle change for all play icons and stimulus options\n    handlePlayChange = async (type, value) => {\n        const {\n            currentFile,\n            alpha,\n            audioPath,\n            audio_repeat,\n            audio_play,\n        } = this.state;\n        let filePath = \"\";\n\n        // Switch between live data and stimulus file,\n        if (type === \"alpha\") {\n            filePath = value === 1 ? audioPath.concat(currentFile) : \"\";\n        } else {\n            filePath = alpha === 1 ? audioPath.concat(currentFile) : \"\";\n        }\n        let audioData = {\n            audio_filename: filePath,\n            audio_reset:0,\n            audio_repeat,\n            audio_play,\n            alpha,\n            //Add new value to override old value\n            [type]: value,\n        };\n        const dataInput = {\n            left: audioData,\n            right: audioData,\n        };\n        try {\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataInput,\n            });\n            const data = response.data;\n            console.log(data);\n            this.setState({\n                [type]: value,\n            });\n\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    render() {\n        const { classes } = this.props;\n        const { alpha, audio_play, audio_repeat } = this.state;\n        return (\n            <div className={classes.root}>\n\n                <Grid container spacing={3} className={classes.content}>\n                    <Grid item style={{width: 'auto'}}>\n                        {options.map((value, index) => (\n                            <ToggleButton\n                                color=\"primary\"\n                                className={classes.groupButton}\n                                key={`stimulus_${index}`}\n                                value={index}\n                                selected={index === alpha}\n                                onClick={() =>\n                                    this.handlePlayChange(\"alpha\", index)\n                                }\n                            >\n                                {value}\n                            </ToggleButton>\n                        ))}\n                    </Grid>\n\n                    <Grid item>\n                    {alpha === 1 && (\n                        <AudioFilePlayer/>\n                    )}\n                    </Grid>\n                </Grid>\n\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(Stimulus);\n"]},"metadata":{},"sourceType":"module"}
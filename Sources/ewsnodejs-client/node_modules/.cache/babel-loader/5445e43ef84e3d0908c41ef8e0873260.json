{"ast":null,"code":"import _defineProperty from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{axios}from\"utils/utils\";import{withStyles}from\"@material-ui/styles\";import Paper from'@material-ui/core/Paper';import Grid from\"@material-ui/core/Grid\";import Typography from\"@material-ui/core/Typography\";import ToggleButton from\"@material-ui/lab/ToggleButton\";import PauseIcon from\"@material-ui/icons/Pause\";import PlayArrowIcon from\"@material-ui/icons/PlayArrow\";import SyncDisabledIcon from\"@material-ui/icons/SyncDisabled\";import LoopIcon from\"@material-ui/icons/Loop\";import StopIcon from\"@material-ui/icons/Stop\";import Select from\"react-select\";import Switch from'@material-ui/core/Switch';import{AutoComplete}from\"antd\";var styles=function styles(theme){return{root:{flexGrow:1},content:{padding:theme.spacing(3),width:500,// margin: 'auto',\nbackgroundColor:'#7FFFD4'},icon:{width:50,height:50},groupButton:{width:320,color:\"gray\"}};};// const options = [\"live\", \"Audio file\"];\nvar defaultTranscript=\"This file has no transcript.\";var checkWordFreq=10;var AudioFilePlayer=/*#__PURE__*/function(_Component){_inherits(AudioFilePlayer,_Component);var _super=_createSuper(AudioFilePlayer);function AudioFilePlayer(){var _this;_classCallCheck(this,AudioFilePlayer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// 0 - audio, 1 - live file\n// alpha: 1,\nfileList:[],currentFile:\"\",currentCaption:\"\",audioPath:\"\",audio_repeat:0,audio_play:0,showTranscript:false,playbackStartTime:0,isFilePlaying:0,prevWords:[],currWord:\"\",restWords:[]};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fileResponse,pathResponse,fileList,audioPath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/researcher/fileNames\");case 3:fileResponse=_context.sent;_context.next=6;return axios.get(\"/api/researcher/audioPath\");case 6:pathResponse=_context.sent;fileList=[];audioPath=pathResponse.data;fileResponse.data.forEach(function(element){fileList.push({value:element.value,label:element.value,transcript:element.transcript});});_this.setState({fileList:fileList,audioPath:audioPath});setInterval(_this.getCurrentWord,checkWordFreq);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));_this.componentWillUnmount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.pause();case 1:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleFileChange=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this.pause();_this.setState({currentFile:file.value});if(_this.props.onChangeAudioFile){_this.props.onChangeAudioFile(file.value);}// If the file doesn't have transcript, set currentCaption as default message. The\n// reason we pair the message with 'punct' key is to make the render more conveniently.\nif(file.transcript){_context3.next=7;break;}console.log(\"No transcript found\");_this.setState({currentCaption:{punct:defaultTranscript},isFilePlaying:0,prevWords:[],currWord:\"\",restWords:defaultTranscript});return _context3.abrupt(\"return\");case 7:_context3.prev=7;_context3.next=10;return axios.post(\"/api/researcher/jsonFile\",{data:_this.state.audioPath.concat(file.transcript)});case 10:response=_context3.sent;// console.log(response.data);\n_this.setState({currentCaption:response.data,isFilePlaying:0,prevWords:[],currWord:\"\",restWords:response.data.punct});_context3.next=17;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](7);alert(_context3.t0.response.data);case 17:case\"end\":return _context3.stop();}}},_callee3,null,[[7,14]]);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.getCurrentWord=function(){if(!_this.state.currentFile||!_this.state.currentCaption){return;}if(_this.state.isFilePlaying===0){return;}else if(_this.state.currentCaption.punct===defaultTranscript){return;}else{var words=_this.state.currentCaption.punct.split(' ');var wordsInfo=_this.state.currentCaption.words;var currentTime=Date.now();var timeLapsed=currentTime-_this.state.playbackStartTime;var index=0;while(index<wordsInfo.length-1&&timeLapsed>wordsInfo[index+1].start){index++;}var prevWords=\"\";var currWord=\"\";var restWords=\"\";if(index===0){prevWords=words.slice(0,index).join(' ');currWord=words[index]+\" \";// Assume there are more than 1 word, i.e. the max index > 0.\nrestWords=words.slice(index+1).join(' ');}else if(index===wordsInfo.length-1){prevWords=words.slice(0,index).join(' ')+\" \";currWord=words[index];restWords=\"\";}else{prevWords=words.slice(0,index).join(' ')+\" \";currWord=words[index]+\" \";restWords=words.slice(index+1).join(' ');}_this.setState({prevWords:prevWords,currWord:currWord,restWords:restWords});}};_this.handleCaptionToggle=function(event){_this.setState({showTranscript:event.target.checked});};_this.playFile=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var preparePlay,_this$state,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:// Check if there is any preparation to do, like sending some HA parameters,\n// before we send the audio file data to RT-MHA\npreparePlay=_this.props.preparePlay;if(preparePlay){preparePlay();}_this$state=_this.state,currentFile=_this$state.currentFile,audioPath=_this$state.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,alpha:1,audio_play:1};dataToSend={left:audioData,right:audioData};_context4.prev=6;_context4.next=9;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 9:response=_context4.sent;data=response.data;console.log(data);// Set the states for closed captioning feature\n_this.setState({audio_play:1,isFilePlaying:1,playbackStartTime:Date.now()// Get the current time as the start point at which we start to play the file\n});_context4.next=18;break;case 15:_context4.prev=15;_context4.t0=_context4[\"catch\"](6);alert(_context4.t0.response.data);case 18:case\"end\":return _context4.stop();}}},_callee4,null,[[6,15]]);}));_this.pause=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var _this$state2,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this$state2=_this.state,currentFile=_this$state2.currentFile,audioPath=_this$state2.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,audio_play:0};dataToSend={left:audioData,right:audioData};_context5.prev=4;_context5.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 7:response=_context5.sent;data=response.data;console.log(data);_this.setState({audio_play:0,isFilePlaying:0});_context5.next=16;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](4);alert(_context5.t0.response.data);case 16:case\"end\":return _context5.stop();}}},_callee5,null,[[4,13]]);}));_this.handleRepeat=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var _this$state3,currentFile,audioPath,filePath,audioData,dataToSend,response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state3=_this.state,currentFile=_this$state3.currentFile,audioPath=_this$state3.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,alpha:1,audio_repeat:1,audio_play:1};dataToSend={left:audioData,right:audioData};_context6.prev=4;_context6.next=7;return axios.post(\"/api/param/setParam\",{method:\"set\",data:dataToSend});case 7:response=_context6.sent;console.log(response.data);_this.setState({audio_repeat:1,audio_play:1,isFilePlaying:1,playbackStartTime:Date.now()});_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](4);alert(_context6.t0.repsonse.data);case 15:case\"end\":return _context6.stop();}}},_callee6,null,[[4,12]]);}));_this.cancelRepeat=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this$state4,currentFile,audioPath,filePath,audioData,dataToSend,response,data;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_this$state4=_this.state,currentFile=_this$state4.currentFile,audioPath=_this$state4.audioPath;// Prepare the data to send to RT-MHA\nfilePath=audioPath.concat(currentFile);audioData={audio_filename:filePath,audio_repeat:0};dataToSend={left:audioData,right:audioData};_context7.prev=4;_context7.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataToSend});case 7:response=_context7.sent;data=response.data;console.log(data);_this.setState({audio_repeat:0});_context7.next=16;break;case 13:_context7.prev=13;_context7.t0=_context7[\"catch\"](4);alert(_context7.t0.response.data);case 16:case\"end\":return _context7.stop();}}},_callee7,null,[[4,13]]);}));_this.handlePlayChange=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(type,value){var _this$state5,currentFile,audioPath,audio_repeat,audio_play,filePath,audioData,dataInput,response,data;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this$state5=_this.state,currentFile=_this$state5.currentFile,audioPath=_this$state5.audioPath,audio_repeat=_this$state5.audio_repeat,audio_play=_this$state5.audio_play;filePath=audioPath.concat(currentFile);// Switch between live data and stimulus file,\n// if (type === \"alpha\") {\n//     filePath = value === 1 ? audioPath.concat(currentFile) : \"\";\n// } else {\n//     filePath = alpha === 1 ? audioPath.concat(currentFile) : \"\";\n// }\naudioData=_defineProperty({audio_filename:filePath,audio_reset:0,audio_repeat:audio_repeat,audio_play:audio_play},type,value);dataInput={left:audioData,right:audioData};_context8.prev=4;_context8.next=7;return axios.post(\"/api/param/setparam\",{method:\"set\",data:dataInput});case 7:response=_context8.sent;data=response.data;console.log(data);_this.setState(_defineProperty({},type,value));console.log(_this.state);if(type==='audio_play'&&value===1){_this.setState({isFilePlaying:1,playbackStartTime:Date.now()});}_context8.next=18;break;case 15:_context8.prev=15;_context8.t0=_context8[\"catch\"](4);alert(_context8.t0.response.data);case 18:case\"end\":return _context8.stop();}}},_callee8,null,[[4,15]]);}));return function(_x2,_x3){return _ref8.apply(this,arguments);};}();return _this;}_createClass(AudioFilePlayer,[{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state6=this.state,alpha=_this$state6.alpha,audio_play=_this$state6.audio_play,audio_repeat=_this$state6.audio_repeat;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",className:classes.content},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Select,{onChange:this.handleFileChange,options:this.state.fileList})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(\"div\",null,\"Show Transcript\",/*#__PURE__*/React.createElement(Switch,{checked:this.state.showTranscript,onChange:this.handleCaptionToggle,color:\"primary\"}))),/*#__PURE__*/React.createElement(Grid,{item:true},this.state.showTranscript&&/*#__PURE__*/React.createElement(\"p\",null,this.state.prevWords,/*#__PURE__*/React.createElement(\"font\",{color:\"red\"},this.state.currWord),this.state.restWords)),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3,justify:\"space-between\",alignItems:\"center\"},/*#__PURE__*/React.createElement(\"div\",null,audio_repeat===0?/*#__PURE__*/React.createElement(SyncDisabledIcon// onClick={() =>\n//     this.handlePlayChange(\n//         \"audio_repeat\",\n//         1\n//     )\n// }\n,{onClick:this.handleRepeat,className:classes.icon}):/*#__PURE__*/React.createElement(LoopIcon// onClick={() =>\n//     this.handlePlayChange(\n//         \"audio_repeat\",\n//         0\n//     )\n// }\n,{onClick:this.cancelRepeat,className:classes.icon}),/*#__PURE__*/React.createElement(Typography,null,audio_repeat===1?\"Repeat\":\"Stop Repeat\")),/*#__PURE__*/React.createElement(\"div\",null,audio_play===0?/*#__PURE__*/React.createElement(PlayArrowIcon,{className:classes.icon,onClick:this.playFile}):/*#__PURE__*/React.createElement(PauseIcon,{onClick:this.pause,className:classes.icon}),/*#__PURE__*/React.createElement(Typography,null,\"Play/Pause\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(StopIcon,{className:classes.icon,onClick:function onClick(){return _this2.handlePlayChange(\"audio_reset\",1);}}),/*#__PURE__*/React.createElement(Typography,null,\"Reset\")))));}}]);return AudioFilePlayer;}(Component);export default withStyles(styles)(AudioFilePlayer);","map":{"version":3,"sources":["/opt/osp/ewsnodejs-client/src/components/audioFilePlayer.jsx"],"names":["React","Component","axios","withStyles","Paper","Grid","Typography","ToggleButton","PauseIcon","PlayArrowIcon","SyncDisabledIcon","LoopIcon","StopIcon","Select","Switch","AutoComplete","styles","theme","root","flexGrow","content","padding","spacing","width","backgroundColor","icon","height","groupButton","color","defaultTranscript","checkWordFreq","AudioFilePlayer","state","fileList","currentFile","currentCaption","audioPath","audio_repeat","audio_play","showTranscript","playbackStartTime","isFilePlaying","prevWords","currWord","restWords","componentDidMount","get","fileResponse","pathResponse","data","forEach","element","push","value","label","transcript","setState","setInterval","getCurrentWord","alert","response","componentWillUnmount","pause","handleFileChange","file","props","onChangeAudioFile","console","log","punct","post","concat","words","split","wordsInfo","currentTime","Date","now","timeLapsed","index","length","start","slice","join","handleCaptionToggle","event","target","checked","playFile","preparePlay","filePath","audioData","audio_filename","alpha","dataToSend","left","right","method","handleRepeat","repsonse","cancelRepeat","handlePlayChange","type","audio_reset","dataInput","classes"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { axios } from \"utils/utils\";\nimport { withStyles } from \"@material-ui/styles\";\nimport Paper from '@material-ui/core/Paper';\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ToggleButton from \"@material-ui/lab/ToggleButton\";\nimport PauseIcon from \"@material-ui/icons/Pause\";\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\nimport SyncDisabledIcon from \"@material-ui/icons/SyncDisabled\";\nimport LoopIcon from \"@material-ui/icons/Loop\";\nimport StopIcon from \"@material-ui/icons/Stop\";\nimport Select from \"react-select\";\nimport Switch from '@material-ui/core/Switch';\nimport { AutoComplete } from \"antd\";\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    content: {\n        padding: theme.spacing(3),\n        width: 500,\n        // margin: 'auto',\n        backgroundColor: '#7FFFD4'\n    },\n    icon: {\n        width: 50,\n        height: 50,\n    },\n    groupButton: {\n        width: 320,\n        color: \"gray\",\n    },\n});\n\n// const options = [\"live\", \"Audio file\"];\nconst defaultTranscript = \"This file has no transcript.\";\nconst checkWordFreq = 10;\n\nclass AudioFilePlayer extends Component {\n    state = {\n        // 0 - audio, 1 - live file\n        // alpha: 1,\n        fileList: [],\n        currentFile: \"\",\n        currentCaption: \"\",\n        audioPath: \"\",\n        audio_repeat: 0,\n        audio_play: 0,\n        showTranscript: false,\n        playbackStartTime: 0,\n        isFilePlaying: 0,\n        prevWords: [],\n        currWord: \"\",\n        restWords: []\n    };\n\n    componentDidMount = async () => {\n        try {\n            const fileResponse = await axios.get(\"/api/researcher/fileNames\");\n            const pathResponse = await axios.get(\"/api/researcher/audioPath\");\n            let fileList = [];\n            let audioPath = pathResponse.data;\n            fileResponse.data.forEach((element) => {\n                fileList.push(\n                    {\n                        value: element.value,\n                        label: element.value,\n                        transcript: element.transcript\n                    }\n                );\n            });\n\n            this.setState({ fileList, audioPath });\n            setInterval(this.getCurrentWord, checkWordFreq);\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    componentWillUnmount = async () => {\n        this.pause();\n    }\n\n    // componentWillUpdate = async (prevProps) => {\n    //     if (this.props.parentID !== prevProps.parentID) {\n    //         this.pause();\n    //     }\n    // }\n\n    handleFileChange = async (file) => {\n        this.pause();\n\n        this.setState({\n            currentFile: file.value,\n        });\n\n        if(this.props.onChangeAudioFile){\n            this.props.onChangeAudioFile(file.value);\n        } \n\n        // If the file doesn't have transcript, set currentCaption as default message. The\n        // reason we pair the message with 'punct' key is to make the render more conveniently.\n        if (!file.transcript) {\n            console.log(\"No transcript found\");\n            this.setState({\n                currentCaption: {punct: defaultTranscript},\n                isFilePlaying: 0,\n                prevWords: [],\n                currWord: \"\",\n                restWords: defaultTranscript\n            });\n            return;\n        }\n        // If the file has transcript, get the transcript.\n        try {\n            const response = await axios.post(\"/api/researcher/jsonFile\", {data: this.state.audioPath.concat(file.transcript)});\n            // console.log(response.data);\n            this.setState({\n                currentCaption: response.data,\n                isFilePlaying: 0,\n                prevWords: [],\n                currWord: \"\",\n                restWords: response.data.punct\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    getCurrentWord = () => {\n        if (!this.state.currentFile || !this.state.currentCaption) {\n            return;\n        }\n\n        if (this.state.isFilePlaying === 0) {\n            return;\n        } else if (this.state.currentCaption.punct === defaultTranscript) {\n            return;\n        } else {\n            const words = this.state.currentCaption.punct.split(' ');\n            const wordsInfo = this.state.currentCaption.words;\n            const currentTime = Date.now();\n            const timeLapsed = (currentTime - this.state.playbackStartTime);\n            let index = 0;\n            while (index < wordsInfo.length - 1 && timeLapsed > wordsInfo[index + 1].start) {\n                index++;\n            }\n\n            let prevWords = \"\";\n            let currWord = \"\";\n            let restWords = \"\";\n            if (index === 0) {\n                prevWords = words.slice(0, index).join(' ');\n                currWord = words[index] + \" \";\n                // Assume there are more than 1 word, i.e. the max index > 0.\n                restWords = words.slice(index + 1).join(' ');\n            } else if (index === wordsInfo.length - 1) {\n                prevWords = words.slice(0, index).join(' ') + \" \";\n                currWord = words[index];\n                restWords = \"\";               \n            } else {\n                prevWords = words.slice(0, index).join(' ') + \" \";\n                currWord = words[index] + \" \";\n                restWords = words.slice(index + 1).join(' ');\n            }\n            this.setState({prevWords, currWord, restWords});\n        }\n    };\n\n    handleCaptionToggle = (event) => {\n        this.setState({\n            showTranscript: event.target.checked\n        });\n    }\n\n    playFile = async () => {\n        // Check if there is any preparation to do, like sending some HA parameters,\n        // before we send the audio file data to RT-MHA\n        const {preparePlay} = this.props;\n        if (preparePlay) {\n            preparePlay();\n        }\n\n        const {\n            currentFile,\n            audioPath,\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            alpha: 1,\n            audio_play: 1\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            // Set the states for closed captioning feature\n            this.setState({\n                audio_play: 1,\n                isFilePlaying: 1,\n                playbackStartTime: Date.now() // Get the current time as the start point at which we start to play the file\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    pause = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            audio_play: 0,\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            this.setState({\n                audio_play: 0,\n                isFilePlaying: 0\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    handleRepeat = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            alpha: 1,\n            audio_repeat: 1,\n            audio_play: 1\n        };\n\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            const response = await axios.post(\"/api/param/setParam\", {\n                method: \"set\",\n                data: dataToSend\n            });\n            console.log(response.data);\n\n            this.setState({\n                audio_repeat: 1,\n                audio_play: 1,\n                isFilePlaying: 1,\n                playbackStartTime: Date.now()\n            })\n        } catch (error) {\n            alert(error.repsonse.data);\n        }\n    }\n\n    cancelRepeat = async () => {\n        const {\n            currentFile,\n            audioPath\n        } = this.state;\n\n        // Prepare the data to send to RT-MHA\n        const filePath = audioPath.concat(currentFile);\n        const audioData = {\n            audio_filename: filePath,\n            audio_repeat: 0,\n        };\n        const dataToSend = {\n            left: audioData,\n            right: audioData\n        };\n\n        try {\n            // Send data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataToSend,\n            });\n            const data = response.data;\n            console.log(data);\n\n            this.setState({\n                audio_repeat: 0\n            });\n        } catch (error) {\n            alert(error.response.data);\n        }\n    }\n\n    // Handle change for all play icons and stimulus options\n    handlePlayChange = async (type, value) => {\n        const {\n            currentFile,\n            // alpha,\n            audioPath,\n            audio_repeat,\n            audio_play,\n        } = this.state;\n        let filePath = audioPath.concat(currentFile);\n\n        // Switch between live data and stimulus file,\n        // if (type === \"alpha\") {\n        //     filePath = value === 1 ? audioPath.concat(currentFile) : \"\";\n        // } else {\n        //     filePath = alpha === 1 ? audioPath.concat(currentFile) : \"\";\n        // }\n        let audioData = {\n            audio_filename: filePath,\n            audio_reset:0,\n            audio_repeat,\n            audio_play,\n            // alpha,\n            //Add new value to override old value\n            [type]: value,\n        };\n        const dataInput = {\n            left: audioData,\n            right: audioData,\n        };\n        try {\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: dataInput,\n            });\n            const data = response.data;\n            console.log(data);\n            this.setState({\n                [type]: value,\n            });\n            console.log(this.state);\n\n            if (type === 'audio_play' && value === 1) {\n                this.setState({\n                    isFilePlaying: 1,\n                    playbackStartTime: Date.now()\n                });\n            }\n        } catch (error) {\n            alert(error.response.data);\n        }\n    };\n\n    render() {\n        const { classes } = this.props;\n        const { alpha, audio_play, audio_repeat } = this.state;\n        return (\n            <div className={classes.root}>\n                <Grid container direction=\"column\" className={classes.content}>\n                    <Grid item>\n                        <Select\n                            onChange={this.handleFileChange}\n                            options={this.state.fileList}\n                        />\n                    </Grid>\n                    <Grid item>\n                        <div>\n                            Show Transcript\n                            <Switch\n                                checked={this.state.showTranscript}\n                                onChange={this.handleCaptionToggle}\n                                color=\"primary\"\n                            />\n                        </div>\n                    </Grid>\n                    <Grid item>\n                        {this.state.showTranscript && (\n                            <p>\n                                {this.state.prevWords}\n                                <font color=\"red\">{this.state.currWord}</font>\n                                {this.state.restWords}\n                            </p>\n                        )}\n                    </Grid>\n                    <Grid\n                        container\n                        spacing={3}\n                        justify=\"space-between\"\n                        alignItems=\"center\"\n                    >\n                        <div>\n                            {audio_repeat === 0 ? (\n                                <SyncDisabledIcon\n                                    // onClick={() =>\n                                    //     this.handlePlayChange(\n                                    //         \"audio_repeat\",\n                                    //         1\n                                    //     )\n                                    // }\n                                    onClick={this.handleRepeat}\n                                    className={classes.icon}\n                                />\n                            ) : (\n                                <LoopIcon\n                                    // onClick={() =>\n                                    //     this.handlePlayChange(\n                                    //         \"audio_repeat\",\n                                    //         0\n                                    //     )\n                                    // }\n                                    onClick={this.cancelRepeat}\n                                    className={classes.icon}\n                                />\n                            )}\n                            <Typography>\n                                {audio_repeat === 1\n                                    ? \"Repeat\"\n                                    : \"Stop Repeat\"}\n                            </Typography>\n                        </div>\n\n                        <div>\n                            {audio_play === 0 ? (\n                                <PlayArrowIcon\n                                    className={classes.icon}\n                                    onClick={this.playFile}\n                                />\n                            ) : (\n                                <PauseIcon\n                                    onClick={this.pause}\n                                    className={classes.icon}\n                                />\n                            )}\n                            <Typography>{\"Play/Pause\"}</Typography>\n                        </div>\n\n                        <div>\n                            <StopIcon\n                                className={classes.icon}\n                                onClick={() =>\n                                    this.handlePlayChange(\"audio_reset\", 1)\n                                }\n                            />\n                            <Typography>{\"Reset\"}</Typography>\n                        </div>\n                    </Grid>\n                </Grid>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(AudioFilePlayer);\n"]},"metadata":{},"sourceType":"module"}
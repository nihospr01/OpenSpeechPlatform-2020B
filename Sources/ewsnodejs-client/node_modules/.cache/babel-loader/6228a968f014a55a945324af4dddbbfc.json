{"ast":null,"code":"import { max, range, tickStep } from \"d3-array\";\nimport { slice } from \"./array\";\nimport { blurX, blurY } from \"./blur\";\nimport constant from \"./constant\";\nimport contours from \"./contours\";\n\nfunction defaultX(d) {\n  return d[0];\n}\n\nfunction defaultY(d) {\n  return d[1];\n}\n\nfunction defaultWeight() {\n  return 1;\n}\n\nexport default function () {\n  var x = defaultX,\n      y = defaultY,\n      weight = defaultWeight,\n      dx = 960,\n      dy = 500,\n      r = 20,\n      // blur radius\n  k = 2,\n      // log2(grid cell size)\n  o = r * 3,\n      // grid offset, to pad for blur\n  n = dx + o * 2 >> k,\n      // grid width\n  m = dy + o * 2 >> k,\n      // grid height\n  threshold = constant(20);\n\n  function density(data) {\n    var values0 = new Float32Array(n * m),\n        values1 = new Float32Array(n * m);\n    data.forEach(function (d, i, data) {\n      var xi = +x(d, i, data) + o >> k,\n          yi = +y(d, i, data) + o >> k,\n          wi = +weight(d, i, data);\n\n      if (xi >= 0 && xi < n && yi >= 0 && yi < m) {\n        values0[xi + yi * n] += wi;\n      }\n    }); // TODO Optimize.\n\n    blurX({\n      width: n,\n      height: m,\n      data: values0\n    }, {\n      width: n,\n      height: m,\n      data: values1\n    }, r >> k);\n    blurY({\n      width: n,\n      height: m,\n      data: values1\n    }, {\n      width: n,\n      height: m,\n      data: values0\n    }, r >> k);\n    blurX({\n      width: n,\n      height: m,\n      data: values0\n    }, {\n      width: n,\n      height: m,\n      data: values1\n    }, r >> k);\n    blurY({\n      width: n,\n      height: m,\n      data: values1\n    }, {\n      width: n,\n      height: m,\n      data: values0\n    }, r >> k);\n    blurX({\n      width: n,\n      height: m,\n      data: values0\n    }, {\n      width: n,\n      height: m,\n      data: values1\n    }, r >> k);\n    blurY({\n      width: n,\n      height: m,\n      data: values1\n    }, {\n      width: n,\n      height: m,\n      data: values0\n    }, r >> k);\n    var tz = threshold(values0); // Convert number of thresholds into uniform thresholds.\n\n    if (!Array.isArray(tz)) {\n      var stop = max(values0);\n      tz = tickStep(0, stop, tz);\n      tz = range(0, Math.floor(stop / tz) * tz, tz);\n      tz.shift();\n    }\n\n    return contours().thresholds(tz).size([n, m])(values0).map(transform);\n  }\n\n  function transform(geometry) {\n    geometry.value *= Math.pow(2, -2 * k); // Density in points per square pixel.\n\n    geometry.coordinates.forEach(transformPolygon);\n    return geometry;\n  }\n\n  function transformPolygon(coordinates) {\n    coordinates.forEach(transformRing);\n  }\n\n  function transformRing(coordinates) {\n    coordinates.forEach(transformPoint);\n  } // TODO Optimize.\n\n\n  function transformPoint(coordinates) {\n    coordinates[0] = coordinates[0] * Math.pow(2, k) - o;\n    coordinates[1] = coordinates[1] * Math.pow(2, k) - o;\n  }\n\n  function resize() {\n    o = r * 3;\n    n = dx + o * 2 >> k;\n    m = dy + o * 2 >> k;\n    return density;\n  }\n\n  density.x = function (_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), density) : x;\n  };\n\n  density.y = function (_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), density) : y;\n  };\n\n  density.weight = function (_) {\n    return arguments.length ? (weight = typeof _ === \"function\" ? _ : constant(+_), density) : weight;\n  };\n\n  density.size = function (_) {\n    if (!arguments.length) return [dx, dy];\n\n    var _0 = Math.ceil(_[0]),\n        _1 = Math.ceil(_[1]);\n\n    if (!(_0 >= 0) && !(_0 >= 0)) throw new Error(\"invalid size\");\n    return dx = _0, dy = _1, resize();\n  };\n\n  density.cellSize = function (_) {\n    if (!arguments.length) return 1 << k;\n    if (!((_ = +_) >= 1)) throw new Error(\"invalid cell size\");\n    return k = Math.floor(Math.log(_) / Math.LN2), resize();\n  };\n\n  density.thresholds = function (_) {\n    return arguments.length ? (threshold = typeof _ === \"function\" ? _ : Array.isArray(_) ? constant(slice.call(_)) : constant(_), density) : threshold;\n  };\n\n  density.bandwidth = function (_) {\n    if (!arguments.length) return Math.sqrt(r * (r + 1));\n    if (!((_ = +_) >= 0)) throw new Error(\"invalid bandwidth\");\n    return r = Math.round((Math.sqrt(4 * _ * _ + 1) - 1) / 2), resize();\n  };\n\n  return density;\n}","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/d3-contour/src/density.js"],"names":["max","range","tickStep","slice","blurX","blurY","constant","contours","defaultX","d","defaultY","defaultWeight","x","y","weight","dx","dy","r","k","o","n","m","threshold","density","data","values0","Float32Array","values1","forEach","i","xi","yi","wi","width","height","tz","Array","isArray","stop","Math","floor","shift","thresholds","size","map","transform","geometry","value","pow","coordinates","transformPolygon","transformRing","transformPoint","resize","_","arguments","length","_0","ceil","_1","Error","cellSize","log","LN2","call","bandwidth","sqrt","round"],"mappings":"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","sourcesContent":["import {max, range, tickStep} from \"d3-array\";\nimport {slice} from \"./array\";\nimport {blurX, blurY} from \"./blur\";\nimport constant from \"./constant\";\nimport contours from \"./contours\";\n\nfunction defaultX(d) {\n  return d[0];\n}\n\nfunction defaultY(d) {\n  return d[1];\n}\n\nfunction defaultWeight() {\n  return 1;\n}\n\nexport default function() {\n  var x = defaultX,\n      y = defaultY,\n      weight = defaultWeight,\n      dx = 960,\n      dy = 500,\n      r = 20, // blur radius\n      k = 2, // log2(grid cell size)\n      o = r * 3, // grid offset, to pad for blur\n      n = (dx + o * 2) >> k, // grid width\n      m = (dy + o * 2) >> k, // grid height\n      threshold = constant(20);\n\n  function density(data) {\n    var values0 = new Float32Array(n * m),\n        values1 = new Float32Array(n * m);\n\n    data.forEach(function(d, i, data) {\n      var xi = (+x(d, i, data) + o) >> k,\n          yi = (+y(d, i, data) + o) >> k,\n          wi = +weight(d, i, data);\n      if (xi >= 0 && xi < n && yi >= 0 && yi < m) {\n        values0[xi + yi * n] += wi;\n      }\n    });\n\n    // TODO Optimize.\n    blurX({width: n, height: m, data: values0}, {width: n, height: m, data: values1}, r >> k);\n    blurY({width: n, height: m, data: values1}, {width: n, height: m, data: values0}, r >> k);\n    blurX({width: n, height: m, data: values0}, {width: n, height: m, data: values1}, r >> k);\n    blurY({width: n, height: m, data: values1}, {width: n, height: m, data: values0}, r >> k);\n    blurX({width: n, height: m, data: values0}, {width: n, height: m, data: values1}, r >> k);\n    blurY({width: n, height: m, data: values1}, {width: n, height: m, data: values0}, r >> k);\n\n    var tz = threshold(values0);\n\n    // Convert number of thresholds into uniform thresholds.\n    if (!Array.isArray(tz)) {\n      var stop = max(values0);\n      tz = tickStep(0, stop, tz);\n      tz = range(0, Math.floor(stop / tz) * tz, tz);\n      tz.shift();\n    }\n\n    return contours()\n        .thresholds(tz)\n        .size([n, m])\n      (values0)\n        .map(transform);\n  }\n\n  function transform(geometry) {\n    geometry.value *= Math.pow(2, -2 * k); // Density in points per square pixel.\n    geometry.coordinates.forEach(transformPolygon);\n    return geometry;\n  }\n\n  function transformPolygon(coordinates) {\n    coordinates.forEach(transformRing);\n  }\n\n  function transformRing(coordinates) {\n    coordinates.forEach(transformPoint);\n  }\n\n  // TODO Optimize.\n  function transformPoint(coordinates) {\n    coordinates[0] = coordinates[0] * Math.pow(2, k) - o;\n    coordinates[1] = coordinates[1] * Math.pow(2, k) - o;\n  }\n\n  function resize() {\n    o = r * 3;\n    n = (dx + o * 2) >> k;\n    m = (dy + o * 2) >> k;\n    return density;\n  }\n\n  density.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), density) : x;\n  };\n\n  density.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), density) : y;\n  };\n\n  density.weight = function(_) {\n    return arguments.length ? (weight = typeof _ === \"function\" ? _ : constant(+_), density) : weight;\n  };\n\n  density.size = function(_) {\n    if (!arguments.length) return [dx, dy];\n    var _0 = Math.ceil(_[0]), _1 = Math.ceil(_[1]);\n    if (!(_0 >= 0) && !(_0 >= 0)) throw new Error(\"invalid size\");\n    return dx = _0, dy = _1, resize();\n  };\n\n  density.cellSize = function(_) {\n    if (!arguments.length) return 1 << k;\n    if (!((_ = +_) >= 1)) throw new Error(\"invalid cell size\");\n    return k = Math.floor(Math.log(_) / Math.LN2), resize();\n  };\n\n  density.thresholds = function(_) {\n    return arguments.length ? (threshold = typeof _ === \"function\" ? _ : Array.isArray(_) ? constant(slice.call(_)) : constant(_), density) : threshold;\n  };\n\n  density.bandwidth = function(_) {\n    if (!arguments.length) return Math.sqrt(r * (r + 1));\n    if (!((_ = +_) >= 0)) throw new Error(\"invalid bandwidth\");\n    return r = Math.round((Math.sqrt(4 * _ * _ + 1) - 1) / 2), resize();\n  };\n\n  return density;\n}\n"]},"metadata":{},"sourceType":"module"}
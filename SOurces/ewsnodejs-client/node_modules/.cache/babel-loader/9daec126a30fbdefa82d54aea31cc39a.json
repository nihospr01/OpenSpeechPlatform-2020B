{"ast":null,"code":"import { shuffle, slice } from \"../array.js\";\nexport default function (circles) {\n  var i = 0,\n      n = (circles = shuffle(slice.call(circles))).length,\n      B = [],\n      p,\n      e;\n\n  while (i < n) {\n    p = circles[i];\n    if (e && enclosesWeak(e, p)) ++i;else e = encloseBasis(B = extendBasis(B, p)), i = 0;\n  }\n\n  return e;\n}\n\nfunction extendBasis(B, p) {\n  var i, j;\n  if (enclosesWeakAll(p, B)) return [p]; // If we get here then B must have at least one element.\n\n  for (i = 0; i < B.length; ++i) {\n    if (enclosesNot(p, B[i]) && enclosesWeakAll(encloseBasis2(B[i], p), B)) {\n      return [B[i], p];\n    }\n  } // If we get here then B must have at least two elements.\n\n\n  for (i = 0; i < B.length - 1; ++i) {\n    for (j = i + 1; j < B.length; ++j) {\n      if (enclosesNot(encloseBasis2(B[i], B[j]), p) && enclosesNot(encloseBasis2(B[i], p), B[j]) && enclosesNot(encloseBasis2(B[j], p), B[i]) && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {\n        return [B[i], B[j], p];\n      }\n    }\n  } // If we get here then something is very wrong.\n\n\n  throw new Error();\n}\n\nfunction enclosesNot(a, b) {\n  var dr = a.r - b.r,\n      dx = b.x - a.x,\n      dy = b.y - a.y;\n  return dr < 0 || dr * dr < dx * dx + dy * dy;\n}\n\nfunction enclosesWeak(a, b) {\n  var dr = a.r - b.r + 1e-6,\n      dx = b.x - a.x,\n      dy = b.y - a.y;\n  return dr > 0 && dr * dr > dx * dx + dy * dy;\n}\n\nfunction enclosesWeakAll(a, B) {\n  for (var i = 0; i < B.length; ++i) {\n    if (!enclosesWeak(a, B[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction encloseBasis(B) {\n  switch (B.length) {\n    case 1:\n      return encloseBasis1(B[0]);\n\n    case 2:\n      return encloseBasis2(B[0], B[1]);\n\n    case 3:\n      return encloseBasis3(B[0], B[1], B[2]);\n  }\n}\n\nfunction encloseBasis1(a) {\n  return {\n    x: a.x,\n    y: a.y,\n    r: a.r\n  };\n}\n\nfunction encloseBasis2(a, b) {\n  var x1 = a.x,\n      y1 = a.y,\n      r1 = a.r,\n      x2 = b.x,\n      y2 = b.y,\n      r2 = b.r,\n      x21 = x2 - x1,\n      y21 = y2 - y1,\n      r21 = r2 - r1,\n      l = Math.sqrt(x21 * x21 + y21 * y21);\n  return {\n    x: (x1 + x2 + x21 / l * r21) / 2,\n    y: (y1 + y2 + y21 / l * r21) / 2,\n    r: (l + r1 + r2) / 2\n  };\n}\n\nfunction encloseBasis3(a, b, c) {\n  var x1 = a.x,\n      y1 = a.y,\n      r1 = a.r,\n      x2 = b.x,\n      y2 = b.y,\n      r2 = b.r,\n      x3 = c.x,\n      y3 = c.y,\n      r3 = c.r,\n      a2 = x1 - x2,\n      a3 = x1 - x3,\n      b2 = y1 - y2,\n      b3 = y1 - y3,\n      c2 = r2 - r1,\n      c3 = r3 - r1,\n      d1 = x1 * x1 + y1 * y1 - r1 * r1,\n      d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,\n      d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,\n      ab = a3 * b2 - a2 * b3,\n      xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,\n      xb = (b3 * c2 - b2 * c3) / ab,\n      ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,\n      yb = (a2 * c3 - a3 * c2) / ab,\n      A = xb * xb + yb * yb - 1,\n      B = 2 * (r1 + xa * xb + ya * yb),\n      C = xa * xa + ya * ya - r1 * r1,\n      r = -(A ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);\n  return {\n    x: x1 + xa + xb * r,\n    y: y1 + ya + yb * r,\n    r: r\n  };\n}","map":{"version":3,"sources":["/opt/osp/ewsnodejs-client/node_modules/d3-hierarchy/src/pack/enclose.js"],"names":["shuffle","slice","circles","i","n","call","length","B","p","e","enclosesWeak","encloseBasis","extendBasis","j","enclosesWeakAll","enclosesNot","encloseBasis2","encloseBasis3","Error","a","b","dr","r","dx","x","dy","y","encloseBasis1","x1","y1","r1","x2","y2","r2","x21","y21","r21","l","Math","sqrt","c","x3","y3","r3","a2","a3","b2","b3","c2","c3","d1","d2","d3","ab","xa","xb","ya","yb","A","C"],"mappings":"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","sourcesContent":["import {shuffle, slice} from \"../array.js\";\n\nexport default function(circles) {\n  var i = 0, n = (circles = shuffle(slice.call(circles))).length, B = [], p, e;\n\n  while (i < n) {\n    p = circles[i];\n    if (e && enclosesWeak(e, p)) ++i;\n    else e = encloseBasis(B = extendBasis(B, p)), i = 0;\n  }\n\n  return e;\n}\n\nfunction extendBasis(B, p) {\n  var i, j;\n\n  if (enclosesWeakAll(p, B)) return [p];\n\n  // If we get here then B must have at least one element.\n  for (i = 0; i < B.length; ++i) {\n    if (enclosesNot(p, B[i])\n        && enclosesWeakAll(encloseBasis2(B[i], p), B)) {\n      return [B[i], p];\n    }\n  }\n\n  // If we get here then B must have at least two elements.\n  for (i = 0; i < B.length - 1; ++i) {\n    for (j = i + 1; j < B.length; ++j) {\n      if (enclosesNot(encloseBasis2(B[i], B[j]), p)\n          && enclosesNot(encloseBasis2(B[i], p), B[j])\n          && enclosesNot(encloseBasis2(B[j], p), B[i])\n          && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {\n        return [B[i], B[j], p];\n      }\n    }\n  }\n\n  // If we get here then something is very wrong.\n  throw new Error;\n}\n\nfunction enclosesNot(a, b) {\n  var dr = a.r - b.r, dx = b.x - a.x, dy = b.y - a.y;\n  return dr < 0 || dr * dr < dx * dx + dy * dy;\n}\n\nfunction enclosesWeak(a, b) {\n  var dr = a.r - b.r + 1e-6, dx = b.x - a.x, dy = b.y - a.y;\n  return dr > 0 && dr * dr > dx * dx + dy * dy;\n}\n\nfunction enclosesWeakAll(a, B) {\n  for (var i = 0; i < B.length; ++i) {\n    if (!enclosesWeak(a, B[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction encloseBasis(B) {\n  switch (B.length) {\n    case 1: return encloseBasis1(B[0]);\n    case 2: return encloseBasis2(B[0], B[1]);\n    case 3: return encloseBasis3(B[0], B[1], B[2]);\n  }\n}\n\nfunction encloseBasis1(a) {\n  return {\n    x: a.x,\n    y: a.y,\n    r: a.r\n  };\n}\n\nfunction encloseBasis2(a, b) {\n  var x1 = a.x, y1 = a.y, r1 = a.r,\n      x2 = b.x, y2 = b.y, r2 = b.r,\n      x21 = x2 - x1, y21 = y2 - y1, r21 = r2 - r1,\n      l = Math.sqrt(x21 * x21 + y21 * y21);\n  return {\n    x: (x1 + x2 + x21 / l * r21) / 2,\n    y: (y1 + y2 + y21 / l * r21) / 2,\n    r: (l + r1 + r2) / 2\n  };\n}\n\nfunction encloseBasis3(a, b, c) {\n  var x1 = a.x, y1 = a.y, r1 = a.r,\n      x2 = b.x, y2 = b.y, r2 = b.r,\n      x3 = c.x, y3 = c.y, r3 = c.r,\n      a2 = x1 - x2,\n      a3 = x1 - x3,\n      b2 = y1 - y2,\n      b3 = y1 - y3,\n      c2 = r2 - r1,\n      c3 = r3 - r1,\n      d1 = x1 * x1 + y1 * y1 - r1 * r1,\n      d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,\n      d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,\n      ab = a3 * b2 - a2 * b3,\n      xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,\n      xb = (b3 * c2 - b2 * c3) / ab,\n      ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,\n      yb = (a2 * c3 - a3 * c2) / ab,\n      A = xb * xb + yb * yb - 1,\n      B = 2 * (r1 + xa * xb + ya * yb),\n      C = xa * xa + ya * ya - r1 * r1,\n      r = -(A ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);\n  return {\n    x: x1 + xa + xb * r,\n    y: y1 + ya + yb * r,\n    r: r\n  };\n}\n"]},"metadata":{},"sourceType":"module"}
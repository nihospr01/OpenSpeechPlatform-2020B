{"ast":null,"code":"import _regeneratorRuntime from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{withStyles}from\"@material-ui/styles\";import Paper from\"@material-ui/core/Paper\";import Grid from\"@material-ui/core/Grid\";import TextField from\"@material-ui/core/TextField\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import Button from\"@material-ui/core/Button\";import{Link,withRouter}from\"react-router-dom\";import{compose}from\"recompose\";import withUserAuth from\"context/withUserAuth\";import{axios}from\"utils/utils\";var styles=function styles(theme){return{root:{flexGrow:1},grid:{marginLeft:30,marginTop:10},button:{margin:10},table:{margin:10}};};var rows=[125,250,500,750,1000,1500,2000,3000,4000,6000,8000];var requiredIdx=[1,2,4,6,8];var PureTonePage=/*#__PURE__*/function(_Component){_inherits(PureTonePage,_Component);var _super=_createSuper(PureTonePage);function PureTonePage(){var _this;_classCallCheck(this,PureTonePage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={audiologistID:\"\",firstEditable:false,secondEditable:false,worseEarList:[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],betterEarList:[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],currentEar:false};_this.componentDidMount=function(){_this.getWorseEar();};_this.handleIDChange=function(event){var firstEditable=_this.state.firstEditable;_this.setState({audiologistID:event.target.value});if(_this.validateID(event.target.value)?!firstEditable:firstEditable){_this.setState({firstEditable:!firstEditable});}};_this.handleTextChange=function(isWorseEar,index){return function(event){var _this$state=_this.state,worseEarList=_this$state.worseEarList,betterEarList=_this$state.betterEarList;if(isWorseEar){worseEarList[index]=event.target.value;_this.setState({worseEarList:worseEarList});}else{betterEarList[index]=event.target.value;_this.setState({betterEarList:betterEarList});}if(requiredIdx.filter(function(idx){return betterEarList[idx]===\"\";}).length===0&&requiredIdx.filter(function(idx){return worseEarList[idx]===\"\";}).length===0){_this.setState({secondEditable:true});}else{_this.setState({secondEditable:false});}};};_this.validateID=function(id){// TODO(YUE YU): Add after backend is implemented.\nif(id.length>0){return true;}return false;};_this.getWorseEar=function(){console.log(_this.props.context);var leftEarIsWorse=_this.props.context.leftEarIsWorse;_this.setState({currentEar:leftEarIsWorse});};_this.onSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props$context,updateUser,user,loginMode,_this$state2,currentEar,audiologistID,worseEarList,betterEarList,leftEarList,left,rightEarList,right;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props$context=_this.props.context,updateUser=_this$props$context.updateUser,user=_this$props$context.user,loginMode=_this$props$context.loginMode;_this$state2=_this.state,currentEar=_this$state2.currentEar,audiologistID=_this$state2.audiologistID,worseEarList=_this$state2.worseEarList,betterEarList=_this$state2.betterEarList;if(!(loginMode===\"researcher\")){_context.next=4;break;}return _context.abrupt(\"return\");case 4:leftEarList=currentEar===true?worseEarList:betterEarList;left={};rows.forEach(function(value,index){left[value]=leftEarList[index];});rightEarList=currentEar===false?worseEarList:betterEarList;right={};rows.forEach(function(value,index){right[value]=rightEarList[index];});_context.prev=10;_context.next=13;return axios.post(\"/api/listener/addLog\",{listenerID:user,newLog:{PTA:{logOn:new Date().toLocaleString(),audiologistID:audiologistID,right:right,left:left}},flag:\"PTAdone\",flagValue:true});case 13:sessionStorage.setItem(\"PTAdone\",true);updateUser();_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](10);alert(_context.t0.message);case 20:case\"end\":return _context.stop();}}},_callee,null,[[10,17]]);}));return _this;}_createClass(PureTonePage,[{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state3=this.state,audiologistID=_this$state3.audiologistID,firstEditable=_this$state3.firstEditable,secondEditable=_this$state3.secondEditable,worseEarList=_this$state3.worseEarList,betterEarList=_this$state3.betterEarList,currentEar=_this$state3.currentEar;return/*#__PURE__*/React.createElement(Paper,null,/*#__PURE__*/React.createElement(Grid,{container:true,spacing:1},/*#__PURE__*/React.createElement(Grid,{item:true,xs:6,className:classes.grid},/*#__PURE__*/React.createElement(TextField,{label:\"Audiologist ID *\",onChange:this.handleIDChange,value:audiologistID,variant:\"outlined\"})),/*#__PURE__*/React.createElement(Table,{size:\"small\",className:classes.table},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,\"Frequency in Hertz(Hz)\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},currentEar?\"Left Ear(dBspl)\":\"Right Ear(dBspl)\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},currentEar?\"Right Ear(dBspl)\":\"Left Ear(dBspl)\"))),/*#__PURE__*/React.createElement(TableBody,null,rows.map(function(row,rowIndex){return/*#__PURE__*/React.createElement(TableRow,{key:rowIndex},/*#__PURE__*/React.createElement(TableCell,{component:\"th\",scope:\"row\"},requiredIdx.includes(rowIndex)?row+\" *\":row),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},/*#__PURE__*/React.createElement(TextField,{disabled:!firstEditable,onChange:_this2.handleTextChange(true,rowIndex),value:worseEarList[rowIndex],type:\"number\",inputProps:{step:\"5\",style:{textAlign:\"right\"}}})),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},/*#__PURE__*/React.createElement(TextField,{disabled:!firstEditable,onChange:_this2.handleTextChange(false,rowIndex),value:betterEarList[rowIndex],type:\"number\",inputProps:{step:\"5\",style:{textAlign:\"right\"}}})));}))),/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\",justify:\"flex-end\",alignItems:\"center\"},/*#__PURE__*/React.createElement(Button,{className:classes.button,variant:\"contained\",color:\"primary\",onClick:this.onSubmit,component:Link,to:\"/researcherpage\",disabled:!firstEditable||!secondEditable},\"Submit\"))));}}]);return PureTonePage;}(Component);export default compose(withUserAuth,withRouter,withStyles(styles))(PureTonePage);","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/src/pages/BST/pureTonePage.jsx"],"names":["React","Component","withStyles","Paper","Grid","TextField","Table","TableBody","TableCell","TableHead","TableRow","Button","Link","withRouter","compose","withUserAuth","axios","styles","theme","root","flexGrow","grid","marginLeft","marginTop","button","margin","table","rows","requiredIdx","PureTonePage","state","audiologistID","firstEditable","secondEditable","worseEarList","betterEarList","currentEar","componentDidMount","getWorseEar","handleIDChange","event","setState","target","value","validateID","handleTextChange","isWorseEar","index","filter","idx","length","id","console","log","props","context","leftEarIsWorse","onSubmit","updateUser","user","loginMode","leftEarList","left","forEach","rightEarList","right","post","listenerID","newLog","PTA","logOn","Date","toLocaleString","flag","flagValue","sessionStorage","setItem","alert","message","classes","map","row","rowIndex","includes","step","style","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withStyles } from \"@material-ui/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Grid from \"@material-ui/core/Grid\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Button from \"@material-ui/core/Button\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport withUserAuth from \"context/withUserAuth\";\nimport { axios } from \"utils/utils\";\n\nconst styles = (theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  grid: {\n    marginLeft: 30,\n    marginTop: 10,\n  },\n  button: {\n    margin: 10,\n  },\n  table: {\n    margin: 10,\n  },\n});\n\nconst rows = [125, 250, 500, 750, 1000, 1500, 2000, 3000, 4000, 6000, 8000];\nconst requiredIdx = [1, 2, 4, 6, 8];\n\nclass PureTonePage extends Component {\n  state = {\n    audiologistID: \"\",\n    firstEditable: false,\n    secondEditable: false,\n    worseEarList: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n    betterEarList: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n    currentEar: false,\n  };\n\n  componentDidMount = () => {\n    this.getWorseEar();\n  };\n\n  handleIDChange = (event) => {\n    const { firstEditable } = this.state;\n    this.setState({ audiologistID: event.target.value });\n    if (this.validateID(event.target.value) ? !firstEditable : firstEditable) {\n      this.setState({ firstEditable: !firstEditable });\n    }\n  };\n\n  handleTextChange = (isWorseEar, index) => (event) => {\n    const { worseEarList, betterEarList } = this.state;\n    if (isWorseEar) {\n      worseEarList[index] = event.target.value;\n      this.setState({ worseEarList });\n    } else {\n      betterEarList[index] = event.target.value;\n      this.setState({ betterEarList });\n    }\n\n    if (\n      requiredIdx.filter((idx) => betterEarList[idx] === \"\").length === 0 &&\n      requiredIdx.filter((idx) => worseEarList[idx] === \"\").length === 0\n    ) {\n      this.setState({ secondEditable: true });\n    } else {\n      this.setState({ secondEditable: false });\n    }\n  };\n\n  validateID = (id) => {\n    // TODO(YUE YU): Add after backend is implemented.\n    if (id.length > 0) {\n      return true;\n    }\n    return false;\n  };\n\n  getWorseEar = () => {\n    console.log(this.props.context);\n    const { leftEarIsWorse } = this.props.context;\n    this.setState({\n      currentEar: leftEarIsWorse,\n    });\n  };\n\n  onSubmit = async () => {\n    const { updateUser, user, loginMode } = this.props.context;\n    const {\n      currentEar,\n      audiologistID,\n      worseEarList,\n      betterEarList,\n    } = this.state;\n    if (loginMode === \"researcher\") {\n      return;\n    }\n    let leftEarList = currentEar === true ? worseEarList: betterEarList;\n    let left = {};\n    rows.forEach((value, index) => {left[value] = leftEarList[index]});\n    let rightEarList = currentEar === false ? worseEarList: betterEarList;\n    let right = {};\n    rows.forEach((value, index) => {right[value] = rightEarList[index]});\n\n    try {\n      await axios.post(\"/api/listener/addLog\", {\n        listenerID: user,\n        newLog:\n        {\n          PTA: {\n            logOn: new Date().toLocaleString(),\n            audiologistID,\n            right,\n            left,\n          },\n        },\n        flag: \"PTAdone\",\n        flagValue: true,\n      });\n      sessionStorage.setItem(\"PTAdone\", true);\n      updateUser();\n    } catch (error) {\n      alert(error.message);\n    }\n  };\n\n  render() {\n    const { classes } = this.props;\n    const {\n      audiologistID,\n      firstEditable,\n      secondEditable,\n      worseEarList,\n      betterEarList,\n      currentEar,\n    } = this.state;\n\n    return (\n      <Paper>\n        <Grid container spacing={1}>\n          <Grid item xs={6} className={classes.grid}>\n            <TextField\n              label=\"Audiologist ID *\"\n              onChange={this.handleIDChange}\n              value={audiologistID}\n              variant=\"outlined\"\n            />\n          </Grid>\n          <Table size=\"small\" className={classes.table}>\n            <TableHead>\n              <TableRow>\n                <TableCell>Frequency in Hertz(Hz)</TableCell>\n                <TableCell align=\"right\">\n                  {currentEar ? \"Left Ear(dBspl)\" : \"Right Ear(dBspl)\"}\n                </TableCell>\n                <TableCell align=\"right\">\n                  {currentEar ? \"Right Ear(dBspl)\" : \"Left Ear(dBspl)\"}\n                </TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {rows.map((row, rowIndex) => (\n                <TableRow key={rowIndex}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    {requiredIdx.includes(rowIndex) ? row + \" *\" : row}\n                  </TableCell>\n                  <TableCell align=\"right\">\n                    <TextField\n                      disabled={!firstEditable}\n                      onChange={this.handleTextChange(true, rowIndex)}\n                      value={worseEarList[rowIndex]}\n                      type=\"number\"\n                      inputProps={{\n                        step: \"5\",\n                        style: { textAlign: \"right\" },\n                      }}\n                    />\n                  </TableCell>\n                  <TableCell align=\"right\">\n                    <TextField\n                      disabled={!firstEditable}\n                      onChange={this.handleTextChange(false, rowIndex)}\n                      value={betterEarList[rowIndex]}\n                      type=\"number\"\n                      inputProps={{\n                        step: \"5\",\n                        style: { textAlign: \"right\" },\n                      }}\n                    />\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n          <Grid\n            container\n            direction=\"row\"\n            justify=\"flex-end\"\n            alignItems=\"center\"\n          >\n            <Button\n              className={classes.button}\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={this.onSubmit}\n              component={Link}\n              to=\"/researcherpage\"\n              disabled={!firstEditable || !secondEditable}\n            >\n              Submit\n            </Button>\n          </Grid>\n        </Grid>\n      </Paper>\n    );\n  }\n}\n\nexport default compose(\n  withUserAuth,\n  withRouter,\n  withStyles(styles)\n)(PureTonePage);\n"]},"metadata":{},"sourceType":"module"}
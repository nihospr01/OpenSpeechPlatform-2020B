{"ast":null,"code":"import _toConsumableArray from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{axios}from\"utils/utils\";import{withRouter,Link}from\"react-router-dom\";import withUserAuth from\"context/withUserAuth\";import{compose}from\"recompose\";import{withStyles}from\"@material-ui/styles\";import Grid from'@material-ui/core/Grid';import Typography from'@material-ui/core/Typography';import Paper from\"@material-ui/core/Paper\";import Slider from'@material-ui/core/Slider';import Input from'@material-ui/core/Input';import Button from'@material-ui/core/Button';import SettingsIcon from'@material-ui/icons/Settings';import DialogTitle from'@material-ui/core/DialogTitle';import Dialog from'@material-ui/core/Dialog';import Select from'@material-ui/core/Select';import MenuItem from'@material-ui/core/MenuItem';import TextField from'@material-ui/core/TextField';import AudioFilePlayer from\"components/audioFilePlayer\";var styles=function styles(theme){return{root:{flexGrow:1},background:{width:\"100%\",display:'flex',flexDirection:'column',alignItems:'center'},container:{width:\"auto\",display:'flex',flexDirection:'column',alignItems:'center'// padding: 20,\n},iconHover:{float:'right','&:hover':{color:\"grey\"},// alignItems: \"right\",\ncolor:\"inherit\"},sliderLabel:{display:'flex',flexDirection:'row',alignItems:'center',justifyContent:'space-between',width:\"auto\",marginTop:20},sliderRow:{display:'flex',flexDirection:'row',alignItems:'center',justifyContent:'center',width:'auto',minWidth:400},title:{marginTop:40},freqLabel:{width:\"20%\",marginRight:10},inputField:{width:\"20%\",marginLeft:20},bottomButtonArea:{marginTop:30,display:'flex',width:\"100%\",flexDirection:'row',justifyContent:'space-between',alignItmes:'center'},submitButton:{width:200},settingsBar:{display:'flex',flexDirection:'row',justifyContent:'flex-end',width:\"100%\"},settingsWindow:{width:\"100%\",paddingLeft:30,paddingRight:30,paddingBottom:30,display:'flex',flexDirection:'column',justifyContent:'flex-start'},volumeTitle:{display:'flex',flexDirection:'row',justifyContent:'space-between'},saveSettingsButton:{alignSelf:'center'},alertWindow:{width:400,display:'flex',justifyContent:'center',paddingLeft:30,paddingRight:30,paddingBottom:20},switchMsgWindow:{display:'flex',flexDirection:'column',alignItems:'center',padding:20}};};var sixBandFreq=['250','500','1000','2000','4000','8000'];var tenBandFreq=['250','500','750','1000','1500','2000','3000','4000','6000','8000'];// The number of bands the user can set as non-zero values at a time\nvar bandLimit=3;// Marks for alpha sliders\nvar gainSliderMarks=[{value:-20,label:'-20'},{value:10,label:'10'}];var FreppingDemo=/*#__PURE__*/function(_Component){_inherits(FreppingDemo,_Component);var _super=_createSuper(FreppingDemo);function FreppingDemo(props){var _this;_classCallCheck(this,FreppingDemo);_this=_super.call(this,props);// Don't call this.setState() here!\n_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/db/frepingDemo/\");case 3:_context.next=11;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);if(!(_context.t0.response.data==\"table not found\")){_context.next=10;break;}_context.next=10;return axios.post(\"/api/db/table/create/frepingDemo\");case 10:throw _context.t0;case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));_this.updateParam=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var url,paramsResponse,params;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;url=\"/api/db/frepingDemo/\"+(_this.state.tenBand?\"ten_band\":\"six_band\");_context2.next=4;return axios.get(url);case 4:paramsResponse=_context2.sent;// console.log(paramsResponse.data);\nparams=paramsResponse.data;// // Call the server API which returns the HA profile\n// const paramsResponse = await axios.get(\"/api/param/amplification\");\n// console.log(paramsResponse.data);\n// // We are using magic numbers for indice of the current profile in the db.\n// let params;\n// if (this.state.tenBand) {\n//     params = JSON.parse(paramsResponse.data[3].parameters);\n// } else {\n//     params = JSON.parse(paramsResponse.data[4].parameters);\n// }\nconsole.log(params);_this.checkBandLimit(params.left.freping_alpha);_this.setState({freppingAlpha:_toConsumableArray(params.left.freping_alpha),gain:params.left.gain},function(){_this.sendParamsToMHA();_this.resetShouldChangeColor();});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));_this.handleAlertClose=function(){_this.setState({showAlert:false});};_this.handleAlertOpen=function(){_this.setState({showAlert:true});};_this.checkBandLimit=function(arr){var count=0;var i;for(i=0;i<arr.length;i++){if(arr[i]!=0){count++;}}_this.setState({// bandsWarped: count,\nreachedFrepLimit:count>=3?true:false});};_this.handleInputChange=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var idx,value,newValue,tempArray;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// The index of input fields, which represents a particular channel that the\n// user made change to.\nidx=event.target.id;value=event.target.value;// Sanity check of user's input: limit each alpha inside the bound.\nif(value){newValue=Number(value);if(newValue>_this.state.maxAlpha){newValue=_this.state.maxAlpha;}else if(newValue<_this.state.minAlpha){newValue=_this.state.minAlpha;}}else{newValue=0;}// Update the frepping state.\ntempArray=_this.state.freppingAlpha;// const oldAlpha = tempArray[idx];\ntempArray[idx]=newValue;_this.setState(function(prevState){console.log(prevState);// Why is this prevState the same as the new state?\n// this.checkFreppingLimit(oldAlpha, newValue);\n_this.checkBandLimit(tempArray);return{freppingAlpha:tempArray};},function(){_this.sendParamsToMHA();_this.handleColorChange(idx,true);});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref3.apply(this,arguments);};}();_this.handleSliderChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(newValue,index){var tempArray;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:// console.log(newValue);\n// console.log(index);\n// const idx = event.target.id;\ntempArray=_this.state.freppingAlpha;// const oldAlpha = tempArray[idx];\ntempArray[index]=newValue;_this.setState({freppingAlpha:tempArray});case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2,_x3){return _ref4.apply(this,arguments);};}();_this.handleSliderChangeDone=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(newValue,index){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this.checkBandLimit(_this.state.freppingAlpha);_this.sendParamsToMHA();_this.handleColorChange(index,true);case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4,_x5){return _ref5.apply(this,arguments);};}();_this.handleColorChange=function(index,status){var tempArray=_this.state.shouldChangeColor;tempArray[index]=status;_this.setState({shouldChangeColor:tempArray});};_this.resetShouldChangeColor=function(){var i;var tempArray=_this.state.shouldChangeColor;for(i=0;i<tempArray.length;i++){tempArray[i]=false;}_this.setState({shouldChangeColor:tempArray});};_this.onClickSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var params,response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:// Prepare the data\nparams=_this.prepareData();console.log(_this.state.tenBand);console.log(_this.state.freppingAlpha);console.log(params);_this.resetShouldChangeColor();_context6.prev=5;_context6.next=8;return axios.post(\"/api/db/frepingDemo\",{key:_this.state.tenBand?\"ten_band\":\"six_band\",value:JSON.stringify(params)});case 8:response=_context6.sent;console.log(response.data);_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](5);// this.handleAlertOpen();\nconsole.log(_context6.t0.response.data);case 15:case\"end\":return _context6.stop();}}},_callee6,null,[[5,12]]);}));_this.prepareData=function(){var _this$state=_this.state,freppingAlpha=_this$state.freppingAlpha,gain=_this$state.gain;var params={left:{freping:1,freping_alpha:freppingAlpha,gain:gain},right:{freping:1,freping_alpha:freppingAlpha,gain:gain}};return params;};_this.sendParamsToMHA=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var params,response;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:params=_this.prepareData();console.log(params);_context7.prev=2;_context7.next=5;return axios.post(\"/api/param/setparam\",{method:\"set\",data:params});case 5:response=_context7.sent;console.log(response.data);_context7.next=12;break;case 9:_context7.prev=9;_context7.t0=_context7[\"catch\"](2);// this.handleAlertOpen();\nconsole.log(_context7.t0.response.data);case 12:case\"end\":return _context7.stop();}}},_callee7,null,[[2,9]]);}));_this.handleSettingsClose=function(){_this.setState({openSettings:false});// Check whether any alpha value is out of the updated Range\n_this.checkOutOfRange();};_this.handleSettingsClick=function(){_this.setState({openSettings:true});};_this.checkOutOfRange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var temp,i;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:temp=_this.state.freppingAlpha;// Push every alpha into the updated range.\nfor(i=0;i<temp.length;i++){if(temp[i]<_this.state.minAlpha){temp[i]=_this.state.minAlpha;_this.handleColorChange(i,true);}else if(temp[i]>_this.state.maxAlpha){temp[i]=_this.state.maxAlpha;_this.handleColorChange(i,true);}}// this.setState({\n//     freppingAlpha: temp\n// }, this.sendParamsToMHA);\n_this.setState({freppingAlpha:temp},_this.sendParamsToMHA);case 3:case\"end\":return _context8.stop();}}},_callee8);}));_this.handleBandSwitch=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(event){var response;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(event.target.value){_this.setState({freppingAlpha:[0,0,0,0,0,0,0,0,0,0],shouldChangeColor:[false,false,false,false,false,false,false,false,false,false]});}else{_this.setState({freppingAlpha:[0,0,0,0,0,0],shouldChangeColor:[false,false,false,false,false,false]});}_this.setState({tenBand:event.target.value,// bandsWarped: 0,\nreachedFrepLimit:false},function(){_this.updateParam();});// Show the switch msg to the user.\n_this.handleSwitchMsgOpen();_context9.prev=3;_context9.next=6;return axios.post(\"/api/researcher/restartRTMHA\",{data:event.target.value});case 6:response=_context9.sent;console.log(response.data);_context9.next=13;break;case 10:_context9.prev=10;_context9.t0=_context9[\"catch\"](3);console.log(_context9.t0);case 13:case\"end\":return _context9.stop();}}},_callee9,null,[[3,10]]);}));return function(_x6){return _ref9.apply(this,arguments);};}();_this.handleSwitchMsgClose=function(){_this.setState({showBandSwitchMsg:false});};_this.handleSwitchMsgOpen=function(){_this.setState({showBandSwitchMsg:true});};_this.handleGainChange=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(event,newValue){var params,response;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_this.setState({gain:newValue});params={left:{gain:newValue},right:{gain:newValue}};_context10.prev=2;_context10.next=5;return axios.post(\"/api/param/setparam\",{method:\"set\",data:params});case 5:response=_context10.sent;console.log(response.data);_context10.next=13;break;case 9:_context10.prev=9;_context10.t0=_context10[\"catch\"](2);_this.handleAlertOpen();console.log(_context10.t0.response.data);case 13:case\"end\":return _context10.stop();}}},_callee10,null,[[2,9]]);}));return function(_x7,_x8){return _ref10.apply(this,arguments);};}();_this.handleAlphaRangeChange=function(event,newValue){if(newValue[0]>=0||newValue[1]<=0){return;}if(newValue[1]-newValue[0]<0.04){return;}_this.setState({alphaRange:newValue,minAlpha:newValue[0],maxAlpha:newValue[1]});};_this.showDescription=function(){_this.setState({showDes:true});};_this.hideDescription=function(){_this.setState({showDes:false});};_this.state={showAlert:false,freppingAlpha:[0,0,0,0,0,0],// bandsWarped: 0,\nreachedFrepLimit:false,openSettings:false,tenBand:false,gain:0,showBandSwitchMsg:false,minAlpha:-0.5,maxAlpha:0.5,alphaRange:[-0.5,0.5],shouldChangeColor:[false,false,false,false,false,false],showDes:false};return _this;}_createClass(FreppingDemo,[{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state2=this.state,freppingAlpha=_this$state2.freppingAlpha,tenBand=_this$state2.tenBand,gain=_this$state2.gain,showAlert=_this$state2.showAlert,showBandSwitchMsg=_this$state2.showBandSwitchMsg,alphaRange=_this$state2.alphaRange,minAlpha=_this$state2.minAlpha,maxAlpha=_this$state2.maxAlpha,shouldChangeColor=_this$state2.shouldChangeColor,showDes=_this$state2.showDes;var alphaRangeSliderMarks=[{value:alphaRange[0],label:alphaRange[0].toString()},{value:alphaRange[1],label:alphaRange[1].toString()}];var sliderMarks=[{value:0,label:'0'},{value:minAlpha,label:minAlpha.toString()},{value:maxAlpha,label:maxAlpha.toString()}];var gainSliderMarks=[{value:-20,label:'-20'},{value:10,label:'10'},{value:gain,label:gain.toString()}];return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Paper,{className:classes.background},/*#__PURE__*/React.createElement(Dialog,{open:showAlert,onClose:this.handleAlertClose},/*#__PURE__*/React.createElement(DialogTitle,null,\"Error\"),/*#__PURE__*/React.createElement(Grid,{container:true,className:classes.alertWindow},/*#__PURE__*/React.createElement(Typography,null,\"RT-MHA is not running. Please make sure RT-MHA is running before fetching or sending parameters\"),/*#__PURE__*/React.createElement(Button,{onClick:this.handleAlertClose,color:\"primary\",variant:\"contained\"},\"OK\"))),/*#__PURE__*/React.createElement(\"div\",{className:classes.settingsBar},/*#__PURE__*/React.createElement(SettingsIcon,{className:classes.iconHover,fontSize:\"large\",onClick:this.handleSettingsClick})),/*#__PURE__*/React.createElement(Dialog,{open:this.state.openSettings,onClose:this.handleSettingsClose},/*#__PURE__*/React.createElement(DialogTitle,null,\"Settings\"),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3,className:classes.settingsWindow},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,null,\"Select the number of bands of your device\"),/*#__PURE__*/React.createElement(Select,{value:tenBand,onChange:this.handleBandSwitch},/*#__PURE__*/React.createElement(MenuItem,{value:false},\"Six Band\"),/*#__PURE__*/React.createElement(MenuItem,{value:true},\"Ten Band\")),/*#__PURE__*/React.createElement(Dialog,{open:showBandSwitchMsg,onClose:this.handleSwitchMsgClose},/*#__PURE__*/React.createElement(Grid,{container:true,className:classes.switchMsgWindow},/*#__PURE__*/React.createElement(Typography,{style:{marginBottom:10}},\"Successfully switched to the \",tenBand?\"ten band\":\"six band\",\" mode\"),/*#__PURE__*/React.createElement(Button,{onClick:this.handleSwitchMsgClose,color:\"primary\",variant:\"contained\"},\"OK\")))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,null,\"Adjust the range of Alpha (the span shouldn't be smaller than 0.2)\"),/*#__PURE__*/React.createElement(Slider,{min:-0.5,max:0.5,value:alphaRange,step:0.01,onChange:this.handleAlphaRangeChange,marks:alphaRangeSliderMarks})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{className:classes.volumeTitle},/*#__PURE__*/React.createElement(Typography,null,\"Volume\"),/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:this.updateParam},\"Load Saved Volume\")),/*#__PURE__*/React.createElement(Slider,{min:-20,max:10,step:1,defaultValue:0,valueLabelDisplay:\"auto\",value:gain,onChange:this.handleGainChange,marks:gainSliderMarks})),/*#__PURE__*/React.createElement(Grid,{item:true,className:classes.saveSettingsButton},/*#__PURE__*/React.createElement(Button,{color:\"primary\",variant:\"contained\",onClick:this.handleSettingsClose},\"Done\")))),/*#__PURE__*/React.createElement(AudioFilePlayer,null),/*#__PURE__*/React.createElement(Grid,{container:true,className:classes.container,spacing:3},/*#__PURE__*/React.createElement(Typography,{className:classes.title},\"Alpha for different frequencies\"),/*#__PURE__*/React.createElement(Typography,null,\"You can warp up to 3 bands at a time.\"),/*#__PURE__*/React.createElement(Grid,{item:true,className:classes.sliderLabel},/*#__PURE__*/React.createElement(Typography,null,\"Compression\"),/*#__PURE__*/React.createElement(Typography,null,\"Expansion\")),(tenBand?tenBandFreq:sixBandFreq).map(function(currAlpha,index){return/*#__PURE__*/React.createElement(Grid,{item:true,className:classes.sliderRow},/*#__PURE__*/React.createElement(Typography,{className:classes.freqLabel,color:shouldChangeColor[index]?\"secondary\":\"primary\"},currAlpha+\" Hz\"),/*#__PURE__*/React.createElement(Slider// id={index}\n,{min:minAlpha,max:maxAlpha,step:0.01,defaultValue:0,value:freppingAlpha[index],onChange:function onChange(event,value){return _this2.handleSliderChange(value,index);},onChangeCommitted:function onChangeCommitted(event,value){return _this2.handleSliderChangeDone(value,index);},valueLabelDisplay:\"auto\",track:false,disabled:_this2.state.reachedFrepLimit&&freppingAlpha[index]===0,marks:sliderMarks,color:shouldChangeColor[index]?\"secondary\":\"primary\"}),/*#__PURE__*/React.createElement(TextField,{className:classes.inputField,margin:\"dense\",value:freppingAlpha[index],id:index,onChange:_this2.handleInputChange,inputProps:{step:0.01,// min: -minAlpha,\n// max: maxAlpha,\ntype:'number'// 'aria-labelledby': 'input-slider',\n},disabled:_this2.state.reachedFrepLimit&&freppingAlpha[index]===0,color:shouldChangeColor[index]?\"secondary\":\"primary\"// error={freppingAlpha[index]>0.5||freppingAlpha[index]<-0.5}\n// helperText=\"Entry.\"\n}));}),/*#__PURE__*/React.createElement(Grid,{item:true,className:classes.bottomButtonArea},/*#__PURE__*/React.createElement(Button,{className:classes.submitButton,variant:\"contained\",color:\"primary\",onClick:this.onClickSubmit},\"Save Parameters\"),/*#__PURE__*/React.createElement(Button,{className:classes.submitButton,variant:\"contained\",color:\"primary\",onClick:this.updateParam},\"Load Last Saved Parameters\")))));}}]);return FreppingDemo;}(Component);export default compose(withUserAuth,withRouter,withStyles(styles))(FreppingDemo);","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/src/pages/demo/freppingDemo.jsx"],"names":["React","Component","axios","withRouter","Link","withUserAuth","compose","withStyles","Grid","Typography","Paper","Slider","Input","Button","SettingsIcon","DialogTitle","Dialog","Select","MenuItem","TextField","AudioFilePlayer","styles","theme","root","flexGrow","background","width","display","flexDirection","alignItems","container","iconHover","float","color","sliderLabel","justifyContent","marginTop","sliderRow","minWidth","title","freqLabel","marginRight","inputField","marginLeft","bottomButtonArea","alignItmes","submitButton","settingsBar","settingsWindow","paddingLeft","paddingRight","paddingBottom","volumeTitle","saveSettingsButton","alignSelf","alertWindow","switchMsgWindow","padding","sixBandFreq","tenBandFreq","bandLimit","gainSliderMarks","value","label","FreppingDemo","props","componentDidMount","get","response","data","post","updateParam","url","state","tenBand","paramsResponse","params","console","log","checkBandLimit","left","freping_alpha","setState","freppingAlpha","gain","sendParamsToMHA","resetShouldChangeColor","handleAlertClose","showAlert","handleAlertOpen","arr","count","i","length","reachedFrepLimit","handleInputChange","event","idx","target","id","newValue","Number","maxAlpha","minAlpha","tempArray","prevState","handleColorChange","handleSliderChange","index","handleSliderChangeDone","status","shouldChangeColor","onClickSubmit","prepareData","key","JSON","stringify","freping","right","method","handleSettingsClose","openSettings","checkOutOfRange","handleSettingsClick","temp","handleBandSwitch","handleSwitchMsgOpen","handleSwitchMsgClose","showBandSwitchMsg","handleGainChange","handleAlphaRangeChange","alphaRange","showDescription","showDes","hideDescription","classes","alphaRangeSliderMarks","toString","sliderMarks","marginBottom","map","currAlpha","step","type"],"mappings":"grCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,KAAT,KAAsB,aAAtB,CACA,OAASC,UAAT,CAAqBC,IAArB,KAAiC,kBAAjC,CACA,MAAOC,CAAAA,YAAP,KAAyB,sBAAzB,CACA,OAASC,OAAT,KAAwB,WAAxB,CACA,OAASC,UAAT,KAA2B,qBAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,6BAAzB,CACA,MAAOC,CAAAA,WAAP,KAAwB,+BAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,4BAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,6BAAtB,CAEA,MAAOC,CAAAA,eAAP,KAA4B,4BAA5B,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,QAAY,CACvBC,IAAI,CAAE,CACFC,QAAQ,CAAE,CADR,CADiB,CAIvBC,UAAU,CAAE,CACRC,KAAK,CAAE,MADC,CAERC,OAAO,CAAE,MAFD,CAGRC,aAAa,CAAE,QAHP,CAIRC,UAAU,CAAE,QAJJ,CAJW,CAWvBC,SAAS,CAAE,CACPJ,KAAK,CAAE,MADA,CAEPC,OAAO,CAAE,MAFF,CAGPC,aAAa,CAAE,QAHR,CAIPC,UAAU,CAAE,QACZ;AALO,CAXY,CAkBvBE,SAAS,CAAE,CACPC,KAAK,CAAE,OADA,CAEP,UAAW,CACTC,KAAK,CAAE,MADE,CAFJ,CAKP;AACAA,KAAK,CAAE,SANA,CAlBY,CA0BvBC,WAAW,CAAE,CACTP,OAAO,CAAE,MADA,CAETC,aAAa,CAAE,KAFN,CAGTC,UAAU,CAAE,QAHH,CAITM,cAAc,CAAE,eAJP,CAKTT,KAAK,CAAE,MALE,CAMTU,SAAS,CAAE,EANF,CA1BU,CAkCvBC,SAAS,CAAE,CACPV,OAAO,CAAE,MADF,CAEPC,aAAa,CAAE,KAFR,CAGPC,UAAU,CAAE,QAHL,CAIPM,cAAc,CAAE,QAJT,CAKPT,KAAK,CAAE,MALA,CAMPY,QAAQ,CAAE,GANH,CAlCY,CA0CvBC,KAAK,CAAE,CACHH,SAAS,CAAE,EADR,CA1CgB,CA6CvBI,SAAS,CAAE,CACPd,KAAK,CAAE,KADA,CAEPe,WAAW,CAAE,EAFN,CA7CY,CAiDvBC,UAAU,CAAE,CACRhB,KAAK,CAAE,KADC,CAERiB,UAAU,CAAE,EAFJ,CAjDW,CAqDvBC,gBAAgB,CAAE,CACdR,SAAS,CAAE,EADG,CAEdT,OAAO,CAAE,MAFK,CAGdD,KAAK,CAAE,MAHO,CAIdE,aAAa,CAAE,KAJD,CAKdO,cAAc,CAAE,eALF,CAMdU,UAAU,CAAE,QANE,CArDK,CA6DvBC,YAAY,CAAE,CACVpB,KAAK,CAAE,GADG,CA7DS,CAgEvBqB,WAAW,CAAE,CACTpB,OAAO,CAAE,MADA,CAETC,aAAa,CAAE,KAFN,CAGTO,cAAc,CAAE,UAHP,CAITT,KAAK,CAAE,MAJE,CAhEU,CAsEvBsB,cAAc,CAAE,CACZtB,KAAK,CAAE,MADK,CAEZuB,WAAW,CAAE,EAFD,CAGZC,YAAY,CAAE,EAHF,CAIZC,aAAa,CAAE,EAJH,CAKZxB,OAAO,CAAE,MALG,CAMZC,aAAa,CAAE,QANH,CAOZO,cAAc,CAAE,YAPJ,CAtEO,CA+EvBiB,WAAW,CAAE,CACTzB,OAAO,CAAE,MADA,CAETC,aAAa,CAAE,KAFN,CAGTO,cAAc,CAAE,eAHP,CA/EU,CAoFvBkB,kBAAkB,CAAE,CAChBC,SAAS,CAAE,QADK,CApFG,CAuFvBC,WAAW,CAAE,CACT7B,KAAK,CAAE,GADE,CAETC,OAAO,CAAE,MAFA,CAGTQ,cAAc,CAAE,QAHP,CAITc,WAAW,CAAE,EAJJ,CAKTC,YAAY,CAAE,EALL,CAMTC,aAAa,CAAE,EANN,CAvFU,CA+FvBK,eAAe,CAAE,CACb7B,OAAO,CAAE,MADI,CAEbC,aAAa,CAAE,QAFF,CAGbC,UAAU,CAAE,QAHC,CAIb4B,OAAO,CAAE,EAJI,CA/FM,CAAZ,EAAf,CAuGA,GAAMC,CAAAA,WAAW,CAAG,CAAC,KAAD,CAAQ,KAAR,CAAe,MAAf,CAAuB,MAAvB,CAA+B,MAA/B,CAAuC,MAAvC,CAApB,CACA,GAAMC,CAAAA,WAAW,CAAG,CAAC,KAAD,CAAQ,KAAR,CAAe,KAAf,CAAsB,MAAtB,CAA8B,MAA9B,CAAsC,MAAtC,CAA8C,MAA9C,CAAsD,MAAtD,CAA8D,MAA9D,CAAsE,MAAtE,CAApB,CACA;AACA,GAAMC,CAAAA,SAAS,CAAG,CAAlB,CACA;AACA,GAAMC,CAAAA,eAAe,CAAG,CAAC,CAACC,KAAK,CAAE,CAAC,EAAT,CAAaC,KAAK,CAAE,KAApB,CAAD,CAA6B,CAACD,KAAK,CAAE,EAAR,CAAYC,KAAK,CAAE,IAAnB,CAA7B,CAAxB,C,GAEMC,CAAAA,Y,4GACF,sBAAYC,KAAZ,CAAmB,8CACf,uBAAMA,KAAN,EACA;AAFe,MAoBnBC,iBApBmB,sEAoBC,yKAENhE,CAAAA,KAAK,CAACiE,GAAN,CAAU,sBAAV,CAFM,4FAKR,YAAMC,QAAN,CAAeC,IAAf,EAAuB,iBALf,kDAMFnE,CAAAA,KAAK,CAACoE,IAAN,CAAW,kCAAX,CANE,+FApBD,SAmCnBC,WAnCmB,sEAmCL,uLAEFC,GAFE,CAEI,wBAA0B,MAAKC,KAAL,CAAWC,OAAX,CAAqB,UAArB,CAAkC,UAA5D,CAFJ,wBAGuBxE,CAAAA,KAAK,CAACiE,GAAN,CAAUK,GAAV,CAHvB,QAGAG,cAHA,gBAIN;AACIC,MALE,CAKOD,cAAc,CAACN,IALtB,CAQN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAQ,OAAO,CAACC,GAAR,CAAYF,MAAZ,EACA,MAAKG,cAAL,CAAoBH,MAAM,CAACI,IAAP,CAAYC,aAAhC,EACA,MAAKC,QAAL,CAAc,CACVC,aAAa,oBAAMP,MAAM,CAACI,IAAP,CAAYC,aAAlB,CADH,CAEVG,IAAI,CAAER,MAAM,CAACI,IAAP,CAAYI,IAFR,CAAd,CAGG,UAAM,CACL,MAAKC,eAAL,GACA,MAAKC,sBAAL,GACH,CAND,EArBM,+KAnCK,SA2EnBC,gBA3EmB,CA2EA,UAAM,CACrB,MAAKL,QAAL,CAAc,CAACM,SAAS,CAAE,KAAZ,CAAd,EACH,CA7EkB,OAkFnBC,eAlFmB,CAkFD,UAAM,CACpB,MAAKP,QAAL,CAAc,CAACM,SAAS,CAAE,IAAZ,CAAd,EACH,CApFkB,OAyFnBT,cAzFmB,CAyFF,SAACW,GAAD,CAAS,CACtB,GAAIC,CAAAA,KAAK,CAAG,CAAZ,CACA,GAAIC,CAAAA,CAAJ,CACA,IAAKA,CAAC,CAAG,CAAT,CAAYA,CAAC,CAAGF,GAAG,CAACG,MAApB,CAA4BD,CAAC,EAA7B,CAAiC,CAC7B,GAAIF,GAAG,CAACE,CAAD,CAAH,EAAU,CAAd,CAAiB,CACbD,KAAK,GACR,CACJ,CACD,MAAKT,QAAL,CAAc,CACV;AACAY,gBAAgB,CAAEH,KAAK,EAAI,CAAT,CAAa,IAAb,CAAoB,KAF5B,CAAd,EAIH,CArGkB,OA4GnBI,iBA5GmB,2FA4GC,kBAAOC,KAAP,uJAChB;AACA;AACMC,GAHU,CAGJD,KAAK,CAACE,MAAN,CAAaC,EAHT,CAIVrC,KAJU,CAIFkC,KAAK,CAACE,MAAN,CAAapC,KAJX,CAMhB;AACA,GAAIA,KAAJ,CAAW,CACPsC,QAAQ,CAAGC,MAAM,CAACvC,KAAD,CAAjB,CACA,GAAIsC,QAAQ,CAAG,MAAK3B,KAAL,CAAW6B,QAA1B,CAAoC,CAChCF,QAAQ,CAAG,MAAK3B,KAAL,CAAW6B,QAAtB,CACH,CAFD,IAEO,IAAIF,QAAQ,CAAG,MAAK3B,KAAL,CAAW8B,QAA1B,CAAoC,CACvCH,QAAQ,CAAG,MAAK3B,KAAL,CAAW8B,QAAtB,CACH,CACJ,CAPD,IAOO,CACHH,QAAQ,CAAG,CAAX,CACH,CAED;AACII,SAnBY,CAmBA,MAAK/B,KAAL,CAAWU,aAnBX,CAoBhB;AACAqB,SAAS,CAACP,GAAD,CAAT,CAAiBG,QAAjB,CACA,MAAKlB,QAAL,CAAc,SAACuB,SAAD,CAAe,CACzB5B,OAAO,CAACC,GAAR,CAAY2B,SAAZ,EAA2B;AAC3B;AACA,MAAK1B,cAAL,CAAoByB,SAApB,EACA,MAAO,CAACrB,aAAa,CAAEqB,SAAhB,CAAP,CACH,CALD,CAKG,UAAM,CACL,MAAKnB,eAAL,GACA,MAAKqB,iBAAL,CAAuBT,GAAvB,CAA4B,IAA5B,EACH,CARD,EAtBgB,wDA5GD,sEAkJnBU,kBAlJmB,2FAkJE,kBAAOP,QAAP,CAAiBQ,KAAjB,oIACjB;AACA;AACA;AACIJ,SAJa,CAID,MAAK/B,KAAL,CAAWU,aAJV,CAKjB;AACAqB,SAAS,CAACI,KAAD,CAAT,CAAmBR,QAAnB,CACA,MAAKlB,QAAL,CAAc,CAACC,aAAa,CAAEqB,SAAhB,CAAd,EAPiB,wDAlJF,2EA4JnBK,sBA5JmB,2FA4JM,kBAAOT,QAAP,CAAiBQ,KAAjB,sHACrB,MAAK7B,cAAL,CAAoB,MAAKN,KAAL,CAAWU,aAA/B,EACA,MAAKE,eAAL,GACA,MAAKqB,iBAAL,CAAuBE,KAAvB,CAA8B,IAA9B,EAHqB,wDA5JN,2EAyKnBF,iBAzKmB,CAyKC,SAACE,KAAD,CAAQE,MAAR,CAAmB,CACnC,GAAIN,CAAAA,SAAS,CAAG,MAAK/B,KAAL,CAAWsC,iBAA3B,CACAP,SAAS,CAACI,KAAD,CAAT,CAAmBE,MAAnB,CACA,MAAK5B,QAAL,CAAc,CACV6B,iBAAiB,CAAEP,SADT,CAAd,EAGH,CA/KkB,OA+MnBlB,sBA/MmB,CA+MM,UAAM,CAC3B,GAAIM,CAAAA,CAAJ,CACA,GAAIY,CAAAA,SAAS,CAAG,MAAK/B,KAAL,CAAWsC,iBAA3B,CACA,IAAKnB,CAAC,CAAG,CAAT,CAAYA,CAAC,CAAGY,SAAS,CAACX,MAA1B,CAAkCD,CAAC,EAAnC,CAAuC,CACnCY,SAAS,CAACZ,CAAD,CAAT,CAAe,KAAf,CACH,CACD,MAAKV,QAAL,CAAc,CACV6B,iBAAiB,CAAEP,SADT,CAAd,EAGH,CAxNkB,OA8NnBQ,aA9NmB,sEA8NH,4JACZ;AACMpC,MAFM,CAEG,MAAKqC,WAAL,EAFH,CAGZpC,OAAO,CAACC,GAAR,CAAY,MAAKL,KAAL,CAAWC,OAAvB,EACAG,OAAO,CAACC,GAAR,CAAY,MAAKL,KAAL,CAAWU,aAAvB,EACAN,OAAO,CAACC,GAAR,CAAYF,MAAZ,EAEA,MAAKU,sBAAL,GAPY,wCAWepF,CAAAA,KAAK,CAACoE,IAAN,CAAW,qBAAX,CAAkC,CACrD4C,GAAG,CAAE,MAAKzC,KAAL,CAAWC,OAAX,CAAqB,UAArB,CAAkC,UADc,CAErDZ,KAAK,CAAEqD,IAAI,CAACC,SAAL,CAAexC,MAAf,CAF8C,CAAlC,CAXf,QAWFR,QAXE,gBAeRS,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACC,IAArB,EAfQ,qFAiBR;AACAQ,OAAO,CAACC,GAAR,CAAY,aAAMV,QAAN,CAAeC,IAA3B,EAlBQ,uEA9NG,SAoPnB4C,WApPmB,CAoPL,UAAM,iBACc,MAAKxC,KADnB,CACTU,aADS,aACTA,aADS,CACMC,IADN,aACMA,IADN,CAEhB,GAAMR,CAAAA,MAAM,CAAG,CACXI,IAAI,CAAE,CACFqC,OAAO,CAAE,CADP,CAEFpC,aAAa,CAAEE,aAFb,CAGFC,IAAI,CAAEA,IAHJ,CADK,CAMXkC,KAAK,CAAE,CACHD,OAAO,CAAE,CADN,CAEHpC,aAAa,CAAEE,aAFZ,CAGHC,IAAI,CAAEA,IAHH,CANI,CAAf,CAYA,MAAOR,CAAAA,MAAP,CACH,CAnQkB,OAqQnBS,eArQmB,sEAqQD,4JACRT,MADQ,CACC,MAAKqC,WAAL,EADD,CAEdpC,OAAO,CAACC,GAAR,CAAYF,MAAZ,EAFc,wCAKa1E,CAAAA,KAAK,CAACoE,IAAN,CAAW,qBAAX,CAAkC,CACrDiD,MAAM,CAAE,KAD6C,CAErDlD,IAAI,CAAEO,MAF+C,CAAlC,CALb,QAKJR,QALI,gBASVS,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACC,IAArB,EATU,mFAWV;AACAQ,OAAO,CAACC,GAAR,CAAY,aAAMV,QAAN,CAAeC,IAA3B,EAZU,sEArQC,SAwRnBmD,mBAxRmB,CAwRG,UAAM,CACxB,MAAKtC,QAAL,CAAc,CACVuC,YAAY,CAAE,KADJ,CAAd,EAIA;AACA,MAAKC,eAAL,GACH,CA/RkB,OAoSnBC,mBApSmB,CAoSG,UAAM,CACxB,MAAKzC,QAAL,CAAc,CACVuC,YAAY,CAAE,IADJ,CAAd,EAGH,CAxSkB,OA8SnBC,eA9SmB,sEA8SD,mJACVE,IADU,CACH,MAAKnD,KAAL,CAAWU,aADR,CAGd;AACA,IAAKS,CAAC,CAAG,CAAT,CAAYA,CAAC,CAAGgC,IAAI,CAAC/B,MAArB,CAA6BD,CAAC,EAA9B,CAAkC,CAC9B,GAAIgC,IAAI,CAAChC,CAAD,CAAJ,CAAU,MAAKnB,KAAL,CAAW8B,QAAzB,CAAmC,CAC/BqB,IAAI,CAAChC,CAAD,CAAJ,CAAU,MAAKnB,KAAL,CAAW8B,QAArB,CACA,MAAKG,iBAAL,CAAuBd,CAAvB,CAA0B,IAA1B,EACH,CAHD,IAGO,IAAIgC,IAAI,CAAChC,CAAD,CAAJ,CAAU,MAAKnB,KAAL,CAAW6B,QAAzB,CAAmC,CACtCsB,IAAI,CAAChC,CAAD,CAAJ,CAAU,MAAKnB,KAAL,CAAW6B,QAArB,CACA,MAAKI,iBAAL,CAAuBd,CAAvB,CAA0B,IAA1B,EACH,CACJ,CACD;AACA;AACA;AACA,MAAKV,QAAL,CAAc,CACVC,aAAa,CAAEyC,IADL,CAAd,CAEG,MAAKvC,eAFR,EAhBc,wDA9SC,SAwUnBwC,gBAxUmB,2FAwUA,kBAAO7B,KAAP,mIACf,GAAIA,KAAK,CAACE,MAAN,CAAapC,KAAjB,CAAwB,CACpB,MAAKoB,QAAL,CAAc,CACVC,aAAa,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAAmB,CAAnB,CAAsB,CAAtB,CAAyB,CAAzB,CAA4B,CAA5B,CADL,CAEV4B,iBAAiB,CAAE,CAAC,KAAD,CAAQ,KAAR,CAAe,KAAf,CAAsB,KAAtB,CAA6B,KAA7B,CAAoC,KAApC,CAA2C,KAA3C,CAAkD,KAAlD,CAAyD,KAAzD,CAAgE,KAAhE,CAFT,CAAd,EAIH,CALD,IAKO,CACH,MAAK7B,QAAL,CAAc,CACVC,aAAa,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CADL,CAEV4B,iBAAiB,CAAE,CAAC,KAAD,CAAQ,KAAR,CAAe,KAAf,CAAsB,KAAtB,CAA6B,KAA7B,CAAoC,KAApC,CAFT,CAAd,EAIH,CAED,MAAK7B,QAAL,CAAc,CACVR,OAAO,CAAEsB,KAAK,CAACE,MAAN,CAAapC,KADZ,CAEV;AACAgC,gBAAgB,CAAE,KAHR,CAAd,CAIG,UAAI,CACH,MAAKvB,WAAL,GACH,CAND,EAQA;AACA,MAAKuD,mBAAL,GAtBe,wCAyBY5H,CAAAA,KAAK,CAACoE,IAAN,CAAW,8BAAX,CAA2C,CAACD,IAAI,CAAE2B,KAAK,CAACE,MAAN,CAAapC,KAApB,CAA3C,CAzBZ,QAyBLM,QAzBK,gBA0BXS,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACC,IAArB,EA1BW,qFA4BXQ,OAAO,CAACC,GAAR,eA5BW,uEAxUA,uEA2WnBiD,oBA3WmB,CA2WI,UAAM,CACzB,MAAK7C,QAAL,CAAc,CACV8C,iBAAiB,CAAE,KADT,CAAd,EAGH,CA/WkB,OAoXnBF,mBApXmB,CAoXG,UAAM,CACxB,MAAK5C,QAAL,CAAc,CACV8C,iBAAiB,CAAE,IADT,CAAd,EAGH,CAxXkB,OA+XnBC,gBA/XmB,4FA+XA,mBAAOjC,KAAP,CAAcI,QAAd,8IACf,MAAKlB,QAAL,CAAc,CACVE,IAAI,CAAEgB,QADI,CAAd,EAIMxB,MALS,CAKA,CACXI,IAAI,CAAE,CACFI,IAAI,CAAEgB,QADJ,CADK,CAIXkB,KAAK,CAAE,CACHlC,IAAI,CAAEgB,QADH,CAJI,CALA,2CAeYlG,CAAAA,KAAK,CAACoE,IAAN,CAAW,qBAAX,CAAkC,CACrDiD,MAAM,CAAE,KAD6C,CAErDlD,IAAI,CAAEO,MAF+C,CAAlC,CAfZ,QAeLR,QAfK,iBAmBXS,OAAO,CAACC,GAAR,CAAYV,QAAQ,CAACC,IAArB,EAnBW,uFAqBX,MAAKoB,eAAL,GACAZ,OAAO,CAACC,GAAR,CAAY,cAAMV,QAAN,CAAeC,IAA3B,EAtBW,wEA/XA,4EAganB6D,sBAhamB,CAgaM,SAAClC,KAAD,CAAQI,QAAR,CAAqB,CAC1C,GAAIA,QAAQ,CAAC,CAAD,CAAR,EAAe,CAAf,EAAoBA,QAAQ,CAAC,CAAD,CAAR,EAAe,CAAvC,CAA0C,CACtC,OACH,CACD,GAAIA,QAAQ,CAAC,CAAD,CAAR,CAAcA,QAAQ,CAAC,CAAD,CAAtB,CAA4B,IAAhC,CAAsC,CAClC,OACH,CACD,MAAKlB,QAAL,CAAc,CACViD,UAAU,CAAE/B,QADF,CAEVG,QAAQ,CAAEH,QAAQ,CAAC,CAAD,CAFR,CAGVE,QAAQ,CAAEF,QAAQ,CAAC,CAAD,CAHR,CAAd,EAKH,CA5akB,OA8anBgC,eA9amB,CA8aD,UAAM,CACpB,MAAKlD,QAAL,CAAc,CACVmD,OAAO,CAAE,IADC,CAAd,EAGH,CAlbkB,OAobnBC,eApbmB,CAobD,UAAM,CACpB,MAAKpD,QAAL,CAAc,CACVmD,OAAO,CAAE,KADC,CAAd,EAGH,CAxbkB,CAGf,MAAK5D,KAAL,CAAa,CACTe,SAAS,CAAE,KADF,CAETL,aAAa,CAAE,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAFN,CAGT;AACAW,gBAAgB,CAAE,KAJT,CAKT2B,YAAY,CAAE,KALL,CAMT/C,OAAO,CAAE,KANA,CAOTU,IAAI,CAAE,CAPG,CAQT4C,iBAAiB,CAAE,KARV,CASTzB,QAAQ,CAAE,CAAC,GATF,CAUTD,QAAQ,CAAE,GAVD,CAWT6B,UAAU,CAAE,CAAC,CAAC,GAAF,CAAO,GAAP,CAXH,CAYTpB,iBAAiB,CAAE,CAAC,KAAD,CAAQ,KAAR,CAAe,KAAf,CAAsB,KAAtB,CAA6B,KAA7B,CAAoC,KAApC,CAZV,CAaTsB,OAAO,CAAE,KAbA,CAAb,CAHe,aAkBhB,C,gEAwaM,oBACGE,CAAAA,OADH,CACe,KAAKtE,KADpB,CACGsE,OADH,kBAGsD,KAAK9D,KAH3D,CAEGU,aAFH,cAEGA,aAFH,CAEkBT,OAFlB,cAEkBA,OAFlB,CAE2BU,IAF3B,cAE2BA,IAF3B,CAEiCI,SAFjC,cAEiCA,SAFjC,CAE4CwC,iBAF5C,cAE4CA,iBAF5C,CAE+DG,UAF/D,cAE+DA,UAF/D,CAGG5B,QAHH,cAGGA,QAHH,CAGaD,QAHb,cAGaA,QAHb,CAGuBS,iBAHvB,cAGuBA,iBAHvB,CAG0CsB,OAH1C,cAG0CA,OAH1C,CAIL,GAAIG,CAAAA,qBAAqB,CAAG,CACxB,CAAC1E,KAAK,CAAEqE,UAAU,CAAC,CAAD,CAAlB,CAAuBpE,KAAK,CAAEoE,UAAU,CAAC,CAAD,CAAV,CAAcM,QAAd,EAA9B,CADwB,CAExB,CAAC3E,KAAK,CAAEqE,UAAU,CAAC,CAAD,CAAlB,CAAuBpE,KAAK,CAAEoE,UAAU,CAAC,CAAD,CAAV,CAAcM,QAAd,EAA9B,CAFwB,CAA5B,CAIA,GAAIC,CAAAA,WAAW,CAAG,CACd,CAAC5E,KAAK,CAAE,CAAR,CAAWC,KAAK,CAAE,GAAlB,CADc,CAEd,CAACD,KAAK,CAAEyC,QAAR,CAAkBxC,KAAK,CAAEwC,QAAQ,CAACkC,QAAT,EAAzB,CAFc,CAGd,CAAC3E,KAAK,CAAEwC,QAAR,CAAkBvC,KAAK,CAAEuC,QAAQ,CAACmC,QAAT,EAAzB,CAHc,CAAlB,CAKA,GAAI5E,CAAAA,eAAe,CAAG,CAClB,CAACC,KAAK,CAAE,CAAC,EAAT,CAAaC,KAAK,CAAE,KAApB,CADkB,CAElB,CAACD,KAAK,CAAE,EAAR,CAAYC,KAAK,CAAE,IAAnB,CAFkB,CAGlB,CAACD,KAAK,CAAEsB,IAAR,CAAcrB,KAAK,CAAEqB,IAAI,CAACqD,QAAL,EAArB,CAHkB,CAAtB,CAMA,mBACI,2BAAK,SAAS,CAAEF,OAAO,CAAChH,IAAxB,eACI,oBAAC,KAAD,EAAO,SAAS,CAAEgH,OAAO,CAAC9G,UAA1B,eACI,oBAAC,MAAD,EAAQ,IAAI,CAAE+D,SAAd,CAAyB,OAAO,CAAE,KAAKD,gBAAvC,eACI,oBAAC,WAAD,cADJ,cAEI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAEgD,OAAO,CAAChF,WAAnC,eACI,oBAAC,UAAD,wGADJ,cAEI,oBAAC,MAAD,EAAQ,OAAO,CAAE,KAAKgC,gBAAtB,CAAwC,KAAK,CAAC,SAA9C,CAAwD,OAAO,CAAC,WAAhE,OAFJ,CAFJ,CADJ,cASI,2BAAK,SAAS,CAAEgD,OAAO,CAACxF,WAAxB,eACI,oBAAC,YAAD,EAAc,SAAS,CAAEwF,OAAO,CAACxG,SAAjC,CAA4C,QAAQ,CAAC,OAArD,CAA6D,OAAO,CAAE,KAAK4F,mBAA3E,EADJ,CATJ,cAaI,oBAAC,MAAD,EAAQ,IAAI,CAAE,KAAKlD,KAAL,CAAWgD,YAAzB,CAAuC,OAAO,CAAE,KAAKD,mBAArD,eACI,oBAAC,WAAD,iBADJ,cAEI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,CAA6B,SAAS,CAAEe,OAAO,CAACvF,cAAhD,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,UAAD,kDADJ,cAEI,oBAAC,MAAD,EACI,KAAK,CAAE0B,OADX,CAEI,QAAQ,CAAE,KAAKmD,gBAFnB,eAII,oBAAC,QAAD,EAAU,KAAK,CAAE,KAAjB,aAJJ,cAKI,oBAAC,QAAD,EAAU,KAAK,CAAE,IAAjB,aALJ,CAFJ,cASI,oBAAC,MAAD,EAAQ,IAAI,CAAEG,iBAAd,CAAiC,OAAO,CAAE,KAAKD,oBAA/C,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAEQ,OAAO,CAAC/E,eAAnC,eACI,oBAAC,UAAD,EAAY,KAAK,CAAE,CAACmF,YAAY,CAAE,EAAf,CAAnB,kCACkCjE,OAAO,CAAG,UAAH,CAAgB,UADzD,SADJ,cAII,oBAAC,MAAD,EAAQ,OAAO,CAAE,KAAKqD,oBAAtB,CAA4C,KAAK,CAAC,SAAlD,CAA4D,OAAO,CAAC,WAApE,OAJJ,CADJ,CATJ,CADJ,cAoBI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,UAAD,2EADJ,cAEI,oBAAC,MAAD,EACI,GAAG,CAAE,CAAC,GADV,CAEI,GAAG,CAAE,GAFT,CAGI,KAAK,CAAEI,UAHX,CAII,IAAI,CAAE,IAJV,CAKI,QAAQ,CAAE,KAAKD,sBALnB,CAMI,KAAK,CAAEM,qBANX,EAFJ,CApBJ,cAgCI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,CAAED,OAAO,CAACnF,WAAzB,eACI,oBAAC,UAAD,eADJ,cAEI,oBAAC,MAAD,EACI,KAAK,CAAC,SADV,CAEI,OAAO,CAAE,KAAKmB,WAFlB,sBAFJ,CADJ,cAUI,oBAAC,MAAD,EACI,GAAG,CAAE,CAAC,EADV,CAEI,GAAG,CAAE,EAFT,CAGI,IAAI,CAAE,CAHV,CAII,YAAY,CAAE,CAJlB,CAKI,iBAAiB,CAAC,MALtB,CAMI,KAAK,CAAEa,IANX,CAOI,QAAQ,CAAE,KAAK6C,gBAPnB,CAQI,KAAK,CAAEpE,eARX,EAVJ,CAhCJ,cAqDI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,SAAS,CAAE0E,OAAO,CAAClF,kBAA9B,eACI,oBAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,OAAO,CAAC,WAAhC,CAA4C,OAAO,CAAE,KAAKmE,mBAA1D,SADJ,CArDJ,CAFJ,CAbJ,cA0EI,oBAAC,eAAD,MA1EJ,cA4EI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAEe,OAAO,CAACzG,SAAnC,CAA8C,OAAO,CAAE,CAAvD,eACI,oBAAC,UAAD,EAAY,SAAS,CAAEyG,OAAO,CAAChG,KAA/B,oCADJ,cAII,oBAAC,UAAD,8CAJJ,cAQI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,SAAS,CAAEgG,OAAO,CAACrG,WAA9B,eACI,oBAAC,UAAD,oBADJ,cAEI,oBAAC,UAAD,kBAFJ,CARJ,CAaK,CAACwC,OAAO,CAAGf,WAAH,CAAiBD,WAAzB,EAAsCkF,GAAtC,CACG,SAACC,SAAD,CAAYjC,KAAZ,CAAsB,CAClB,mBACI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,SAAS,CAAE2B,OAAO,CAAClG,SAA9B,eACI,oBAAC,UAAD,EACI,SAAS,CAAEkG,OAAO,CAAC/F,SADvB,CAEI,KAAK,CAAEuE,iBAAiB,CAACH,KAAD,CAAjB,CAA2B,WAA3B,CAAyC,SAFpD,EAGEiC,SAAS,CAAG,KAHd,CADJ,cAKI,oBAAC,MACG;AADJ,EAEI,GAAG,CAAEtC,QAFT,CAGI,GAAG,CAAED,QAHT,CAII,IAAI,CAAE,IAJV,CAKI,YAAY,CAAE,CALlB,CAMI,KAAK,CAAEnB,aAAa,CAACyB,KAAD,CANxB,CAOI,QAAQ,CAAE,kBAACZ,KAAD,CAAQlC,KAAR,QAAkB,CAAA,MAAI,CAAC6C,kBAAL,CAAwB7C,KAAxB,CAA+B8C,KAA/B,CAAlB,EAPd,CAQI,iBAAiB,CAAE,2BAACZ,KAAD,CAAQlC,KAAR,QAAkB,CAAA,MAAI,CAAC+C,sBAAL,CAA4B/C,KAA5B,CAAmC8C,KAAnC,CAAlB,EARvB,CASI,iBAAiB,CAAC,MATtB,CAUI,KAAK,CAAE,KAVX,CAWI,QAAQ,CAAE,MAAI,CAACnC,KAAL,CAAWqB,gBAAX,EAA+BX,aAAa,CAACyB,KAAD,CAAb,GAAyB,CAXtE,CAYI,KAAK,CAAE8B,WAZX,CAaI,KAAK,CAAE3B,iBAAiB,CAACH,KAAD,CAAjB,CAA2B,WAA3B,CAAyC,SAbpD,EALJ,cAoBI,oBAAC,SAAD,EACI,SAAS,CAAE2B,OAAO,CAAC7F,UADvB,CAEI,MAAM,CAAC,OAFX,CAGI,KAAK,CAAEyC,aAAa,CAACyB,KAAD,CAHxB,CAII,EAAE,CAAEA,KAJR,CAKI,QAAQ,CAAE,MAAI,CAACb,iBALnB,CAMI,UAAU,CAAE,CACR+C,IAAI,CAAE,IADE,CAER;AACA;AACAC,IAAI,CAAE,QACN;AALQ,CANhB,CAaI,QAAQ,CAAE,MAAI,CAACtE,KAAL,CAAWqB,gBAAX,EAA+BX,aAAa,CAACyB,KAAD,CAAb,GAAyB,CAbtE,CAcI,KAAK,CAAEG,iBAAiB,CAACH,KAAD,CAAjB,CAA2B,WAA3B,CAAyC,SAChD;AACA;AAhBJ,EApBJ,CADJ,CAyCH,CA3CJ,CAbL,cA2DI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,SAAS,CAAE2B,OAAO,CAAC3F,gBAA9B,eACI,oBAAC,MAAD,EACI,SAAS,CAAE2F,OAAO,CAACzF,YADvB,CAEI,OAAO,CAAC,WAFZ,CAGI,KAAK,CAAC,SAHV,CAII,OAAO,CAAE,KAAKkE,aAJlB,oBADJ,cASI,oBAAC,MAAD,EACI,SAAS,CAAEuB,OAAO,CAACzF,YADvB,CAEI,OAAO,CAAC,WAFZ,CAGI,KAAK,CAAC,SAHV,CAII,OAAO,CAAE,KAAKyB,WAJlB,+BATJ,CA3DJ,CA5EJ,CADJ,CADJ,CAwLH,C,0BAtoBsBtE,S,EAyoB3B,cAAeK,CAAAA,OAAO,CAClBD,YADkB,CAElBF,UAFkB,CAGlBI,UAAU,CAACc,MAAD,CAHQ,CAAP,CAIb2C,YAJa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { axios } from \"utils/utils\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport withUserAuth from \"context/withUserAuth\";\nimport { compose } from \"recompose\";\nimport { withStyles } from \"@material-ui/styles\";\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from \"@material-ui/core/Paper\";\nimport Slider from '@material-ui/core/Slider';\nimport Input from '@material-ui/core/Input';\nimport Button from '@material-ui/core/Button';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Dialog from '@material-ui/core/Dialog';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport AudioFilePlayer from \"components/audioFilePlayer\"\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    background: {\n        width: \"100%\",\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n\n    },\n    container: {\n        width: \"auto\",\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        // padding: 20,\n    },\n    iconHover: {\n        float: 'right',\n        '&:hover': {\n          color: \"grey\",\n        },\n        // alignItems: \"right\",\n        color: \"inherit\",\n    },\n    sliderLabel: {\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        width: \"auto\",\n        marginTop: 20\n    },\n    sliderRow: {\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        width: 'auto',\n        minWidth: 400,\n    },\n    title: {\n        marginTop: 40,\n    },\n    freqLabel: {\n        width: \"20%\",\n        marginRight: 10\n    },\n    inputField: {\n        width: \"20%\",\n        marginLeft: 20,\n    },\n    bottomButtonArea: {\n        marginTop: 30,\n        display: 'flex',\n        width: \"100%\",\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        alignItmes: 'center'\n    },\n    submitButton: {\n        width: 200\n    },\n    settingsBar: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'flex-end',\n        width: \"100%\"\n    },\n    settingsWindow: {\n        width: \"100%\",\n        paddingLeft: 30,\n        paddingRight: 30,\n        paddingBottom: 30,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'flex-start'\n    },\n    volumeTitle: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between'\n    },\n    saveSettingsButton: {\n        alignSelf: 'center'\n    },\n    alertWindow: {\n        width: 400,\n        display: 'flex',\n        justifyContent: 'center',\n        paddingLeft: 30,\n        paddingRight: 30,\n        paddingBottom: 20\n    },\n    switchMsgWindow: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        padding: 20,\n    }\n});\n\nconst sixBandFreq = ['250', '500', '1000', '2000', '4000', '8000'];\nconst tenBandFreq = ['250', '500', '750', '1000', '1500', '2000', '3000', '4000', '6000', '8000'];\n// The number of bands the user can set as non-zero values at a time\nconst bandLimit = 3;\n// Marks for alpha sliders\nconst gainSliderMarks = [{value: -20, label: '-20'}, {value: 10, label: '10'}];\n\nclass FreppingDemo extends Component {\n    constructor(props) {\n        super(props);\n        // Don't call this.setState() here!\n        this.state = {\n            showAlert: false,\n            freppingAlpha: [0, 0, 0, 0, 0, 0],\n            // bandsWarped: 0,\n            reachedFrepLimit: false,\n            openSettings: false,\n            tenBand: false,\n            gain: 0,\n            showBandSwitchMsg: false,\n            minAlpha: -0.5,\n            maxAlpha: 0.5,\n            alphaRange: [-0.5, 0.5],\n            shouldChangeColor: [false, false, false, false, false, false],\n            showDes: false\n        };\n      }\n\n    componentDidMount = async () => {\n        try{\n            await axios.get(\"/api/db/frepingDemo/\")\n            // await this.updateParam();\n        } catch(error){\n            if (error.response.data == \"table not found\"){\n                await axios.post(\"/api/db/table/create/frepingDemo\");\n            }\n            throw error;\n        }\n    }\n\n    /**\n     * This function loads the HA profile last saved in the database.\n     */\n    updateParam = async () => {\n        try {\n            let url = \"/api/db/frepingDemo/\" + (this.state.tenBand ? \"ten_band\" : \"six_band\");\n            const paramsResponse = await axios.get(url);\n            // console.log(paramsResponse.data);\n            let params = paramsResponse.data;\n\n\n            // // Call the server API which returns the HA profile\n            // const paramsResponse = await axios.get(\"/api/param/amplification\");\n            // console.log(paramsResponse.data);\n            // // We are using magic numbers for indice of the current profile in the db.\n            // let params;\n            // if (this.state.tenBand) {\n            //     params = JSON.parse(paramsResponse.data[3].parameters);\n            // } else {\n            //     params = JSON.parse(paramsResponse.data[4].parameters);\n            // }\n\n            console.log(params);\n            this.checkBandLimit(params.left.freping_alpha);\n            this.setState({\n                freppingAlpha: [...params.left.freping_alpha],\n                gain: params.left.gain\n            }, () => {\n                this.sendParamsToMHA();\n                this.resetShouldChangeColor();\n            });\n        } catch (error) {\n            // this.handleAlertOpen();\n            // if (error.response.data == \"key not found\") {\n            //     await axios.\n            // }\n            throw error;\n        }\n    }\n\n    /**\n     * Handles the close of the alert caused by the MHA error.\n     */\n    handleAlertClose = () => {\n        this.setState({showAlert: false});\n    }\n\n    /**\n     * Handles the open of the alert window caused by the MHA error.\n     */\n    handleAlertOpen = () => {\n        this.setState({showAlert: true});\n    }\n\n    /** \n     * Checks how many bands the user has set to non-zero.\n     */\n    checkBandLimit = (arr) => {\n        let count = 0;\n        let i;\n        for (i = 0; i < arr.length; i++) {\n            if (arr[i] != 0) {\n                count++;\n            }\n        }\n        this.setState({\n            // bandsWarped: count,\n            reachedFrepLimit: count >= 3 ? true : false\n        });\n    }\n\n    /** \n     * Handles the change from each input field for its corresponding alpha.\n     * \n     * @param {*} event the event object sent by input component.\n     */\n    handleInputChange = async (event) => {\n        // The index of input fields, which represents a particular channel that the\n        // user made change to.\n        const idx = event.target.id;\n        const value = event.target.value;\n        let newValue;\n        // Sanity check of user's input: limit each alpha inside the bound.\n        if (value) {\n            newValue = Number(value);\n            if (newValue > this.state.maxAlpha) {\n                newValue = this.state.maxAlpha;\n            } else if (newValue < this.state.minAlpha) {\n                newValue = this.state.minAlpha;\n            }\n        } else {\n            newValue = 0;\n        }\n\n        // Update the frepping state.\n        let tempArray = this.state.freppingAlpha;\n        // const oldAlpha = tempArray[idx];\n        tempArray[idx] = newValue;\n        this.setState((prevState) => {\n            console.log(prevState);    // Why is this prevState the same as the new state?\n            // this.checkFreppingLimit(oldAlpha, newValue);\n            this.checkBandLimit(tempArray);\n            return {freppingAlpha: tempArray}\n        }, () => {\n            this.sendParamsToMHA();\n            this.handleColorChange(idx, true);\n        });\n    }\n\n    /**\n     * Handles the slider's change.\n     * @param {*} event event object sent by slider component\n     * @param {*} newValue the new value that the user just set for the slider\n     */\n    handleSliderChange = async (newValue, index) => {\n        // console.log(newValue);\n        // console.log(index);\n        // const idx = event.target.id;\n        let tempArray = this.state.freppingAlpha;\n        // const oldAlpha = tempArray[idx];\n        tempArray[index] = newValue;\n        this.setState({freppingAlpha: tempArray});\n    }\n\n    handleSliderChangeDone = async (newValue, index) => {\n        this.checkBandLimit(this.state.freppingAlpha);\n        this.sendParamsToMHA();\n        this.handleColorChange(index, true);\n    }\n\n    /**\n     * Change the color for components (text and slider) of a particular band\n     * that the user has made change to but hasn't saved the change to the database.\n     * @param {*} index The index of the band that the user changed\n     * @param {*} status The bool value that needs giving to the bool stored in the\n     *                   shouldChangeColor array with the given index\n     */\n    handleColorChange = (index, status) => {\n        let tempArray = this.state.shouldChangeColor;\n        tempArray[index] = status;\n        this.setState({\n            shouldChangeColor: tempArray\n        });\n    }\n\n    // checkFreppingLimit = async (oldValue, newValue) => {\n    //     // console.log(oldValue.toString() + ' ' + newValue.toString());\n    //     if (oldValue === 0 && newValue !== 0) {\n    //         this.setState((prevState) => {\n    //             return {bandsWarped: prevState.bandsWarped + 1};\n    //         }, () => {\n    //             console.log('bandsWarped: ' + this.state.bandsWarped.toString());\n    //             if (this.state.bandsWarped === bandLimit) {\n    //                 this.setState({\n    //                     reachedFrepLimit: true\n    //                 });\n    //             }\n    //         });\n    //     } else if (oldValue !== 0 && newValue === 0) {\n    //         this.setState((prevState) => {\n    //             return {bandsWarped: prevState.bandsWarped === 0 ? 0 : prevState.bandsWarped - 1};\n    //         }, () => {\n    //             console.log('bandsWarped: ' + this.state.bandsWarped.toString());\n    //             this.setState({\n    //                 reachedFrepLimit: false\n    //             });\n    //         });\n    //     }\n    // }\n\n    /**\n     * Reset all bools stored in the shouldChangeColor array to be false, called when\n     * the user clicks the 'Submit' button (when the changes the user made have been\n     * saved in the database).\n     */\n    resetShouldChangeColor = () => {\n        let i;\n        let tempArray = this.state.shouldChangeColor;\n        for (i = 0; i < tempArray.length; i++) {\n            tempArray[i] = false;\n        }\n        this.setState({\n            shouldChangeColor: tempArray\n        });\n    }\n\n    /**\n     * Called when the user clicked the submit button. Basically it sends the params (in this\n     * demo app referring to frepping alpha's) to the database.\n     */\n    onClickSubmit = async () => {\n        // Prepare the data\n        const params = this.prepareData();\n        console.log(this.state.tenBand);\n        console.log(this.state.freppingAlpha);\n        console.log(params);\n\n        this.resetShouldChangeColor();\n\n        try {\n            // Save the data in the database.\n            const response = await axios.post(\"/api/db/frepingDemo\", {\n                key: this.state.tenBand ? \"ten_band\" : \"six_band\",\n                value: JSON.stringify(params)\n            });\n            console.log(response.data);\n        } catch (error) {\n            // this.handleAlertOpen();\n            console.log(error.response.data);\n        }\n    }\n\n    prepareData = () => {\n        const {freppingAlpha, gain} = this.state;\n        const params = {\n            left: {\n                freping: 1,\n                freping_alpha: freppingAlpha,\n                gain: gain\n            },\n            right: {\n                freping: 1,\n                freping_alpha: freppingAlpha,\n                gain: gain\n            }\n        };\n        return params;\n    }\n\n    sendParamsToMHA = async () => {\n        const params = this.prepareData();\n        console.log(params);\n        try {\n            // Send the data to RT-MHA\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: params,\n            });\n            console.log(response.data);\n        } catch (error) {\n            // this.handleAlertOpen();\n            console.log(error.response.data);\n        }\n    }\n\n    /**\n     * handle the settings page's close.\n     */\n    handleSettingsClose = () => {\n        this.setState({\n            openSettings: false\n        });\n\n        // Check whether any alpha value is out of the updated Range\n        this.checkOutOfRange();\n    }\n\n    /**\n     * Handles the settings page's open\n     */\n    handleSettingsClick = () => {\n        this.setState({\n            openSettings: true\n        });\n    }\n\n    /**\n     * If the user changes the range for the alpha, then all the current alpha values\n     * which are out of the updated range should be pushed inside the new range.\n     */\n    checkOutOfRange = async () => {\n        let temp = this.state.freppingAlpha;\n        let i;\n        // Push every alpha into the updated range.\n        for (i = 0; i < temp.length; i++) {\n            if (temp[i] < this.state.minAlpha) {\n                temp[i] = this.state.minAlpha;\n                this.handleColorChange(i, true);\n            } else if (temp[i] > this.state.maxAlpha) {\n                temp[i] = this.state.maxAlpha;\n                this.handleColorChange(i, true);\n            }\n        }\n        // this.setState({\n        //     freppingAlpha: temp\n        // }, this.sendParamsToMHA);\n        this.setState({\n            freppingAlpha: temp\n        }, this.sendParamsToMHA)\n    }\n\n    /**\n     * Handles the band mode switch\n     * @param {*} event event object sent by the select component. Here, event.target.value -- 0 means\n     *                  the user is using the 6-band mode, 1 means the user is using the 10-band mode.\n     */\n    handleBandSwitch = async (event) => {\n        if (event.target.value) {\n            this.setState({\n                freppingAlpha: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                shouldChangeColor: [false, false, false, false, false, false, false, false, false, false]\n            });\n        } else {\n            this.setState({\n                freppingAlpha: [0, 0, 0, 0, 0, 0],\n                shouldChangeColor: [false, false, false, false, false, false]\n            });\n        }\n\n        this.setState({\n            tenBand: event.target.value,\n            // bandsWarped: 0,\n            reachedFrepLimit: false\n        }, ()=>{\n            this.updateParam();\n        });\n\n        // Show the switch msg to the user.\n        this.handleSwitchMsgOpen();\n\n        try {\n            const response = await axios.post(\"/api/researcher/restartRTMHA\", {data: event.target.value});\n            console.log(response.data);\n        } catch (error) {\n            console.log(error);\n        }\n    }\n\n    /**\n     * Close the confirmation message window for band mode switch.\n     */\n    handleSwitchMsgClose = () => {\n        this.setState({\n            showBandSwitchMsg: false\n        });\n    }\n\n    /**\n     * Open the confirmation message window for band mode switch.\n     */\n    handleSwitchMsgOpen = () => {\n        this.setState({\n            showBandSwitchMsg: true\n        });\n    }\n\n    /**\n     * Handle the change for gaim (volume)\n     * @param {*} event event object sent by the slider component for the gain\n     * @param {*} newValue the new value of the gain\n     */\n    handleGainChange = async (event, newValue) => {\n        this.setState({\n            gain: newValue\n        });\n\n        const params = {\n            left: {\n                gain: newValue\n            }, \n            right: {\n                gain: newValue\n            }\n        };\n\n        try {\n            const response = await axios.post(\"/api/param/setparam\", {\n                method: \"set\",\n                data: params,\n            });\n            console.log(response.data);\n        } catch (error) {\n            this.handleAlertOpen();\n            console.log(error.response.data);\n        }\n    }\n\n    /**\n     * Handles the change for alpha's range\n     * @param {*} event event object sent by the slider component for changing alpha's range\n     * @param {*} newValue a pair which represents the min and max boundary of the new range.\n     *                     Here we can assume newValue[0] is the lower bound, newValue[1] is\n     *                     the upper bound.\n     */\n    handleAlphaRangeChange = (event, newValue) => {\n        if (newValue[0] >= 0 || newValue[1] <= 0) {\n            return;\n        }\n        if (newValue[1] - newValue[0] < 0.04) {\n            return;\n        }\n        this.setState({\n            alphaRange: newValue,\n            minAlpha: newValue[0],\n            maxAlpha: newValue[1]\n        });\n    }\n\n    showDescription = () => {\n        this.setState({\n            showDes: true\n        });\n    }\n\n    hideDescription = () => {\n        this.setState({\n            showDes: false\n        });\n    }\n\n    render() {\n        const { classes } = this.props; \n        const { freppingAlpha, tenBand, gain, showAlert, showBandSwitchMsg, alphaRange,\n                minAlpha, maxAlpha, shouldChangeColor, showDes } = this.state;\n        let alphaRangeSliderMarks = [\n            {value: alphaRange[0], label: alphaRange[0].toString()},\n            {value: alphaRange[1], label: alphaRange[1].toString()}\n        ];\n        let sliderMarks = [\n            {value: 0, label: '0'},\n            {value: minAlpha, label: minAlpha.toString()},\n            {value: maxAlpha, label: maxAlpha.toString()}\n        ];\n        let gainSliderMarks = [\n            {value: -20, label: '-20'},\n            {value: 10, label: '10'},\n            {value: gain, label: gain.toString()}\n        ];\n\n        return(\n            <div className={classes.root}>\n                <Paper className={classes.background}>\n                    <Dialog open={showAlert} onClose={this.handleAlertClose}>\n                        <DialogTitle>Error</DialogTitle>\n                        <Grid container className={classes.alertWindow}>\n                            <Typography>RT-MHA is not running. Please make sure RT-MHA is running before fetching or sending parameters</Typography>\n                            <Button onClick={this.handleAlertClose} color=\"primary\" variant=\"contained\">OK</Button>\n                        </Grid>\n                    </Dialog>\n\n                    <div className={classes.settingsBar}>\n                        <SettingsIcon className={classes.iconHover} fontSize=\"large\" onClick={this.handleSettingsClick}></SettingsIcon>\n                    </div>\n\n                    <Dialog open={this.state.openSettings} onClose={this.handleSettingsClose}>\n                        <DialogTitle>Settings</DialogTitle>\n                        <Grid container spacing={3}  className={classes.settingsWindow}>\n                            <Grid item>\n                                <Typography>Select the number of bands of your device</Typography>\n                                <Select\n                                    value={tenBand}\n                                    onChange={this.handleBandSwitch}\n                                >\n                                    <MenuItem value={false}>Six Band</MenuItem>\n                                    <MenuItem value={true}>Ten Band</MenuItem>\n                                </Select>\n                                <Dialog open={showBandSwitchMsg} onClose={this.handleSwitchMsgClose}>\n                                    <Grid container className={classes.switchMsgWindow}>\n                                        <Typography style={{marginBottom: 10}}>\n                                            Successfully switched to the {tenBand ? \"ten band\" : \"six band\"} mode\n                                        </Typography>\n                                        <Button onClick={this.handleSwitchMsgClose} color=\"primary\" variant=\"contained\">OK</Button>\n                                    </Grid>\n                                </Dialog>\n                            </Grid>\n\n                            <Grid item>\n                                <Typography>Adjust the range of Alpha (the span shouldn't be smaller than 0.2)</Typography>\n                                <Slider\n                                    min={-0.5}\n                                    max={0.5}\n                                    value={alphaRange}\n                                    step={0.01}\n                                    onChange={this.handleAlphaRangeChange}\n                                    marks={alphaRangeSliderMarks}\n                                />\n                            </Grid>\n\n                            <Grid item>\n                                <Grid className={classes.volumeTitle}>\n                                    <Typography>Volume</Typography>\n                                    <Button\n                                        color=\"primary\"\n                                        onClick={this.updateParam}\n                                    >\n                                        Load Saved Volume\n                                    </Button>\n                                </Grid>\n                                <Slider\n                                    min={-20}\n                                    max={10}\n                                    step={1}\n                                    defaultValue={0}\n                                    valueLabelDisplay='auto'\n                                    value={gain}\n                                    onChange={this.handleGainChange}\n                                    marks={gainSliderMarks}\n                                />\n                            </Grid>\n                            <Grid item className={classes.saveSettingsButton}>\n                                <Button color='primary' variant=\"contained\" onClick={this.handleSettingsClose}>Done</Button>\n                            </Grid>\n                        </Grid>\n                    </Dialog>\n\n                    <AudioFilePlayer/>\n\n                    <Grid container className={classes.container} spacing={3}>\n                        <Typography className={classes.title}>\n                            Alpha for different frequencies\n                        </Typography>\n                        <Typography>\n                            You can warp up to 3 bands at a time.\n                        </Typography>\n\n                        <Grid item className={classes.sliderLabel}>\n                            <Typography>Compression</Typography>\n                            <Typography>Expansion</Typography>\n                        </Grid>\n\n                        {(tenBand ? tenBandFreq : sixBandFreq).map(\n                            (currAlpha, index) => {\n                                return (\n                                    <Grid item className={classes.sliderRow}>\n                                        <Typography\n                                            className={classes.freqLabel}\n                                            color={shouldChangeColor[index] ? \"secondary\" : \"primary\"}\n                                        >{currAlpha + \" Hz\"}</Typography>\n                                        <Slider\n                                            // id={index}\n                                            min={minAlpha}\n                                            max={maxAlpha}\n                                            step={0.01}\n                                            defaultValue={0}\n                                            value={freppingAlpha[index]}\n                                            onChange={(event, value) => this.handleSliderChange(value, index)}\n                                            onChangeCommitted={(event, value) => this.handleSliderChangeDone(value, index)}\n                                            valueLabelDisplay=\"auto\"\n                                            track={false}\n                                            disabled={this.state.reachedFrepLimit && freppingAlpha[index] === 0}\n                                            marks={sliderMarks}\n                                            color={shouldChangeColor[index] ? \"secondary\" : \"primary\"}\n                                        />\n                                        <TextField\n                                            className={classes.inputField}\n                                            margin='dense'\n                                            value={freppingAlpha[index]}\n                                            id={index}\n                                            onChange={this.handleInputChange}\n                                            inputProps={{\n                                                step: 0.01,\n                                                // min: -minAlpha,\n                                                // max: maxAlpha,\n                                                type: 'number',\n                                                // 'aria-labelledby': 'input-slider',\n                                            }}\n                                            disabled={this.state.reachedFrepLimit && freppingAlpha[index] === 0}\n                                            color={shouldChangeColor[index] ? \"secondary\" : \"primary\"}\n                                            // error={freppingAlpha[index]>0.5||freppingAlpha[index]<-0.5}\n                                            // helperText=\"Entry.\"\n                                        />\n                                    </Grid>\n                                )\n                            }\n                        )}\n\n                        <Grid item className={classes.bottomButtonArea}>\n                            <Button\n                                className={classes.submitButton}\n                                variant=\"contained\"\n                                color=\"primary\"\n                                onClick={this.onClickSubmit}\n                            >\n                                    Save Parameters\n                            </Button>\n                            <Button\n                                className={classes.submitButton}\n                                variant=\"contained\"\n                                color=\"primary\"\n                                onClick={this.updateParam}\n                            >\n                                    Load Last Saved Parameters\n                            </Button>\n                        </Grid>\n\n                        {/* <Grid item>\n                            <Button\n                                color=\"primary\"\n                                onClick={showDes ? this.hideDescription : this.showDescription}\n                            >\n                                {showDes ? 'Hide Description' : 'Show Description'}\n                            </Button>\n                        </Grid>\n\n                        {showDes && (\n                            <Grid>\n                                <Typography>\n                                    Freping, portmanteau for frequency warping, is basically shifting audio\n                                    content from their original frequency to another one. Freping is an intervention approach\n                                    used in HA hearbables that can help with reducing acoustic feedback between the\n                                    microphones and loudspeakers.\n                                    It also provides audiologists with a tool to handle less common types of\n                                    hearing loss, like \"cookie bite\", where HA users have difficulties perceiving\n                                    mid-frequency contents, compared to low- and high-frequency components.\n                                </Typography>\n                            </Grid>\n                        )} */}\n\n                    </Grid>\n\n                </Paper>\n            </div>\n        );\n    }\n}\n\nexport default compose(\n    withUserAuth,\n    withRouter,\n    withStyles(styles)\n)(FreppingDemo);"]},"metadata":{},"sourceType":"module"}
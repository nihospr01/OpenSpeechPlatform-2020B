{"ast":null,"code":"import _regeneratorRuntime from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{axios}from'utils/utils';import{withStyles}from'@material-ui/core/styles';import Typography from'@material-ui/core/Typography';import Button from'@material-ui/core/Button';import TextField from'@material-ui/core/TextField';import Paper from'@material-ui/core/Paper';import Hidden from'@material-ui/core/Hidden';import Tabs from'@material-ui/core/Tabs';import Tab from'@material-ui/core/Tab';import CircularProgress from'@material-ui/core/CircularProgress';import{Link,withRouter}from'react-router-dom';import{compose}from'recompose';import withUserAuth from'context/withUserAuth';var styles=function styles(theme){return{root:{padding:20},content:{display:'flex',flexDirection:'column',alignItems:'center'},topBar:{display:'flex',justifyContent:'space-between',marginBottom:30},topBarTitle:{marginLeft:50},topBarButton:{marginRight:50,justifySelf:'flex-end'},title:{marginBottom:30,textAlign:'center'},formPaper:{width:'90%',maxWidth:500},formContent:{paddingTop:30,paddingBottom:20,display:'flex',flexDirection:'column',alignItems:'center'},textField:{width:'90%',maxWidth:400,marginBottom:20},button:{width:'90%',maxWidth:300,marginTop:10}};};var formStyles={formContent:{paddingTop:30,paddingBottom:20,display:'flex',flexDirection:'column',alignItems:'center'},textField:{width:'90%',maxWidth:400,marginBottom:20},button:{width:'90%',maxWidth:300,marginTop:10,marginBottom:10}};var ListenerLogin=/*#__PURE__*/function(_Component){_inherits(ListenerLogin,_Component);var _super=_createSuper(ListenerLogin);function ListenerLogin(){var _this;_classCallCheck(this,ListenerLogin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={listenerID:\"\",password:\"\"};_this.handleInputChange=function(event){_this.setState(_defineProperty({},event.target.id,event.target.value));};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var history,response,listenerID;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:history=_this.props.history;event.preventDefault();_this.setState({isLoading:true});_context.prev=3;_context.next=6;return axios.post(\"/api/listener/login\",{listenerID:_this.state.listenerID,password:_this.state.password});case 6:response=_context.sent;listenerID=response.data.listenerID;sessionStorage.setItem('user',listenerID);sessionStorage.setItem('loginMode',1);sessionStorage.setItem('historyDone',response.data.historyDone);sessionStorage.setItem('PTADone',response.data.PTADone);sessionStorage.setItem('assessmentDone',response.data.assessmentDone);sessionStorage.setItem('AFCDone',response.data.AFCDone);sessionStorage.setItem('leftEarIsWorse',response.data.leftEarIsWorse);_context.next=17;return _this.props.context.updateUser();case 17:history.push('/');_context.next=25;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](3);alert(_context.t0);_this.setState({isLoading:false});console.log(_context.t0);case 25:case\"end\":return _context.stop();}}},_callee,null,[[3,20]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(ListenerLogin,[{key:\"render\",value:function render(){var classes=this.props.classes;var _this$state=this.state,listenerID=_this$state.listenerID,password=_this$state.password,isLoading=_this$state.isLoading;var submitDisabled=listenerID===\"\"||password===\"\"||isLoading;return/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\",noValidate:true,className:classes.formContent},/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",required:true,label:\"Listener ID\",id:\"listenerID\",onChange:this.handleInputChange,className:classes.textField}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",required:true,type:\"password\",label:\"Password\",id:\"password\",onChange:this.handleInputChange,className:classes.textField}),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",className:classes.button,color:\"primary\",disabled:submitDisabled,onClick:this.handleSubmit},\"Submit\"),isLoading&&/*#__PURE__*/React.createElement(CircularProgress,null));}}]);return ListenerLogin;}(Component);var ListenerLoginForm=compose(withUserAuth,withRouter,withStyles(formStyles))(ListenerLogin);var ResearcherLogin=/*#__PURE__*/function(_Component2){_inherits(ResearcherLogin,_Component2);var _super2=_createSuper(ResearcherLogin);function ResearcherLogin(){var _this2;_classCallCheck(this,ResearcherLogin);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}_this2=_super2.call.apply(_super2,[this].concat(args));_this2.state={researcherID:\"\",password:\"\"};_this2.handleInputChange=function(event){_this2.setState(_defineProperty({},event.target.id,event.target.value));};_this2.handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var history,response,researcherID;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:history=_this2.props.history;event.preventDefault();_this2.setState({isLoading:true});_context2.prev=3;_context2.next=6;return axios.post(\"/api/researcher/login\",{researcherID:_this2.state.researcherID,password:_this2.state.password});case 6:response=_context2.sent;researcherID=response.data.researcherID;sessionStorage.setItem('user',researcherID);sessionStorage.setItem('loginMode','researcher');sessionStorage.setItem('historyDone',false);sessionStorage.setItem('PTADone',false);sessionStorage.setItem('assessmentDone',false);sessionStorage.setItem('AFCDone',false);sessionStorage.setItem('leftEarIsWorse',false);_context2.next=17;return _this2.props.context.updateUser();case 17:history.push('/');_context2.next=26;break;case 20:_context2.prev=20;_context2.t0=_context2[\"catch\"](3);alert(_context2.t0);_this2.setState({isLoading:false});alert(_context2.t0);console.log(_context2.t0);case 26:case\"end\":return _context2.stop();}}},_callee2,null,[[3,20]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();return _this2;}_createClass(ResearcherLogin,[{key:\"render\",value:function render(){var classes=this.props.classes;var _this$state2=this.state,listenerID=_this$state2.listenerID,password=_this$state2.password,isLoading=_this$state2.isLoading;var submitDisabled=listenerID===\"\"||password===\"\"||isLoading;return/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\",noValidate:true,className:classes.formContent},/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",required:true,label:\"Researcher ID\",id:\"researcherID\",onChange:this.handleInputChange,className:classes.textField}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",required:true,type:\"password\",label:\"Password\",id:\"password\",onChange:this.handleInputChange,className:classes.textField}),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",className:classes.button,color:\"primary\",disabled:submitDisabled,onClick:this.handleSubmit},\"Submit\"),isLoading&&/*#__PURE__*/React.createElement(CircularProgress,null));}}]);return ResearcherLogin;}(Component);var ResearcherLoginForm=compose(withUserAuth,withRouter,withStyles(formStyles))(ResearcherLogin);var Login=/*#__PURE__*/function(_Component3){_inherits(Login,_Component3);var _super3=_createSuper(Login);function Login(){var _this3;_classCallCheck(this,Login);for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}_this3=_super3.call.apply(_super3,[this].concat(args));_this3.state={loginMode:0,listenerID:\"\",password:\"\",isLoading:false};_this3.handleInputChange=function(event){_this3.setState(_defineProperty({},event.target.id,event.target.value));};_this3.handleTabChange=function(event,value){_this3.setState({loginMode:value});};_this3.topBar=function(){var classes=_this3.props.classes;return/*#__PURE__*/React.createElement(\"div\",{className:classes.topBar},/*#__PURE__*/React.createElement(Hidden,{xsDown:true},/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle1\",color:\"textSecondary\",className:classes.topBarTitle},\"Researcher and Listener Login\")),/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",color:\"secondary\",className:classes.topBarButton,component:Link,to:\"/signup\"},\"Sign up\"));};return _this3;}_createClass(Login,[{key:\"render\",value:function render(){var classes=this.props.classes;var loginMode=this.state.loginMode;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},this.topBar(),/*#__PURE__*/React.createElement(\"div\",{className:classes.title},/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",gutterBottom:true},\"Welcom to Open Speech Platform\"),/*#__PURE__*/React.createElement(Typography,{variant:\"h6\",gutterBottom:true,color:\"textSecondary\"},\"WebApps for hearing-aid research\")),/*#__PURE__*/React.createElement(\"div\",{className:classes.content},/*#__PURE__*/React.createElement(Paper,{className:classes.formPaper},/*#__PURE__*/React.createElement(Tabs,{value:loginMode,onChange:this.handleTabChange,indicatorColor:\"primary\",textColor:\"primary\",variant:\"fullWidth\",id:\"loginMode\"},/*#__PURE__*/React.createElement(Tab,{label:\"Researcher Login\",value:0}),/*#__PURE__*/React.createElement(Tab,{label:\"Listener Login\",value:1})),loginMode===0&&/*#__PURE__*/React.createElement(ResearcherLoginForm,null),loginMode===1&&/*#__PURE__*/React.createElement(ListenerLoginForm,null))));}}]);return Login;}(Component);export default compose(withUserAuth,withRouter,withStyles(styles))(Login);","map":{"version":3,"sources":["/opt/OpenSpeechPlatform-UCSD/Software/ewsnodejs-client/src/pages/general/login.jsx"],"names":["React","Component","axios","withStyles","Typography","Button","TextField","Paper","Hidden","Tabs","Tab","CircularProgress","Link","withRouter","compose","withUserAuth","styles","theme","root","padding","content","display","flexDirection","alignItems","topBar","justifyContent","marginBottom","topBarTitle","marginLeft","topBarButton","marginRight","justifySelf","title","textAlign","formPaper","width","maxWidth","formContent","paddingTop","paddingBottom","textField","button","marginTop","formStyles","ListenerLogin","state","listenerID","password","handleInputChange","event","setState","target","id","value","handleSubmit","history","props","preventDefault","isLoading","post","response","data","sessionStorage","setItem","historyDone","PTADone","assessmentDone","AFCDone","leftEarIsWorse","context","updateUser","push","alert","console","log","classes","submitDisabled","ListenerLoginForm","ResearcherLogin","researcherID","ResearcherLoginForm","Login","loginMode","handleTabChange"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { axios } from 'utils/utils';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Paper from '@material-ui/core/Paper';\nimport Hidden from '@material-ui/core/Hidden';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab'\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { Link, withRouter } from 'react-router-dom';\nimport { compose } from 'recompose';\nimport withUserAuth from 'context/withUserAuth';\n\nconst styles = (theme) => ({\n    root: {\n        padding: 20\n    },\n    content: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n    },\n    topBar: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        marginBottom: 30\n    },\n    topBarTitle: {\n        marginLeft: 50,\n    },\n    topBarButton: {\n        marginRight: 50,\n        justifySelf: 'flex-end',\n    },\n    title: {\n        marginBottom: 30,\n        textAlign: 'center'\n    },\n    formPaper: {\n        width: '90%',\n        maxWidth: 500,\n    },\n    formContent: {\n        paddingTop: 30,\n        paddingBottom: 20,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n    },\n    textField: {\n        width: '90%',\n        maxWidth: 400,\n        marginBottom: 20\n    },\n    button: {\n        width: '90%',\n        maxWidth: 300,\n        marginTop: 10\n    },\n})\n\nconst formStyles = {\n    formContent: {\n        paddingTop: 30,\n        paddingBottom: 20,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n    },\n    textField: {\n        width: '90%',\n        maxWidth: 400,\n        marginBottom: 20\n    },\n    button: {\n        width: '90%',\n        maxWidth: 300,\n        marginTop: 10,\n        marginBottom: 10,\n    },\n}\n\nclass ListenerLogin extends Component {\n    state = {\n        listenerID: \"\",\n        password: \"\",\n    };\n\n    handleInputChange = (event) => {\n        this.setState({\n            [event.target.id]: event.target.value,\n        });\n    }\n\n    handleSubmit = async event => {\n        const { history } = this.props;\n        event.preventDefault();\n        this.setState({\n            isLoading: true,\n        });\n        try {\n            const response = await axios.post(\"/api/listener/login\", {\n                listenerID: this.state.listenerID,\n                password: this.state.password\n            });\n        \n            const { listenerID } = response.data;\n            sessionStorage.setItem('user', listenerID);\n            sessionStorage.setItem('loginMode', 1);\n            sessionStorage.setItem('historyDone', response.data.historyDone);\n            sessionStorage.setItem('PTADone', response.data.PTADone);\n            sessionStorage.setItem('assessmentDone', response.data.assessmentDone);\n            sessionStorage.setItem('AFCDone', response.data.AFCDone);\n            sessionStorage.setItem('leftEarIsWorse', response.data.leftEarIsWorse);\n            await this.props.context.updateUser();\n            history.push('/');\n        }\n        catch (error) {\n            alert(error);\n            this.setState({\n                isLoading: false,\n            });\n            console.log(error);\n        }\n    }\n\n    render() {\n        const { classes } = this.props;\n        const { listenerID, password, isLoading } = this.state;\n        const submitDisabled = (listenerID === \"\" || password === \"\" || isLoading);\n        return (\n            <form autoComplete=\"off\" noValidate className={classes.formContent}>\n                <TextField\n                    variant=\"outlined\"\n                    required\n                    label=\"Listener ID\"\n                    id=\"listenerID\"\n                    onChange={this.handleInputChange}\n                    className={classes.textField}\n                />\n                <TextField\n                    variant=\"outlined\"\n                    required\n                    type=\"password\"\n                    label=\"Password\"\n                    id=\"password\"\n                    onChange={this.handleInputChange}\n                    className={classes.textField}\n                /> \n                <Button\n                    variant=\"contained\"\n                    className={classes.button}\n                    color=\"primary\"\n                    disabled={submitDisabled}\n                    onClick={this.handleSubmit}\n                >\n                    Submit\n                </Button>\n                {isLoading && <CircularProgress />}\n            </form>\n        );\n    }\n}\n\nconst ListenerLoginForm = compose(\n    withUserAuth,\n    withRouter,\n    withStyles(formStyles),\n)(ListenerLogin);\n\nclass ResearcherLogin extends Component {\n    state = {\n        researcherID: \"\",\n        password: \"\",\n    };\n\n    handleInputChange = (event) => {\n        this.setState({\n            [event.target.id]: event.target.value,\n        });\n    }\n\n    handleSubmit = async event => {\n        const { history } = this.props;\n        event.preventDefault();\n        this.setState({\n            isLoading: true,\n        });\n        try {\n            const response = await axios.post(\"/api/researcher/login\", {\n                researcherID: this.state.researcherID,\n                password: this.state.password\n            });\n            const { researcherID } = response.data;\n            sessionStorage.setItem('user', researcherID);\n            sessionStorage.setItem('loginMode', 'researcher');\n            sessionStorage.setItem('historyDone', false);\n            sessionStorage.setItem('PTADone', false);\n            sessionStorage.setItem('assessmentDone', false);\n            sessionStorage.setItem('AFCDone', false);\n            sessionStorage.setItem('leftEarIsWorse', false);\n            await this.props.context.updateUser();\n            history.push('/');\n        }\n        catch (error) {\n            alert(error);\n            this.setState({\n                isLoading: false,\n            });\n            alert(error);\n            console.log(error);\n        }\n    }\n\n    render() {\n        const { classes } = this.props;\n        const { listenerID, password, isLoading } = this.state;\n        const submitDisabled = (listenerID === \"\" || password === \"\" || isLoading);\n        return (\n            <form autoComplete=\"off\" noValidate className={classes.formContent}>\n                <TextField\n                    variant=\"outlined\"\n                    required\n                    label=\"Researcher ID\"\n                    id=\"researcherID\"\n                    onChange={this.handleInputChange}\n                    className={classes.textField}\n                />\n                <TextField\n                    variant=\"outlined\"\n                    required\n                    type=\"password\"\n                    label=\"Password\"\n                    id=\"password\"\n                    onChange={this.handleInputChange}\n                    className={classes.textField}\n                /> \n                <Button\n                    variant=\"contained\"\n                    className={classes.button}\n                    color=\"primary\"\n                    disabled={submitDisabled}\n                    onClick={this.handleSubmit}\n                >\n                    Submit\n                </Button>\n                {isLoading && <CircularProgress />}\n            </form>\n        );\n    }\n}\n\nconst ResearcherLoginForm = compose(\n    withUserAuth,\n    withRouter,\n    withStyles(formStyles),\n)(ResearcherLogin);\n\n\nclass Login extends Component {\n    state = {\n        loginMode: 0,\n        listenerID: \"\",\n        password: \"\",\n        isLoading: false,\n    };\n\n    handleInputChange = (event) => {\n        this.setState({\n            [event.target.id]: event.target.value,\n        });\n    }\n\n    handleTabChange = (event, value) => {\n        this.setState({\n            loginMode: value,\n        });\n    }\n\n    topBar = () => {\n        const { classes } = this.props;\n\n        return (\n            <div className={classes.topBar}>\n                <Hidden xsDown>\n                    <Typography variant=\"subtitle1\" color=\"textSecondary\" className={classes.topBarTitle}>\n                        Researcher and Listener Login\n                    </Typography>\n                </Hidden>\n                <Button \n                    variant=\"outlined\" \n                    color=\"secondary\" \n                    className={classes.topBarButton}\n                    component={Link}\n                    to=\"/signup\"\n                >\n                    Sign up\n                </Button>\n            </div>\n        )\n    }\n\n    render() {\n        const { classes } = this.props;\n        const { loginMode } = this.state;\n        return (\n            <div className={classes.root}>\n                {this.topBar()}\n                <div className={classes.title}>\n                        <Typography variant=\"h4\" gutterBottom>Welcom to Open Speech Platform</Typography>\n                        <Typography variant=\"h6\" gutterBottom color=\"textSecondary\">WebApps for hearing-aid research</Typography>\n                    </div>\n                <div className={classes.content}>\n                    <Paper className={classes.formPaper}>\n                    <Tabs\n                        value={loginMode}\n                        onChange={this.handleTabChange}\n                        indicatorColor=\"primary\"\n                        textColor=\"primary\"\n                        variant=\"fullWidth\"\n                        id=\"loginMode\"\n                    >\n                        <Tab label=\"Researcher Login\" value={0}/>\n                        <Tab label=\"Listener Login\" value={1} />\n                    </Tabs>\n                        {loginMode === 0 && <ResearcherLoginForm/>}\n                        {loginMode === 1 && <ListenerLoginForm/>}\n                    </Paper>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default compose(\n    withUserAuth,\n    withRouter,\n    withStyles(styles)\n)(Login);\n"]},"metadata":{},"sourceType":"module"}
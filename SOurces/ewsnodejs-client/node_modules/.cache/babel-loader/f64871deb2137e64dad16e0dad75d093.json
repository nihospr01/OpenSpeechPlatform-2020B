{"ast":null,"code":"import _regeneratorRuntime from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/opt/osp/ewsnodejs-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{withStyles}from'@material-ui/styles';import{axios}from'utils/utils';import Grid from'@material-ui/core/Grid';import Typography from'@material-ui/core/Typography';import Button from'@material-ui/core/Button';import Input from'@material-ui/core/Input';import Slider from'@material-ui/core/Slider';import Box from'@material-ui/core/Box';import SettingsIcon from'@material-ui/icons/Settings';import bfDemo from'utils/images/bfDemo.png';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogContent from'@material-ui/core/DialogContent';import DialogTitle from'@material-ui/core/DialogTitle';import useMediaQuery from'@material-ui/core/useMediaQuery';import{useTheme}from'@material-ui/core/styles';var styles=function styles(theme){return{root:{flexGrow:1},content:{padding:theme.spacing(3),maxWidth:500,minWidth:200,margin:'auto'},bigbutton:{width:480,height:100,fontSize:30,margin:'auto'},button:{width:40,height:30,fontSize:10,margin:'auto'},input:{width:100},iconHover:{float:'right','&:hover':{color:\"grey\"},alignItems:\"right\",color:\"inherit\"},img:{width:300,height:'auto'}};};var BeamformingDemo=/*#__PURE__*/function(_Component){_inherits(BeamformingDemo,_Component);var _super=_createSuper(BeamformingDemo);function BeamformingDemo(){var _this;_classCallCheck(this,BeamformingDemo);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={beamformingEnabled:false,mu:0,ncEnabled:false,amcEnabled:false,open:false};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _this.loadParameter();case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);alert(_context.t0);case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));_this.loadParameter=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"/api/param/getparam\");case 3:response=_context2.sent;data=response.data;_this.setState({beamformingEnabled:data['left']['bf']===1,mu:parseFloat(data['left']['bf_mu'].toFixed(4)),ncEnabled:data['left']['bf_nc_on_off']===1,amcEnabled:data['left']['bf_amc_on_off']===1});_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));_this.ResponsiveDialog=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var theme,fullScreen;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://const [open, setOpen] = React.useState(false);\ntheme=useTheme();fullScreen=useMediaQuery(theme.breakpoints.down('sm'));case 2:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleClickOpen=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.setState({open:true});case 1:case\"end\":return _context4.stop();}}},_callee4);}));_this.handleClickClose=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this.setState({open:false});case 1:case\"end\":return _context5.stop();}}},_callee5);}));_this.handleMuSliderChange=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(event,newValue){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return _this.setMu(newValue);case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x,_x2){return _ref6.apply(this,arguments);};}();_this.handleMuInputChange=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(event){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return _this.setMu(event.target.value===''?0:Number(event.target.value));case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x3){return _ref7.apply(this,arguments);};}();_this.handleBlurMu=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var mu;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:mu=_this.state.mu;if(!(mu<0.0001)){_context8.next=6;break;}_context8.next=4;return _this.setMu(0.0001);case 4:_context8.next=9;break;case 6:if(!(mu>0.02)){_context8.next=9;break;}_context8.next=9;return _this.setMu(0.02);case 9:case\"end\":return _context8.stop();}}},_callee8);}));_this.setMu=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(value){var _this$state,beamformingEnabled,ncEnabled,amcEnabled;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_this$state=_this.state,beamformingEnabled=_this$state.beamformingEnabled,ncEnabled=_this$state.ncEnabled,amcEnabled=_this$state.amcEnabled;_context9.next=3;return _this.handleTransmiteBeamformingData(beamformingEnabled,value,ncEnabled,amcEnabled);case 3:_this.setState({mu:value});case 4:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x4){return _ref9.apply(this,arguments);};}();_this.handleNcChange=function(event){_this.setState({ncEnabled:event.target.value});};_this.handleAmcChange=function(event){_this.setState({amcEnabled:event.target.value});};_this.handleNcChange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var _this$state2,beamformingEnabled,mu,ncEnabled,amcEnabled;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_this$state2=_this.state,beamformingEnabled=_this$state2.beamformingEnabled,mu=_this$state2.mu,ncEnabled=_this$state2.ncEnabled,amcEnabled=_this$state2.amcEnabled;_context10.prev=1;_context10.next=4;return _this.handleTransmiteBeamformingData(beamformingEnabled,mu,!ncEnabled,amcEnabled);case 4:_this.setState({ncEnabled:!ncEnabled});_context10.next=10;break;case 7:_context10.prev=7;_context10.t0=_context10[\"catch\"](1);alert(_context10.t0.response.data);case 10:case\"end\":return _context10.stop();}}},_callee10,null,[[1,7]]);}));_this.handleAmcChange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var _this$state3,beamformingEnabled,mu,ncEnabled,amcEnabled;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_this$state3=_this.state,beamformingEnabled=_this$state3.beamformingEnabled,mu=_this$state3.mu,ncEnabled=_this$state3.ncEnabled,amcEnabled=_this$state3.amcEnabled;_context11.prev=1;_context11.next=4;return _this.handleTransmiteBeamformingData(beamformingEnabled,mu,ncEnabled,!amcEnabled);case 4:_this.setState({amcEnabled:!amcEnabled});_context11.next=10;break;case 7:_context11.prev=7;_context11.t0=_context11[\"catch\"](1);alert(_context11.t0.response.data);case 10:case\"end\":return _context11.stop();}}},_callee11,null,[[1,7]]);}));_this.handleBeamformingChange=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var _this$state4,beamformingEnabled,mu,ncEnabled,amcEnabled;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_this$state4=_this.state,beamformingEnabled=_this$state4.beamformingEnabled,mu=_this$state4.mu,ncEnabled=_this$state4.ncEnabled,amcEnabled=_this$state4.amcEnabled;_context12.prev=1;_context12.next=4;return _this.handleTransmiteBeamformingData(!beamformingEnabled,mu,ncEnabled,amcEnabled);case 4:_this.setState({beamformingEnabled:!beamformingEnabled});_context12.next=10;break;case 7:_context12.prev=7;_context12.t0=_context12[\"catch\"](1);alert(_context12.t0.response.data);case 10:case\"end\":return _context12.stop();}}},_callee12,null,[[1,7]]);}));_this.handleTransmiteBeamformingData=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(beamformingEnabled,mu,ncEnabled,amcEnabled){var beamformingData;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:beamformingData={'bf':beamformingEnabled===false?0:1,'bf_mu':mu,'bf_nc_on_off':ncEnabled===false?0:1,'bf_amc_on_off':amcEnabled===false?0:1};_context13.next=3;return axios.post(\"/api/param/setparam\",{method:'set',data:{'left':beamformingData,'right':beamformingData}});case 3:return _context13.abrupt(\"return\",_context13.sent);case 4:case\"end\":return _context13.stop();}}},_callee13);}));return function(_x5,_x6,_x7,_x8){return _ref13.apply(this,arguments);};}();return _this;}_createClass(BeamformingDemo,[{key:\"render\",value:function render(){var classes=this.props.classes;var _this$state5=this.state,beamformingEnabled=_this$state5.beamformingEnabled,mu=_this$state5.mu,ncEnabled=_this$state5.ncEnabled,amcEnabled=_this$state5.amcEnabled,open=_this$state5.open;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",justify:\"center\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(SettingsIcon,{className:classes.iconHover,fontSize:\"large\",onClick:this.handleClickOpen}),/*#__PURE__*/React.createElement(Dialog,{fullScreen:this.fullScreen,open:open,onClose:this.handleClickClose,\"aria-labelledby\":\"responsive-dialog-title\"},/*#__PURE__*/React.createElement(DialogTitle,{id:\"responsive-dialog-title\"},\"Adjust Settings for Beamforming Demo\"),/*#__PURE__*/React.createElement(DialogContent,null,/*#__PURE__*/React.createElement(Box,{mt:2/*lineHeight={2}*/,fontSize:18},\"Basic Settings:\"),/*#__PURE__*/React.createElement(Box,{lineHeight:2},\"mu:\"),/*#__PURE__*/React.createElement(Box,{lineHeight:2,fontSize:12},\"Learning rate- controls speed for convergence\"),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3,alignItems:\"center\",justify:\"center\"},/*#__PURE__*/React.createElement(Grid,{container:true,item:true,xs:8},/*#__PURE__*/React.createElement(Slider,{value:mu,onChange:this.handleMuSliderChange,step:0.0001,min:0.0001,max:0.02})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Input,{className:classes.input,value:mu,margin:\"dense\",onChange:this.handleMuInputChange,onBlur:this.handleBlurMu,inputProps:{step:0.0002,min:0.0001,max:0.02,type:'number'}}))),/*#__PURE__*/React.createElement(Box,{mt:2,lineHeight:2,fontSize:18},\"Advanced Settings:\"),/*#__PURE__*/React.createElement(Box,{lineHeight:2,fontSize:12},\"Mechanisms for Robustness in Beamforming\"),/*#__PURE__*/React.createElement(Box,{mt:1,lineHeight:2},\"Norm Constraint:\"),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:this.handleNcChange,className:classes.button},ncEnabled?\"ON\":\"OFF\")),/*#__PURE__*/React.createElement(Box,{lineHeight:2},\"Adaptation Mode Control:\"),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:this.handleAmcChange,className:classes.button},amcEnabled?\"ON\":\"OFF\"))),/*#__PURE__*/React.createElement(DialogActions,null,/*#__PURE__*/React.createElement(Button,{autoFocus:true,onClick:this.handleClickClose,color:\"primary\"},\"Exit Settings\")))),/*#__PURE__*/React.createElement(Grid,{container:true,alignItems:\"center\"},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:this.handleBeamformingChange,className:classes.bigbutton},beamformingEnabled?\"Disable Beamforming\":\"Enable Beamforming\")),/*#__PURE__*/React.createElement(Grid,null,/*#__PURE__*/React.createElement(Box,{mt:1,lineHeight:2,fontSize:16,justify:\"center\",align:\"center\"},\"Click the settings icon at the top right corner to adjust beamforming settings.\")),/*#__PURE__*/React.createElement(Grid,{className:classes.content},/*#__PURE__*/React.createElement(Typography,{component:\"div\"},/*#__PURE__*/React.createElement(Box,{mt:2,lineHeight:2,fontSize:20},\"Description:\")),/*#__PURE__*/React.createElement(Typography,{component:\"div\",alignItems:\"center\"},/*#__PURE__*/React.createElement(Box,{justify:\"center\",align:\"center\"},/*#__PURE__*/React.createElement(\"img\",{src:bfDemo,alt:\"Beamforming Demo\",className:classes.img}),/*#__PURE__*/React.createElement(Box,{fontSize:13},\"One interference - Two microphone setup\")),/*#__PURE__*/React.createElement(Box,{mt:2,justify:\"center\",align:\"center\"},'The current system uses two microphones (R/L). The signals from '.concat('these microphones are shared across the right and left channels and ','consist of the intended signal plus any interference. One channel ','is kept intact while the other is processed to obtain the best ','estimate of the interference (as little of the intended signal as ','possible). This signal is then subtracted from that in the first ','channel to leave \"only\" the target. The \"corrected\" combination in ','the first channel is evaluated and the processing of the second ','channel modified adaptively to produce one output that is then ','shared by the right and left ears.'))))));}}]);return BeamformingDemo;}(Component);export default withStyles(styles)(BeamformingDemo);","map":{"version":3,"sources":["/opt/osp/ewsnodejs-client/src/pages/demo/beamformingDemo.jsx"],"names":["React","Component","withStyles","axios","Grid","Typography","Button","Input","Slider","Box","SettingsIcon","bfDemo","Dialog","DialogActions","DialogContent","DialogTitle","useMediaQuery","useTheme","styles","theme","root","flexGrow","content","padding","spacing","maxWidth","minWidth","margin","bigbutton","width","height","fontSize","button","input","iconHover","float","color","alignItems","img","BeamformingDemo","state","beamformingEnabled","mu","ncEnabled","amcEnabled","open","componentDidMount","loadParameter","alert","post","response","data","setState","parseFloat","toFixed","ResponsiveDialog","fullScreen","breakpoints","down","handleClickOpen","handleClickClose","handleMuSliderChange","event","newValue","setMu","handleMuInputChange","target","value","Number","handleBlurMu","handleTransmiteBeamformingData","handleNcChange","handleAmcChange","handleBeamformingChange","beamformingData","method","classes","props","step","min","max","type","concat"],"mappings":"60BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,UAAT,KAA2B,qBAA3B,CACA,OAASC,KAAT,KAAsB,aAAtB,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,GAAP,KAAgB,uBAAhB,CACA,MAAOC,CAAAA,YAAP,KAAyB,6BAAzB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,aAAP,KAA0B,iCAA1B,CACA,MAAOC,CAAAA,aAAP,KAA0B,iCAA1B,CACA,MAAOC,CAAAA,WAAP,KAAwB,+BAAxB,CACA,MAAOC,CAAAA,aAAP,KAA0B,iCAA1B,CACA,OAASC,QAAT,KAAyB,0BAAzB,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,QAAY,CACvBC,IAAI,CAAE,CACFC,QAAQ,CAAE,CADR,CADiB,CAIvBC,OAAO,CAAE,CACLC,OAAO,CAAEJ,KAAK,CAACK,OAAN,CAAc,CAAd,CADJ,CAELC,QAAQ,CAAE,GAFL,CAGLC,QAAQ,CAAE,GAHL,CAILC,MAAM,CAAE,MAJH,CAJc,CAUvBC,SAAS,CAAE,CACPC,KAAK,CAAE,GADA,CAEPC,MAAM,CAAE,GAFD,CAGPC,QAAQ,CAAE,EAHH,CAIPJ,MAAM,CAAE,MAJD,CAVY,CAgBvBK,MAAM,CAAE,CACJH,KAAK,CAAE,EADH,CAEJC,MAAM,CAAE,EAFJ,CAGJC,QAAQ,CAAE,EAHN,CAIJJ,MAAM,CAAE,MAJJ,CAhBe,CAsBvBM,KAAK,CAAE,CACHJ,KAAK,CAAE,GADJ,CAtBgB,CAyBvBK,SAAS,CAAE,CACPC,KAAK,CAAE,OADA,CAEP,UAAW,CACTC,KAAK,CAAE,MADE,CAFJ,CAKPC,UAAU,CAAE,OALL,CAMPD,KAAK,CAAE,SANA,CAzBY,CAiCvBE,GAAG,CAAE,CACDT,KAAK,CAAE,GADN,CAEDC,MAAM,CAAE,MAFP,CAjCkB,CAAZ,EAAf,C,GAwCMS,CAAAA,e,+VACFC,K,CAAQ,CACJC,kBAAkB,CAAE,KADhB,CAEJC,EAAE,CAAE,CAFA,CAGJC,SAAS,CAAE,KAHP,CAIJC,UAAU,CAAE,KAJR,CAKJC,IAAI,CAAE,KALF,C,OAQRC,iB,sEAAoB,yKAEN,OAAKC,aAAL,EAFM,sFAKZC,KAAK,aAAL,CALY,mE,SASpBD,a,sEAAgB,kMAEe5C,CAAAA,KAAK,CAAC8C,IAAN,CAAW,qBAAX,CAFf,QAEFC,QAFE,gBAGFC,IAHE,CAGKD,QAAQ,CAACC,IAHd,CAIR,MAAKC,QAAL,CAAc,CACVX,kBAAkB,CAAEU,IAAI,CAAC,MAAD,CAAJ,CAAa,IAAb,IAAuB,CADjC,CAEVT,EAAE,CAAEW,UAAU,CAAEF,IAAI,CAAC,MAAD,CAAJ,CAAa,OAAb,CAAD,CAAwBG,OAAxB,CAAgC,CAAhC,CAAD,CAFJ,CAGVX,SAAS,CAAEQ,IAAI,CAAC,MAAD,CAAJ,CAAa,cAAb,IAAiC,CAHlC,CAIVP,UAAU,CAAEO,IAAI,CAAC,MAAD,CAAJ,CAAa,eAAb,IAAkC,CAJpC,CAAd,EAJQ,4K,SAgBhBI,gB,sEAAmB,6JACf;AACMpC,KAFS,CAEDF,QAAQ,EAFP,CAGTuC,UAHS,CAGIxC,aAAa,CAACG,KAAK,CAACsC,WAAN,CAAkBC,IAAlB,CAAuB,IAAvB,CAAD,CAHjB,yD,SAMnBC,e,sEAAkB,wIACd,MAAKP,QAAL,CAAc,CACVP,IAAI,CAAE,IADI,CAAd,EADc,wD,SAMlBe,gB,sEAAmB,wIACf,MAAKR,QAAL,CAAc,CACVP,IAAI,CAAE,KADI,CAAd,EADe,wD,SAMnBgB,oB,2FAAuB,kBAAOC,KAAP,CAAcC,QAAd,6IACb,OAAKC,KAAL,CAAWD,QAAX,CADa,yD,0EAIvBE,mB,2FAAsB,kBAAOH,KAAP,6IACZ,OAAKE,KAAL,CAAWF,KAAK,CAACI,MAAN,CAAaC,KAAb,GAAuB,EAAvB,CAA4B,CAA5B,CAAgCC,MAAM,CAACN,KAAK,CAACI,MAAN,CAAaC,KAAd,CAAjD,CADY,yD,uEAItBE,Y,sEAAe,+IACH3B,EADG,CACI,MAAKF,KADT,CACHE,EADG,MAGPA,EAAE,CAAG,MAHE,kDAID,OAAKsB,KAAL,CAAW,MAAX,CAJC,2CAKAtB,EAAE,CAAG,IALL,kDAMD,OAAKsB,KAAL,CAAW,IAAX,CANC,yD,SAUfA,K,2FAAQ,kBAAOG,KAAP,0LAKA,MAAK3B,KALL,CAEAC,kBAFA,aAEAA,kBAFA,CAGAE,SAHA,aAGAA,SAHA,CAIAC,UAJA,aAIAA,UAJA,wBAME,OAAK0B,8BAAL,CAAoC7B,kBAApC,CAAwD0B,KAAxD,CAA+DxB,SAA/D,CAA0EC,UAA1E,CANF,QAOJ,MAAKQ,QAAL,CAAc,CAAEV,EAAE,CAAEyB,KAAN,CAAd,EAPI,wD,uEAWRI,c,CAAiB,SAACT,KAAD,CAAW,CACxB,MAAKV,QAAL,CAAc,CACVT,SAAS,CAAEmB,KAAK,CAACI,MAAN,CAAaC,KADd,CAAd,EAGH,C,OAEDK,e,CAAkB,SAACV,KAAD,CAAW,CACzB,MAAKV,QAAL,CAAc,CACVR,UAAU,CAAEkB,KAAK,CAACI,MAAN,CAAaC,KADf,CAAd,EAGH,C,OAEDI,c,sEAAiB,sNAMT,MAAK/B,KANI,CAETC,kBAFS,cAETA,kBAFS,CAGTC,EAHS,cAGTA,EAHS,CAITC,SAJS,cAITA,SAJS,CAKTC,UALS,cAKTA,UALS,2CAQH,OAAK0B,8BAAL,CAAoC7B,kBAApC,CAAwDC,EAAxD,CAA4D,CAACC,SAA7D,CAAwEC,UAAxE,CARG,QAST,MAAKQ,QAAL,CAAc,CACVT,SAAS,CAAE,CAACA,SADF,CAAd,EATS,uFAcTK,KAAK,CAAC,cAAME,QAAN,CAAeC,IAAhB,CAAL,CAdS,wE,SAkBjBqB,e,sEAAkB,sNAMV,MAAKhC,KANK,CAEVC,kBAFU,cAEVA,kBAFU,CAGVC,EAHU,cAGVA,EAHU,CAIVC,SAJU,cAIVA,SAJU,CAKVC,UALU,cAKVA,UALU,2CAQJ,OAAK0B,8BAAL,CAAoC7B,kBAApC,CAAwDC,EAAxD,CAA4DC,SAA5D,CAAuE,CAACC,UAAxE,CARI,QASV,MAAKQ,QAAL,CAAc,CACVR,UAAU,CAAE,CAACA,UADH,CAAd,EATU,uFAcVI,KAAK,CAAC,cAAME,QAAN,CAAeC,IAAhB,CAAL,CAdU,wE,SAkBlBsB,uB,sEAA0B,sNAMlB,MAAKjC,KANa,CAElBC,kBAFkB,cAElBA,kBAFkB,CAGlBC,EAHkB,cAGlBA,EAHkB,CAIlBC,SAJkB,cAIlBA,SAJkB,CAKlBC,UALkB,cAKlBA,UALkB,2CAQZ,OAAK0B,8BAAL,CAAoC,CAAC7B,kBAArC,CAAyDC,EAAzD,CAA6DC,SAA7D,CAAwEC,UAAxE,CARY,QASlB,MAAKQ,QAAL,CAAc,CACVX,kBAAkB,CAAE,CAACA,kBADX,CAAd,EATkB,uFAclBO,KAAK,CAAC,cAAME,QAAN,CAAeC,IAAhB,CAAL,CAdkB,wE,SAmB1BmB,8B,4FAAkC,mBAAO7B,kBAAP,CAA2BC,EAA3B,CAA+BC,SAA/B,CAA0CC,UAA1C,8IAC1B8B,eAD0B,CACR,CAClB,KAAKjC,kBAAkB,GAAK,KAAvB,CAA+B,CAA/B,CAAmC,CADtB,CAElB,QAASC,EAFS,CAGlB,eAAgBC,SAAS,GAAK,KAAd,CAAsB,CAAtB,CAA0B,CAHxB,CAIlB,gBAAiBC,UAAU,GAAK,KAAf,CAAuB,CAAvB,CAA2B,CAJ1B,CADQ,yBAOjBzC,CAAAA,KAAK,CAAC8C,IAAN,CAAW,qBAAX,CAAkC,CAC3C0B,MAAM,CAAE,KADmC,CAE3CxB,IAAI,CACA,CACI,OAAQuB,eADZ,CAEI,QAASA,eAFb,CAHuC,CAAlC,CAPiB,qH,+JAiBzB,IACGE,CAAAA,OADH,CACe,KAAKC,KADpB,CACGD,OADH,kBAQD,KAAKpC,KARJ,CAGDC,kBAHC,cAGDA,kBAHC,CAIDC,EAJC,cAIDA,EAJC,CAKDC,SALC,cAKDA,SALC,CAMDC,UANC,cAMDA,UANC,CAODC,IAPC,cAODA,IAPC,CASL,mBACI,2BAAK,SAAS,CAAE+B,OAAO,CAACxD,IAAxB,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,QAA1B,CAAmC,OAAO,CAAC,QAA3C,eACI,4CACI,oBAAC,YAAD,EAAc,SAAS,CAAEwD,OAAO,CAAC1C,SAAjC,CAA4C,QAAQ,CAAC,OAArD,CAA6D,OAAO,CAAE,KAAKyB,eAA3E,EADJ,cAEI,oBAAC,MAAD,EACI,UAAU,CAAE,KAAKH,UADrB,CAEI,IAAI,CAAEX,IAFV,CAGI,OAAO,CAAE,KAAKe,gBAHlB,CAII,kBAAgB,yBAJpB,eAMA,oBAAC,WAAD,EAAa,EAAE,CAAC,yBAAhB,EAA2C,sCAA3C,CANA,cAOA,oBAAC,aAAD,mBACA,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAG,kBAAZ,CAA+B,QAAQ,CAAE,EAAzC,oBADA,cAIA,oBAAC,GAAD,EAAK,UAAU,CAAE,CAAjB,QAJA,cAOA,oBAAC,GAAD,EAAK,UAAU,CAAE,CAAjB,CAAoB,QAAQ,CAAE,EAA9B,kDAPA,cAUA,oBAAC,IAAD,EACI,SAAS,KADb,CAEI,OAAO,CAAE,CAFb,CAGI,UAAU,CAAC,QAHf,CAII,OAAO,CAAC,QAJZ,eAMI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,IAAI,KAApB,CAAqB,EAAE,CAAE,CAAzB,eACI,oBAAC,MAAD,EACI,KAAK,CAAElB,EADX,CAEI,QAAQ,CAAE,KAAKmB,oBAFnB,CAGI,IAAI,CAAE,MAHV,CAII,GAAG,CAAE,MAJT,CAKI,GAAG,CAAE,IALT,EADJ,CANJ,cAeI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,KAAD,EACI,SAAS,CAAEe,OAAO,CAAC3C,KADvB,CAEI,KAAK,CAAES,EAFX,CAGI,MAAM,CAAC,OAHX,CAII,QAAQ,CAAE,KAAKuB,mBAJnB,CAKI,MAAM,CAAE,KAAKI,YALjB,CAMI,UAAU,CAAE,CACRS,IAAI,CAAE,MADE,CAERC,GAAG,CAAE,MAFG,CAGRC,GAAG,CAAE,IAHG,CAIRC,IAAI,CAAE,QAJE,CANhB,EADJ,CAfJ,CAVA,cAyCA,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,UAAU,CAAE,CAAxB,CAA2B,QAAQ,CAAE,EAArC,uBAzCA,cA4CA,oBAAC,GAAD,EAAK,UAAU,CAAE,CAAjB,CAAoB,QAAQ,CAAE,EAA9B,6CA5CA,cA+CA,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,UAAU,CAAE,CAAxB,qBA/CA,cAkDA,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,MAAD,EACI,OAAO,CAAC,WADZ,CAEI,KAAK,CAAC,SAFV,CAGI,OAAO,CAAE,KAAKV,cAHlB,CAII,SAAS,CAAEK,OAAO,CAAC5C,MAJvB,EAOIW,SAAS,CACL,IADK,CAEL,KATR,CADJ,CAlDA,cAgEI,oBAAC,GAAD,EAAK,UAAU,CAAE,CAAjB,6BAhEJ,cAmEI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,MAAD,EACI,OAAO,CAAC,WADZ,CAEI,KAAK,CAAC,SAFV,CAGI,OAAO,CAAE,KAAK6B,eAHlB,CAII,SAAS,CAAEI,OAAO,CAAC5C,MAJvB,EAOIY,UAAU,CACN,IADM,CAEN,KATR,CADJ,CAnEJ,CAPA,cAyFA,oBAAC,aAAD,mBACI,oBAAC,MAAD,EAAQ,SAAS,KAAjB,CAAkB,OAAO,CAAE,KAAKgB,gBAAhC,CAAkD,KAAK,CAAC,SAAxD,kBADJ,CAzFA,CAFJ,CADJ,cAmGI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,UAAU,CAAC,QAA3B,eACI,oBAAC,MAAD,EACI,OAAO,CAAC,WADZ,CAEI,KAAK,CAAC,SAFV,CAGI,OAAO,CAAE,KAAKa,uBAHlB,CAII,SAAS,CAAEG,OAAO,CAAChD,SAJvB,EAOIa,kBAAkB,CACd,qBADc,CAEd,oBATR,CADJ,CAnGJ,cAiHI,oBAAC,IAAD,mBACI,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,UAAU,CAAE,CAAxB,CAA2B,QAAQ,CAAE,EAArC,CAAyC,OAAO,CAAC,QAAjD,CAA0D,KAAK,CAAC,QAAhE,oFADJ,CAjHJ,cAsHI,oBAAC,IAAD,EAAM,SAAS,CAAEmC,OAAO,CAACtD,OAAzB,eACI,oBAAC,UAAD,EAAY,SAAS,CAAC,KAAtB,eACI,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,UAAU,CAAE,CAAxB,CAA2B,QAAQ,CAAE,EAArC,iBADJ,CADJ,cAMI,oBAAC,UAAD,EAAY,SAAS,CAAC,KAAtB,CAA4B,UAAU,CAAC,QAAvC,eACI,oBAAC,GAAD,EAAK,OAAO,CAAC,QAAb,CAAsB,KAAK,CAAC,QAA5B,eACI,2BACI,GAAG,CAAEX,MADT,CAEI,GAAG,mBAFP,CAGI,SAAS,CAAEiE,OAAO,CAACtC,GAHvB,EADJ,cAMI,oBAAC,GAAD,EAAK,QAAQ,CAAE,EAAf,4CANJ,CADJ,cAWI,oBAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,OAAO,CAAC,QAApB,CAA6B,KAAK,CAAC,QAAnC,EAEI,mEAAmE4C,MAAnE,CACA,sEADA,CAEA,oEAFA,CAGA,iEAHA,CAIA,oEAJA,CAKA,mEALA,CAMA,qEANA,CAOA,kEAPA,CAQA,iEARA,CASA,oCATA,CAFJ,CAXJ,CANJ,CAtHJ,CADJ,CADJ,CA4JH,C,6BA1UyBjF,S,EA4U9B,cAAeC,CAAAA,UAAU,CAACgB,MAAD,CAAV,CAAmBqB,eAAnB,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport { withStyles } from '@material-ui/styles';\nimport { axios } from 'utils/utils';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport Input from '@material-ui/core/Input';\nimport Slider from '@material-ui/core/Slider';\nimport Box from '@material-ui/core/Box';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport bfDemo from 'utils/images/bfDemo.png';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { useTheme } from '@material-ui/core/styles';\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    content: {\n        padding: theme.spacing(3),\n        maxWidth: 500,\n        minWidth: 200,\n        margin: 'auto'\n    },\n    bigbutton: {\n        width: 480,\n        height: 100,\n        fontSize: 30,\n        margin: 'auto',\n    },\n    button: {\n        width: 40,\n        height: 30,\n        fontSize: 10,\n        margin: 'auto',\n    },\n    input: {\n        width: 100,\n    },\n    iconHover: {\n        float: 'right',\n        '&:hover': {\n          color: \"grey\",\n        },\n        alignItems: \"right\",\n        color: \"inherit\",\n      },\n    img: {\n        width: 300,\n        height: 'auto',\n    },\n});\n\n\nclass BeamformingDemo extends Component {\n    state = {\n        beamformingEnabled: false,\n        mu: 0,\n        ncEnabled: false,\n        amcEnabled: false,\n        open: false,\n    };\n\n    componentDidMount = async () => {\n        try {\n            await this.loadParameter();\n        }\n        catch (error) {\n            alert(error);\n        }\n    }\n\n    loadParameter = async () => {\n        try {\n            const response = await axios.post(\"/api/param/getparam\");\n            const data = response.data;\n            this.setState({\n                beamformingEnabled: data['left']['bf'] === 1,\n                mu: parseFloat((data['left']['bf_mu']).toFixed(4)),\n                ncEnabled: data['left']['bf_nc_on_off'] === 1,\n                amcEnabled: data['left']['bf_amc_on_off'] === 1,\n            });\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n\n    ResponsiveDialog = async () => {\n        //const [open, setOpen] = React.useState(false);\n        const theme = useTheme();\n        const fullScreen = useMediaQuery(theme.breakpoints.down('sm'));\n    }\n\n    handleClickOpen = async () => {\n        this.setState({\n            open: true,\n        });\n    };\n\n    handleClickClose = async () => {\n        this.setState({\n            open: false,\n        });\n    };\n\n    handleMuSliderChange = async (event, newValue) => {\n        await this.setMu(newValue);\n    }\n\n    handleMuInputChange = async (event) => {\n        await this.setMu(event.target.value === '' ? 0 : Number(event.target.value));\n    }\n\n    handleBlurMu = async () => {\n        const { mu } = this.state;\n\n        if (mu < 0.0001) {\n            await this.setMu(0.0001);\n        } else if (mu > 0.02) {\n            await this.setMu(0.02);\n        }\n    }\n\n    setMu = async (value) => {\n        const { \n            beamformingEnabled,\n            ncEnabled,\n            amcEnabled,\n        } = this.state;\n        await this.handleTransmiteBeamformingData(beamformingEnabled, value, ncEnabled, amcEnabled);\n        this.setState({ mu: value });\n    }\n\n    \n    handleNcChange = (event) => {\n        this.setState({\n            ncEnabled: event.target.value,\n        });\n    };\n\n    handleAmcChange = (event) => {\n        this.setState({\n            amcEnabled: event.target.value,\n        });\n    };\n\n    handleNcChange = async () => {\n        const { \n            beamformingEnabled,\n            mu,\n            ncEnabled,\n            amcEnabled,\n        } = this.state;\n        try {\n            await this.handleTransmiteBeamformingData(beamformingEnabled, mu, !ncEnabled, amcEnabled);\n            this.setState({ \n                ncEnabled: !ncEnabled,\n            });\n        }\n        catch(error) {\n            alert(error.response.data);\n        }\n    }\n\n    handleAmcChange = async () => {\n        const { \n            beamformingEnabled,\n            mu,\n            ncEnabled,\n            amcEnabled,\n        } = this.state;\n        try {\n            await this.handleTransmiteBeamformingData(beamformingEnabled, mu, ncEnabled, !amcEnabled);\n            this.setState({ \n                amcEnabled: !amcEnabled,\n            });\n        }\n        catch(error) {\n            alert(error.response.data);\n        }\n    }\n\n    handleBeamformingChange = async () => {\n        const { \n            beamformingEnabled,\n            mu,\n            ncEnabled,\n            amcEnabled,\n        } = this.state;\n        try {\n            await this.handleTransmiteBeamformingData(!beamformingEnabled, mu, ncEnabled, amcEnabled);\n            this.setState({ \n                beamformingEnabled: !beamformingEnabled,\n            });\n        }\n        catch(error) {\n            alert(error.response.data);\n        }\n    }\n\n\n    handleTransmiteBeamformingData  = async (beamformingEnabled, mu, ncEnabled, amcEnabled ) => {\n        let beamformingData = {\n            'bf':beamformingEnabled === false ? 0 : 1,\n            'bf_mu': mu,\n            'bf_nc_on_off': ncEnabled === false ? 0 : 1,\n            'bf_amc_on_off': amcEnabled === false ? 0 : 1\n        }\n        return await axios.post(\"/api/param/setparam\", {\n            method: 'set',\n            data: \n                {\n                    'left': beamformingData,\n                    'right': beamformingData\n                } \n        });\n    }\n\n    render() {\n        const { classes } = this.props; \n        const {\n            beamformingEnabled,\n            mu,\n            ncEnabled,\n            amcEnabled,\n            open,\n        } = this.state;\n        return (\n            <div className={classes.root}>\n                <Grid container direction=\"column\" justify=\"center\">\n                    <div>\n                        <SettingsIcon className={classes.iconHover} fontSize=\"large\" onClick={this.handleClickOpen}></SettingsIcon>\n                        <Dialog\n                            fullScreen={this.fullScreen}\n                            open={open}\n                            onClose={this.handleClickClose}\n                            aria-labelledby=\"responsive-dialog-title\"\n                        >\n                        <DialogTitle id=\"responsive-dialog-title\">{\"Adjust Settings for Beamforming Demo\"}</DialogTitle>\n                        <DialogContent>\n                        <Box mt={2} /*lineHeight={2}*/ fontSize={18} >  \n                            Basic Settings:\n                        </Box>\n                        <Box lineHeight={2} >  \n                            mu:\n                        </Box>\n                        <Box lineHeight={2} fontSize={12} >  \n                            Learning rate- controls speed for convergence\n                        </Box>\n                        <Grid \n                            container\n                            spacing={3}\n                            alignItems=\"center\" \n                            justify=\"center\"\n                        >\n                            <Grid container item xs={8} >\n                                <Slider\n                                    value={mu} \n                                    onChange={this.handleMuSliderChange}\n                                    step={0.0001}\n                                    min={0.0001}\n                                    max={0.02}\n                                />\n                            </Grid>\n                            <Grid item>\n                                <Input\n                                    className={classes.input}\n                                    value={mu}\n                                    margin=\"dense\"\n                                    onChange={this.handleMuInputChange}\n                                    onBlur={this.handleBlurMu}\n                                    inputProps={{\n                                        step: 0.0002,\n                                        min: 0.0001,\n                                        max: 0.02,\n                                        type: 'number',\n                                    }}\n                                />\n                            </Grid>\n                        </Grid>\n                        <Box mt={2} lineHeight={2} fontSize={18} >  \n                            Advanced Settings:\n                        </Box>\n                        <Box lineHeight={2} fontSize={12} >  \n                            Mechanisms for Robustness in Beamforming\n                        </Box>\n                        <Box mt={1} lineHeight={2}>  \n                            Norm Constraint:\n                        </Box>\n                        <Grid item>\n                            <Button \n                                variant=\"contained\"\n                                color=\"primary\"\n                                onClick={this.handleNcChange}\n                                className={classes.button}\n                            >\n                            {\n                                ncEnabled ? \n                                    \"ON\" :\n                                    \"OFF\"\n                            }\n                            </Button>\n                            </Grid>\n                            <Box lineHeight={2}>  \n                                Adaptation Mode Control:\n                            </Box>\n                            <Grid item>\n                                <Button \n                                    variant=\"contained\"\n                                    color=\"primary\"\n                                    onClick={this.handleAmcChange}\n                                    className={classes.button}\n                                >\n                                {\n                                    amcEnabled ? \n                                        \"ON\" :\n                                        \"OFF\"\n                                }\n                                </Button>\n                            </Grid>\n                        </DialogContent>\n                        <DialogActions>\n                            <Button autoFocus onClick={this.handleClickClose} color=\"primary\">\n                                Exit Settings\n                            </Button>\n                        </DialogActions>\n                        </Dialog>\n                    </div>\n                    <Grid container alignItems=\"center\">\n                        <Button \n                            variant=\"contained\"\n                            color=\"primary\"\n                            onClick={this.handleBeamformingChange}\n                            className={classes.bigbutton}\n                        >\n                        {\n                            beamformingEnabled ? \n                                \"Disable Beamforming\" :\n                                \"Enable Beamforming\"\n                        }\n                        </Button>\n                    </Grid>\n                    <Grid>\n                        <Box mt={1} lineHeight={2} fontSize={16} justify=\"center\" align=\"center\">  \n                            Click the settings icon at the top right corner to adjust beamforming settings.\n                        </Box>\n                    </Grid>\n                    <Grid className={classes.content}>\n                        <Typography component=\"div\">\n                            <Box mt={2} lineHeight={2} fontSize={20} >  \n                                Description:\n                            </Box>\n                        </Typography>\n                        <Typography component=\"div\" alignItems=\"center\">\n                            <Box justify=\"center\" align=\"center\" >\n                                <img\n                                    src={bfDemo}\n                                    alt={`Beamforming Demo`}\n                                    className={classes.img}\n                                />\n                                <Box fontSize={13}>\n                                    One interference - Two microphone setup\n                                </Box>  \n                            </Box>\n                            <Box mt={2} justify=\"center\" align=\"center\">  \n                            {\n                                'The current system uses two microphones (R/L). The signals from '.concat(\n                                'these microphones are shared across the right and left channels and ',\n                                'consist of the intended signal plus any interference. One channel ',\n                                'is kept intact while the other is processed to obtain the best ',\n                                'estimate of the interference (as little of the intended signal as ',\n                                'possible). This signal is then subtracted from that in the first ',\n                                'channel to leave \"only\" the target. The \"corrected\" combination in ',\n                                'the first channel is evaluated and the processing of the second ',\n                                'channel modified adaptively to produce one output that is then ',\n                                'shared by the right and left ears.')\n                            }\n                            </Box>\n                        </Typography>\n                    </Grid>\n                </Grid>\n            </div>\n        );\n    }\n}\nexport default withStyles(styles)(BeamformingDemo);"]},"metadata":{},"sourceType":"module"}
\hypertarget{filter_8c}{}\section{libosp/filter/filter.c File Reference}
\label{filter_8c}\index{libosp/filter/filter.\+c@{libosp/filter/filter.\+c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}filter.\+h\char`\"{}}\newline
Include dependency graph for filter.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{filter_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structfilter__t}{filter\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Structure containing filter information. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} \mbox{\hyperlink{filter_8c_af60877ab9deea7636e6618b2e63ec84f}{filter\+\_\+init}} (const float $\ast$taps, int tap\+\_\+length)
\begin{DoxyCompactList}\small\item\em Initializes filer data structure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{filter_8c_af0509440b286595b487f0f4eb97670cb}{filter\+\_\+update\+\_\+taps}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj, float $\ast$taps, int tap\+\_\+length)
\begin{DoxyCompactList}\small\item\em Updates the taps in the Filter data structure N\+O\+TE\+: If the tap length is not the same as what was passed into filter\+\_\+init the function will return an error. We don\textquotesingle{}t change tap length at runtime just what\textquotesingle{}s loaded into the taps. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{filter_8c_ac26376b60c9cd619476f86177abcbd84}{filter\+\_\+get\+\_\+taps}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj, float $\ast$taps)
\begin{DoxyCompactList}\small\item\em Returns the taps loaded into the taps element in the Filter data structure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{filter_8c_a1617a39021eb367cd89a15fbd041d83d}{filter\+\_\+get\+\_\+internal\+\_\+buffer}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj, float $\ast$buf)
\begin{DoxyCompactList}\small\item\em Returns the internal circular buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{filter_8c_a21892025b31d4a556a331b742ecd37d9}{filter\+\_\+get\+\_\+delay}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj)
\begin{DoxyCompactList}\small\item\em returns the delay of the current filter \end{DoxyCompactList}\item 
void \mbox{\hyperlink{filter_8c_a299844d7458e68c5548821f1adadc673}{D\+S\+P\+F\+\_\+sp\+\_\+fircirc}} (float x\mbox{[}$\,$\mbox{]}, float h\mbox{[}$\,$\mbox{]}, float r\mbox{[}$\,$\mbox{]}, int index, int csize, int nh, size\+\_\+t nr)
\item 
void \mbox{\hyperlink{filter_8c_ac2aadc60ec73a10df6ec442186117a85}{filter\+\_\+proc}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj, float $\ast$in, float $\ast$out, size\+\_\+t len)
\begin{DoxyCompactList}\small\item\em Filters input signal with current filter, and returns output signal. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{filter_8c_a73f846329181b350960205937c9eb499}{filter\+\_\+flush}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj, float $\ast$out)
\begin{DoxyCompactList}\small\item\em Flushes the internal buffer of the filter. When the last frame has been processed, there will still exist some residual data on the internal circular buffer. This data would have been used for the next frame\textquotesingle{}s processing, but since we\textquotesingle{}ve reached the last frame, it just sits in memory. In the case of a file-\/based, non-\/realtime test where every sample of the output signal is needed, this can be called after the final frame worth of data. It will return $<$filter\textquotesingle{}s\+\_\+group\+\_\+delay$>$ worth of samples that have been processed with the filter. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{filter_8c_ae0a5a8084cee81b1e417293d2d53f6ed}{filter\+\_\+destroy}} (\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} obj)
\begin{DoxyCompactList}\small\item\em Frees and destroys the filter data structure. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{filter_8c_a299844d7458e68c5548821f1adadc673}\label{filter_8c_a299844d7458e68c5548821f1adadc673}} 
\index{filter.\+c@{filter.\+c}!D\+S\+P\+F\+\_\+sp\+\_\+fircirc@{D\+S\+P\+F\+\_\+sp\+\_\+fircirc}}
\index{D\+S\+P\+F\+\_\+sp\+\_\+fircirc@{D\+S\+P\+F\+\_\+sp\+\_\+fircirc}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{D\+S\+P\+F\+\_\+sp\+\_\+fircirc()}{DSPF\_sp\_fircirc()}}
{\footnotesize\ttfamily void D\+S\+P\+F\+\_\+sp\+\_\+fircirc (\begin{DoxyParamCaption}\item[{float}]{x\mbox{[}$\,$\mbox{]},  }\item[{float}]{h\mbox{[}$\,$\mbox{]},  }\item[{float}]{r\mbox{[}$\,$\mbox{]},  }\item[{int}]{index,  }\item[{int}]{csize,  }\item[{int}]{nh,  }\item[{size\+\_\+t}]{nr }\end{DoxyParamCaption})}

\mbox{\Hypertarget{filter_8c_ae0a5a8084cee81b1e417293d2d53f6ed}\label{filter_8c_ae0a5a8084cee81b1e417293d2d53f6ed}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+destroy@{filter\+\_\+destroy}}
\index{filter\+\_\+destroy@{filter\+\_\+destroy}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+destroy()}{filter\_destroy()}}
{\footnotesize\ttfamily int filter\+\_\+destroy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj }\end{DoxyParamCaption})}



Frees and destroys the filter data structure. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0 on success, -\/1 otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{filter_8c_a73f846329181b350960205937c9eb499}\label{filter_8c_a73f846329181b350960205937c9eb499}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+flush@{filter\+\_\+flush}}
\index{filter\+\_\+flush@{filter\+\_\+flush}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+flush()}{filter\_flush()}}
{\footnotesize\ttfamily void filter\+\_\+flush (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj,  }\item[{float $\ast$}]{out }\end{DoxyParamCaption})}



Flushes the internal buffer of the filter. When the last frame has been processed, there will still exist some residual data on the internal circular buffer. This data would have been used for the next frame\textquotesingle{}s processing, but since we\textquotesingle{}ve reached the last frame, it just sits in memory. In the case of a file-\/based, non-\/realtime test where every sample of the output signal is needed, this can be called after the final frame worth of data. It will return $<$filter\textquotesingle{}s\+\_\+group\+\_\+delay$>$ worth of samples that have been processed with the filter. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure \\
\hline
{\em out} & Output buffer filled with last processed samples \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{filter_8c_a21892025b31d4a556a331b742ecd37d9}\label{filter_8c_a21892025b31d4a556a331b742ecd37d9}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+get\+\_\+delay@{filter\+\_\+get\+\_\+delay}}
\index{filter\+\_\+get\+\_\+delay@{filter\+\_\+get\+\_\+delay}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+get\+\_\+delay()}{filter\_get\_delay()}}
{\footnotesize\ttfamily int filter\+\_\+get\+\_\+delay (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj }\end{DoxyParamCaption})}



returns the delay of the current filter 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the group delay, in samples, of the current filter 
\end{DoxyReturn}
\mbox{\Hypertarget{filter_8c_a1617a39021eb367cd89a15fbd041d83d}\label{filter_8c_a1617a39021eb367cd89a15fbd041d83d}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+get\+\_\+internal\+\_\+buffer@{filter\+\_\+get\+\_\+internal\+\_\+buffer}}
\index{filter\+\_\+get\+\_\+internal\+\_\+buffer@{filter\+\_\+get\+\_\+internal\+\_\+buffer}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+get\+\_\+internal\+\_\+buffer()}{filter\_get\_internal\_buffer()}}
{\footnotesize\ttfamily int filter\+\_\+get\+\_\+internal\+\_\+buffer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj,  }\item[{float $\ast$}]{buf }\end{DoxyParamCaption})}



Returns the internal circular buffer. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure object \\
\hline
{\em buf} & Buffer that will contain the internal circular buffer\textquotesingle{}s elements\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
returns the current index of the circular buffer 
\end{DoxyReturn}
\mbox{\Hypertarget{filter_8c_ac26376b60c9cd619476f86177abcbd84}\label{filter_8c_ac26376b60c9cd619476f86177abcbd84}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+get\+\_\+taps@{filter\+\_\+get\+\_\+taps}}
\index{filter\+\_\+get\+\_\+taps@{filter\+\_\+get\+\_\+taps}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+get\+\_\+taps()}{filter\_get\_taps()}}
{\footnotesize\ttfamily int filter\+\_\+get\+\_\+taps (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj,  }\item[{float $\ast$}]{taps }\end{DoxyParamCaption})}



Returns the taps loaded into the taps element in the Filter data structure. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure \\
\hline
{\em taps} & Will contain the currently loaded filter taps \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the length of the internal filter 
\end{DoxyReturn}
\mbox{\Hypertarget{filter_8c_af60877ab9deea7636e6618b2e63ec84f}\label{filter_8c_af60877ab9deea7636e6618b2e63ec84f}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+init@{filter\+\_\+init}}
\index{filter\+\_\+init@{filter\+\_\+init}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+init()}{filter\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}} filter\+\_\+init (\begin{DoxyParamCaption}\item[{const float $\ast$}]{taps,  }\item[{int}]{tap\+\_\+length }\end{DoxyParamCaption})}



Initializes filer data structure. 


\begin{DoxyParams}{Parameters}
{\em taps} & Pointer to filter taps to load into this filter data structure \\
\hline
{\em tap\+\_\+length} & Number of taps pointed to by taps\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the allocated filter data structure 
\end{DoxyReturn}
\mbox{\Hypertarget{filter_8c_ac2aadc60ec73a10df6ec442186117a85}\label{filter_8c_ac2aadc60ec73a10df6ec442186117a85}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+proc@{filter\+\_\+proc}}
\index{filter\+\_\+proc@{filter\+\_\+proc}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+proc()}{filter\_proc()}}
{\footnotesize\ttfamily void filter\+\_\+proc (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj,  }\item[{float $\ast$}]{in,  }\item[{float $\ast$}]{out,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}



Filters input signal with current filter, and returns output signal. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure \\
\hline
{\em in} & Input signal \\
\hline
{\em out} & Output signal after filtering \\
\hline
{\em len} & The length of the input and output signals (in our implementation, it\textquotesingle{}s one frame size \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{filter_8c_af0509440b286595b487f0f4eb97670cb}\label{filter_8c_af0509440b286595b487f0f4eb97670cb}} 
\index{filter.\+c@{filter.\+c}!filter\+\_\+update\+\_\+taps@{filter\+\_\+update\+\_\+taps}}
\index{filter\+\_\+update\+\_\+taps@{filter\+\_\+update\+\_\+taps}!filter.\+c@{filter.\+c}}
\subsubsection{\texorpdfstring{filter\+\_\+update\+\_\+taps()}{filter\_update\_taps()}}
{\footnotesize\ttfamily int filter\+\_\+update\+\_\+taps (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{filter_8h_a69e34b8aa259d2ca0b81b5c95f395bdf}{Filter}}}]{obj,  }\item[{float $\ast$}]{taps,  }\item[{int}]{tap\+\_\+length }\end{DoxyParamCaption})}



Updates the taps in the Filter data structure N\+O\+TE\+: If the tap length is not the same as what was passed into filter\+\_\+init the function will return an error. We don\textquotesingle{}t change tap length at runtime just what\textquotesingle{}s loaded into the taps. 


\begin{DoxyParams}{Parameters}
{\em obj} & Filter data structure \\
\hline
{\em taps} & New taps to load into old taps\textquotesingle{} place \\
\hline
{\em tap\+\_\+length} & Number of taps to load into the taps\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0 on success, -\/1 if the tap\+\_\+length parameter does not match the tap length that was set up in filter\+\_\+init 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{filter_8h_af60877ab9deea7636e6618b2e63ec84f}{filter\+\_\+init}} 
\end{DoxySeeAlso}
